{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport GeometryType from '../../geom/GeometryType.js';\nimport VectorContext from '../VectorContext.js';\nimport { asColorLike } from '../../colorlike.js';\nimport { compose as composeTransform, create as createTransform } from '../../transform.js';\nimport { defaultFillStyle, defaultFont, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextAlign, defaultTextBaseline } from '../canvas.js';\nimport { equals } from '../../array.js';\nimport { intersects } from '../../extent.js';\nimport { transform2D } from '../../geom/flat/transform.js';\nimport { transformGeom2D } from '../../geom/SimpleGeometry.js';\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext~VectorContext VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\n\nvar CanvasImmediateRenderer =\n/** @class */\nfunction (_super) {\n  __extends(CanvasImmediateRenderer, _super);\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {number} [opt_squaredTolerance] Optional squared tolerance for simplification.\n   * @param {import(\"../../proj.js\").TransformFunction} [opt_userTransform] Transform from user to view projection.\n   */\n\n\n  function CanvasImmediateRenderer(context, pixelRatio, extent, transform, viewRotation, opt_squaredTolerance, opt_userTransform) {\n    var _this = _super.call(this) || this;\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n\n\n    _this.context_ = context;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.pixelRatio_ = pixelRatio;\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n\n    _this.extent_ = extent;\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n\n    _this.transform_ = transform;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.viewRotation_ = viewRotation;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.squaredTolerance_ = opt_squaredTolerance;\n    /**\n     * @private\n     * @type {import(\"../../proj.js\").TransformFunction}\n     */\n\n    _this.userTransform_ = opt_userTransform;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n\n    _this.contextFillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n\n    _this.contextStrokeState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n\n    _this.contextTextState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n\n    _this.fillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n\n    _this.strokeState_ = null;\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n\n    _this.image_ = null;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageAnchorX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageAnchorY_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageHeight_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageOpacity_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageOriginX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageOriginY_ = 0;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    _this.imageRotateWithView_ = false;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageRotation_ = 0;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n\n    _this.imageScale_ = [0, 0];\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.imageWidth_ = 0;\n    /**\n     * @private\n     * @type {string}\n     */\n\n    _this.text_ = '';\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.textOffsetX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.textOffsetY_ = 0;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    _this.textRotateWithView_ = false;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    _this.textRotation_ = 0;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n\n    _this.textScale_ = [0, 0];\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n\n    _this.textFillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n\n    _this.textStrokeState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n\n    _this.textState_ = null;\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n\n    _this.pixelCoordinates_ = [];\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n\n    _this.tmpLocalTransform_ = createTransform();\n    return _this;\n  }\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawImages_ = function (flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    var context = this.context_;\n    var localTransform = this.tmpLocalTransform_;\n    var alpha = context.globalAlpha;\n\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n\n    var rotation = this.imageRotation_;\n\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n\n    for (var i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      var x = pixelCoordinates[i] - this.imageAnchorX_;\n      var y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n\n      if (rotation !== 0 || this.imageScale_[0] != 1 || this.imageScale_[1] != 1) {\n        var centerX = x + this.imageAnchorX_;\n        var centerY = y + this.imageAnchorY_;\n        composeTransform(localTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n        context.setTransform.apply(context, localTransform);\n        context.translate(centerX, centerY);\n        context.scale(this.imageScale_[0], this.imageScale_[1]);\n        context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, -this.imageAnchorX_, -this.imageAnchorY_, this.imageWidth_, this.imageHeight_);\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, x, y, this.imageWidth_, this.imageHeight_);\n      }\n    }\n\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawText_ = function (flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n\n    this.setContextTextState_(this.textState_);\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    var context = this.context_;\n    var rotation = this.textRotation_;\n\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n\n    for (; offset < end; offset += stride) {\n      var x = pixelCoordinates[offset] + this.textOffsetX_;\n      var y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n\n      if (rotation !== 0 || this.textScale_[0] != 1 || this.textScale_[1] != 1) {\n        var localTransform = composeTransform(this.tmpLocalTransform_, x, y, 1, 1, rotation, -x, -y);\n        context.setTransform.apply(context, localTransform);\n        context.translate(x, y);\n        context.scale(this.textScale_[0], this.textScale_[1]);\n\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, 0, 0);\n        }\n\n        if (this.textFillState_) {\n          context.fillText(this.text_, 0, 0);\n        }\n\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, x, y);\n        }\n\n        if (this.textFillState_) {\n          context.fillText(this.text_, x, y);\n        }\n      }\n    }\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n\n\n  CanvasImmediateRenderer.prototype.moveToLineTo_ = function (flatCoordinates, offset, end, stride, close) {\n    var context = this.context_;\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    var length = pixelCoordinates.length;\n\n    if (close) {\n      length -= 2;\n    }\n\n    for (var i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n\n    if (close) {\n      context.closePath();\n    }\n\n    return end;\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawRings_ = function (flatCoordinates, offset, ends, stride) {\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n    }\n\n    return offset;\n  };\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawCircle = function (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n\n      var pixelCoordinates = transformGeom2D(geometry, this.transform_, this.pixelCoordinates_);\n      var dx = pixelCoordinates[2] - pixelCoordinates[0];\n      var dy = pixelCoordinates[3] - pixelCoordinates[1];\n      var radius = Math.sqrt(dx * dx + dy * dy);\n      var context = this.context_;\n      context.beginPath();\n      context.arc(pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n\n      if (this.fillState_) {\n        context.fill();\n      }\n\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  };\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.setStyle = function (style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  };\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setTransform = function (transform) {\n    this.transform_ = transform;\n  };\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate~CanvasImmediateRenderer#setStyle renderer.setStyle()} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawGeometry = function (geometry) {\n    var type = geometry.getType();\n\n    switch (type) {\n      case GeometryType.POINT:\n        this.drawPoint(\n        /** @type {import(\"../../geom/Point.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.LINE_STRING:\n        this.drawLineString(\n        /** @type {import(\"../../geom/LineString.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.POLYGON:\n        this.drawPolygon(\n        /** @type {import(\"../../geom/Polygon.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.MULTI_POINT:\n        this.drawMultiPoint(\n        /** @type {import(\"../../geom/MultiPoint.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.MULTI_LINE_STRING:\n        this.drawMultiLineString(\n        /** @type {import(\"../../geom/MultiLineString.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.MULTI_POLYGON:\n        this.drawMultiPolygon(\n        /** @type {import(\"../../geom/MultiPolygon.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.GEOMETRY_COLLECTION:\n        this.drawGeometryCollection(\n        /** @type {import(\"../../geom/GeometryCollection.js\").default} */\n        geometry);\n        break;\n\n      case GeometryType.CIRCLE:\n        this.drawCircle(\n        /** @type {import(\"../../geom/Circle.js\").default} */\n        geometry);\n        break;\n\n      default:\n    }\n  };\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @api\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawFeature = function (feature, style) {\n    var geometry = style.getGeometryFunction()(feature);\n\n    if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  };\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawGeometryCollection = function (geometry) {\n    var geometries = geometry.getGeometriesArray();\n\n    for (var i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  };\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawPoint = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n      /** @type {import(\"../../geom/Point.js\").default} */\n      geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawMultiPoint = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n      /** @type {import(\"../../geom/MultiPoint.js\").default} */\n      geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawLineString = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n      /** @type {import(\"../../geom/LineString.js\").default} */\n      geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length, geometry.getStride(), false);\n      context.stroke();\n    }\n\n    if (this.text_ !== '') {\n      var flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  };\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawMultiLineString = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n      /** @type {import(\"../../geom/MultiLineString.js\").default} */\n      geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    var geometryExtent = geometry.getExtent();\n\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      var offset = 0;\n      var ends =\n      /** @type {Array<number>} */\n      geometry.getEnds();\n      var stride = geometry.getStride();\n      context.beginPath();\n\n      for (var i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n      }\n\n      context.stroke();\n    }\n\n    if (this.text_ !== '') {\n      var flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  };\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawPolygon = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n      /** @type {import(\"../../geom/Polygon.js\").default} */\n      geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n\n      var context = this.context_;\n      context.beginPath();\n      this.drawRings_(geometry.getOrientedFlatCoordinates(), 0,\n      /** @type {Array<number>} */\n      geometry.getEnds(), geometry.getStride());\n\n      if (this.fillState_) {\n        context.fill();\n      }\n\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n\n    if (this.text_ !== '') {\n      var flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  };\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   */\n\n\n  CanvasImmediateRenderer.prototype.drawMultiPolygon = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n      /** @type {import(\"../../geom/MultiPolygon.js\").default} */\n      geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n\n      var context = this.context_;\n      var flatCoordinates = geometry.getOrientedFlatCoordinates();\n      var offset = 0;\n      var endss = geometry.getEndss();\n      var stride = geometry.getStride();\n      context.beginPath();\n\n      for (var i = 0, ii = endss.length; i < ii; ++i) {\n        var ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n\n      if (this.fillState_) {\n        context.fill();\n      }\n\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n\n    if (this.text_ !== '') {\n      var flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.setContextFillState_ = function (fillState) {\n    var context = this.context_;\n    var contextFillState = this.contextFillState_;\n\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = fillState.fillStyle;\n        context.fillStyle = fillState.fillStyle;\n      }\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.setContextStrokeState_ = function (strokeState) {\n    var context = this.context_;\n    var contextStrokeState = this.contextStrokeState_;\n\n    if (!contextStrokeState) {\n      context.lineCap = strokeState.lineCap;\n\n      if (context.setLineDash) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n\n      context.lineJoin = strokeState.lineJoin;\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = strokeState.lineCap;\n        context.lineCap = strokeState.lineCap;\n      }\n\n      if (context.setLineDash) {\n        if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n          context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n        }\n\n        if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n          contextStrokeState.lineDashOffset = strokeState.lineDashOffset;\n          context.lineDashOffset = strokeState.lineDashOffset;\n        }\n      }\n\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = strokeState.lineJoin;\n        context.lineJoin = strokeState.lineJoin;\n      }\n\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = strokeState.lineWidth;\n        context.lineWidth = strokeState.lineWidth;\n      }\n\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = strokeState.miterLimit;\n        context.miterLimit = strokeState.miterLimit;\n      }\n\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = strokeState.strokeStyle;\n        context.strokeStyle = strokeState.strokeStyle;\n      }\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n\n\n  CanvasImmediateRenderer.prototype.setContextTextState_ = function (textState) {\n    var context = this.context_;\n    var contextTextState = this.contextTextState_;\n    var textAlign = textState.textAlign ? textState.textAlign : defaultTextAlign;\n\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign =\n      /** @type {CanvasTextAlign} */\n      textAlign;\n      context.textBaseline =\n      /** @type {CanvasTextBaseline} */\n      textState.textBaseline;\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = textState.font;\n        context.font = textState.font;\n      }\n\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign =\n        /** @type {CanvasTextAlign} */\n        textAlign;\n        context.textAlign =\n        /** @type {CanvasTextAlign} */\n        textAlign;\n      }\n\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline =\n        /** @type {CanvasTextBaseline} */\n        textState.textBaseline;\n        context.textBaseline =\n        /** @type {CanvasTextBaseline} */\n        textState.textBaseline;\n      }\n    }\n  };\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setFillStrokeStyle = function (fillStyle, strokeStyle) {\n    var _this = this;\n\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      var fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(fillStyleColor ? fillStyleColor : defaultFillStyle)\n      };\n    }\n\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      var strokeStyleColor = strokeStyle.getColor();\n      var strokeStyleLineCap = strokeStyle.getLineCap();\n      var strokeStyleLineDash = strokeStyle.getLineDash();\n      var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      var strokeStyleLineJoin = strokeStyle.getLineJoin();\n      var strokeStyleWidth = strokeStyle.getWidth();\n      var strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      var lineDash = strokeStyleLineDash ? strokeStyleLineDash : defaultLineDash;\n      this.strokeState_ = {\n        lineCap: strokeStyleLineCap !== undefined ? strokeStyleLineCap : defaultLineCap,\n        lineDash: this.pixelRatio_ === 1 ? lineDash : lineDash.map(function (n) {\n          return n * _this.pixelRatio_;\n        }),\n        lineDashOffset: (strokeStyleLineDashOffset ? strokeStyleLineDashOffset : defaultLineDashOffset) * this.pixelRatio_,\n        lineJoin: strokeStyleLineJoin !== undefined ? strokeStyleLineJoin : defaultLineJoin,\n        lineWidth: (strokeStyleWidth !== undefined ? strokeStyleWidth : defaultLineWidth) * this.pixelRatio_,\n        miterLimit: strokeStyleMiterLimit !== undefined ? strokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(strokeStyleColor ? strokeStyleColor : defaultStrokeStyle)\n      };\n    }\n  };\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setImageStyle = function (imageStyle) {\n    var imageSize;\n\n    if (!imageStyle || !(imageSize = imageStyle.getSize())) {\n      this.image_ = null;\n      return;\n    }\n\n    var imageAnchor = imageStyle.getAnchor();\n    var imageOrigin = imageStyle.getOrigin();\n    this.image_ = imageStyle.getImage(this.pixelRatio_);\n    this.imageAnchorX_ = imageAnchor[0] * this.pixelRatio_;\n    this.imageAnchorY_ = imageAnchor[1] * this.pixelRatio_;\n    this.imageHeight_ = imageSize[1] * this.pixelRatio_;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScaleArray();\n    this.imageWidth_ = imageSize[0] * this.pixelRatio_;\n  };\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   */\n\n\n  CanvasImmediateRenderer.prototype.setTextStyle = function (textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      var textFillStyle = textStyle.getFill();\n\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        var textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(textFillStyleColor ? textFillStyleColor : defaultFillStyle)\n        };\n      }\n\n      var textStrokeStyle = textStyle.getStroke();\n\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        var textStrokeStyleColor = textStrokeStyle.getColor();\n        var textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        var textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        var textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n        var textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        var textStrokeStyleWidth = textStrokeStyle.getWidth();\n        var textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap: textStrokeStyleLineCap !== undefined ? textStrokeStyleLineCap : defaultLineCap,\n          lineDash: textStrokeStyleLineDash ? textStrokeStyleLineDash : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset ? textStrokeStyleLineDashOffset : defaultLineDashOffset,\n          lineJoin: textStrokeStyleLineJoin !== undefined ? textStrokeStyleLineJoin : defaultLineJoin,\n          lineWidth: textStrokeStyleWidth !== undefined ? textStrokeStyleWidth : defaultLineWidth,\n          miterLimit: textStrokeStyleMiterLimit !== undefined ? textStrokeStyleMiterLimit : defaultMiterLimit,\n          strokeStyle: asColorLike(textStrokeStyleColor ? textStrokeStyleColor : defaultStrokeStyle)\n        };\n      }\n\n      var textFont = textStyle.getFont();\n      var textOffsetX = textStyle.getOffsetX();\n      var textOffsetY = textStyle.getOffsetY();\n      var textRotateWithView = textStyle.getRotateWithView();\n      var textRotation = textStyle.getRotation();\n      var textScale = textStyle.getScaleArray();\n      var textText = textStyle.getText();\n      var textTextAlign = textStyle.getTextAlign();\n      var textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ? textFont : defaultFont,\n        textAlign: textTextAlign !== undefined ? textTextAlign : defaultTextAlign,\n        textBaseline: textTextBaseline !== undefined ? textTextBaseline : defaultTextBaseline\n      };\n      this.text_ = textText !== undefined ? Array.isArray(textText) ? textText.reduce(function (acc, t, i) {\n        return acc += i % 2 ? ' ' : t;\n      }, '') : textText : '';\n      this.textOffsetX_ = textOffsetX !== undefined ? this.pixelRatio_ * textOffsetX : 0;\n      this.textOffsetY_ = textOffsetY !== undefined ? this.pixelRatio_ * textOffsetY : 0;\n      this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = [this.pixelRatio_ * textScale[0], this.pixelRatio_ * textScale[1]];\n    }\n  };\n\n  return CanvasImmediateRenderer;\n}(VectorContext);\n\nexport default CanvasImmediateRenderer;","map":{"version":3,"mappings":"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","names":["GeometryType","VectorContext","asColorLike","compose","composeTransform","create","createTransform","defaultFillStyle","defaultFont","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultLineWidth","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","equals","intersects","transform2D","transformGeom2D","__extends","context","pixelRatio","extent","transform","viewRotation","opt_squaredTolerance","opt_userTransform","_super","_this","context_","pixelRatio_","extent_","transform_","viewRotation_","squaredTolerance_","userTransform_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","image_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageWidth_","text_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","CanvasImmediateRenderer","flatCoordinates","offset","end","stride","pixelCoordinates","localTransform","alpha","globalAlpha","rotation","i","ii","length","x","y","centerX","centerY","setTransform","apply","translate","scale","drawImage","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","close","moveTo","lineTo","closePath","ends","moveToLineTo_","geometry","getExtent","dx","dy","radius","Math","sqrt","beginPath","arc","PI","fill","stroke","drawText_","getCenter","style","setFillStrokeStyle","getFill","getStroke","setImageStyle","getImage","setTextStyle","getText","type","getType","POINT","drawPoint","LINE_STRING","drawLineString","POLYGON","drawPolygon","MULTI_POINT","drawMultiPoint","MULTI_LINE_STRING","drawMultiLineString","MULTI_POLYGON","drawMultiPolygon","GEOMETRY_COLLECTION","drawGeometryCollection","CIRCLE","drawCircle","feature","getGeometryFunction","setStyle","drawGeometry","geometries","getGeometriesArray","simplifyTransformed","getFlatCoordinates","getStride","drawImages_","flatMidpoint","getFlatMidpoint","geometryExtent","getEnds","flatMidpoints","getFlatMidpoints","drawRings_","getOrientedFlatCoordinates","flatInteriorPoint","getFlatInteriorPoint","endss","getEndss","flatInteriorPoints","getFlatInteriorPoints","fillState","contextFillState","fillStyle","strokeState","contextStrokeState","lineCap","setLineDash","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","strokeStyle","textState","contextTextState","textAlign","font","textBaseline","fillStyleColor","getColor","strokeStyleColor","strokeStyleLineCap","getLineCap","strokeStyleLineDash","getLineDash","strokeStyleLineDashOffset","getLineDashOffset","strokeStyleLineJoin","getLineJoin","strokeStyleWidth","getWidth","strokeStyleMiterLimit","getMiterLimit","undefined","map","n","imageStyle","imageSize","getSize","imageAnchor","getAnchor","imageOrigin","getOrigin","getOpacity","getRotateWithView","getRotation","getScaleArray","textStyle","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","getFont","textOffsetX","getOffsetX","textOffsetY","getOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","getTextAlign","textTextBaseline","getTextBaseline","Array","isArray","reduce","acc","t"],"sourceRoot":"","sources":["../../src/render/canvas/Immediate.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}