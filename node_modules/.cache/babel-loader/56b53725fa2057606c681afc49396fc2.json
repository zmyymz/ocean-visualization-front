{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/render/canvas/LineStringBuilder\n */\n\n\nimport CanvasBuilder from './Builder.js';\nimport CanvasInstruction, { beginPathInstruction, strokeInstruction } from './Instruction.js';\nimport { defaultLineDash, defaultLineDashOffset } from '../canvas.js';\n\nvar CanvasLineStringBuilder =\n/** @class */\nfunction (_super) {\n  __extends(CanvasLineStringBuilder, _super);\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n\n\n  function CanvasLineStringBuilder(tolerance, maxExtent, resolution, pixelRatio) {\n    return _super.call(this, tolerance, maxExtent, resolution, pixelRatio) || this;\n  }\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} end.\n   */\n\n\n  CanvasLineStringBuilder.prototype.drawFlatCoordinates_ = function (flatCoordinates, offset, end, stride) {\n    var myBegin = this.coordinates.length;\n    var myEnd = this.appendFlatLineCoordinates(flatCoordinates, offset, end, stride, false, false);\n    var moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n    this.instructions.push(moveToLineToInstruction);\n    this.hitDetectionInstructions.push(moveToLineToInstruction);\n    return end;\n  };\n  /**\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} lineStringGeometry Line string geometry.\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   */\n\n\n  CanvasLineStringBuilder.prototype.drawLineString = function (lineStringGeometry, feature) {\n    var state = this.state;\n    var strokeStyle = state.strokeStyle;\n    var lineWidth = state.lineWidth;\n\n    if (strokeStyle === undefined || lineWidth === undefined) {\n      return;\n    }\n\n    this.updateStrokeStyle(state, this.applyStroke);\n    this.beginGeometry(lineStringGeometry, feature);\n    this.hitDetectionInstructions.push([CanvasInstruction.SET_STROKE_STYLE, state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin, state.miterLimit, defaultLineDash, defaultLineDashOffset], beginPathInstruction);\n    var flatCoordinates = lineStringGeometry.getFlatCoordinates();\n    var stride = lineStringGeometry.getStride();\n    this.drawFlatCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n    this.hitDetectionInstructions.push(strokeInstruction);\n    this.endGeometry(feature);\n  };\n  /**\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} multiLineStringGeometry MultiLineString geometry.\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   */\n\n\n  CanvasLineStringBuilder.prototype.drawMultiLineString = function (multiLineStringGeometry, feature) {\n    var state = this.state;\n    var strokeStyle = state.strokeStyle;\n    var lineWidth = state.lineWidth;\n\n    if (strokeStyle === undefined || lineWidth === undefined) {\n      return;\n    }\n\n    this.updateStrokeStyle(state, this.applyStroke);\n    this.beginGeometry(multiLineStringGeometry, feature);\n    this.hitDetectionInstructions.push([CanvasInstruction.SET_STROKE_STYLE, state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin, state.miterLimit, state.lineDash, state.lineDashOffset], beginPathInstruction);\n    var ends = multiLineStringGeometry.getEnds();\n    var flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n    var stride = multiLineStringGeometry.getStride();\n    var offset = 0;\n\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.drawFlatCoordinates_(flatCoordinates, offset,\n      /** @type {number} */\n      ends[i], stride);\n    }\n\n    this.hitDetectionInstructions.push(strokeInstruction);\n    this.endGeometry(feature);\n  };\n  /**\n   * @return {import(\"../canvas.js\").SerializableInstructions} the serializable instructions.\n   */\n\n\n  CanvasLineStringBuilder.prototype.finish = function () {\n    var state = this.state;\n\n    if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n      this.instructions.push(strokeInstruction);\n    }\n\n    this.reverseHitDetectionInstructions();\n    this.state = null;\n    return _super.prototype.finish.call(this);\n  };\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   */\n\n\n  CanvasLineStringBuilder.prototype.applyStroke = function (state) {\n    if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n      this.instructions.push(strokeInstruction);\n      state.lastStroke = this.coordinates.length;\n    }\n\n    state.lastStroke = 0;\n\n    _super.prototype.applyStroke.call(this, state);\n\n    this.instructions.push(beginPathInstruction);\n  };\n\n  return CanvasLineStringBuilder;\n}(CanvasBuilder);\n\nexport default CanvasLineStringBuilder;","map":{"version":3,"mappings":"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","names":["CanvasBuilder","CanvasInstruction","beginPathInstruction","strokeInstruction","defaultLineDash","defaultLineDashOffset","__extends","tolerance","maxExtent","resolution","pixelRatio","_super","CanvasLineStringBuilder","flatCoordinates","offset","end","stride","myBegin","coordinates","length","myEnd","appendFlatLineCoordinates","moveToLineToInstruction","MOVE_TO_LINE_TO","instructions","push","hitDetectionInstructions","lineStringGeometry","feature","state","strokeStyle","lineWidth","undefined","updateStrokeStyle","applyStroke","beginGeometry","SET_STROKE_STYLE","lineCap","lineJoin","miterLimit","getFlatCoordinates","getStride","drawFlatCoordinates_","endGeometry","multiLineStringGeometry","lineDash","lineDashOffset","ends","getEnds","i","ii","lastStroke","reverseHitDetectionInstructions","finish","call"],"sourceRoot":"","sources":["../../src/render/canvas/LineStringBuilder.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}