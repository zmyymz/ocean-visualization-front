{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/layer/Graticule\n */\n\n\nimport Collection from '../Collection.js';\nimport EventType from '../render/EventType.js';\nimport Feature from '../Feature.js';\nimport Fill from '../style/Fill.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport Point from '../geom/Point.js';\nimport Stroke from '../style/Stroke.js';\nimport Style from '../style/Style.js';\nimport Text from '../style/Text.js';\nimport VectorLayer from './Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport { applyTransform, approximatelyEquals, containsCoordinate, containsExtent, equals, getCenter, getIntersection, getWidth, intersects, isEmpty, wrapX as wrapExtentX } from '../extent.js';\nimport { assign } from '../obj.js';\nimport { clamp } from '../math.js';\nimport { degreesToStringHDMS } from '../coordinate.js';\nimport { equivalent as equivalentProjection, get as getProjection, getTransform } from '../proj.js';\nimport { getVectorContext } from '../render.js';\nimport { meridian, parallel } from '../geom/flat/geodesic.js';\n/**\n * @type {Stroke}\n * @private\n * @const\n */\n\nvar DEFAULT_STROKE_STYLE = new Stroke({\n  color: 'rgba(0,0,0,0.2)'\n});\n/**\n * @type {Array<number>}\n * @private\n */\n\nvar INTERVALS = [90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001];\n/**\n * @typedef {Object} GraticuleLabelDataType\n * @property {Point} geom Geometry.\n * @property {string} text Text.\n */\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [minZoom] The minimum view zoom level (exclusive) above which this layer will be\n * visible.\n * @property {number} [maxZoom] The maximum view zoom level (inclusive) at which this layer will\n * be visible.\n * @property {number} [maxLines=100] The maximum number of meridians and\n * parallels from the center of the map. The default value of 100 means that at\n * most 200 meridians and 200 parallels will be displayed. The default value is\n * appropriate for conformal projections like Spherical Mercator. If you\n * increase the value, more lines will be drawn and the drawing performance will\n * decrease.\n * @property {Stroke} [strokeStyle] The\n * stroke style to use for drawing the graticule. If not provided, the following stroke will be used:\n * ```js\n * new Stroke({\n *   color: 'rgba(0, 0, 0, 0.2)' // a not fully opaque black\n * });\n * ```\n * @property {number} [targetSize=100] The target size of the graticule cells,\n * in pixels.\n * @property {boolean} [showLabels=false] Render a label with the respective\n * latitude/longitude for each graticule line.\n * @property {function(number):string} [lonLabelFormatter] Label formatter for\n * longitudes. This function is called with the longitude as argument, and\n * should return a formatted string representing the longitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {function(number):string} [latLabelFormatter] Label formatter for\n * latitudes. This function is called with the latitude as argument, and\n * should return a formatted string representing the latitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {number} [lonLabelPosition=0] Longitude label position in fractions\n * (0..1) of view extent. 0 means at the bottom of the viewport, 1 means at the\n * top.\n * @property {number} [latLabelPosition=1] Latitude label position in fractions\n * (0..1) of view extent. 0 means at the left of the viewport, 1 means at the\n * right.\n * @property {Text} [lonLabelStyle] Longitude label text\n * style. If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textBaseline: 'bottom',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: new Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textBaseline` configuration will not work well for\n * `lonLabelPosition` configurations that position labels close to the top of\n * the viewport.\n * @property {Text} [latLabelStyle] Latitude label text style.\n * If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textAlign: 'end',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textAlign` configuration will not work well for\n * `latLabelPosition` configurations that position labels close to the left of\n * the viewport.\n * @property {Array<number>} [intervals=[90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001]]\n * Intervals (in degrees) for the graticule. Example to limit graticules to 30 and 10 degrees intervals:\n * ```js\n * [30, 10]\n * ```\n * @property {boolean} [wrapX=true] Whether to repeat the graticule horizontally.\n * @property {Object<string, *>} [properties] Arbitrary observable properties. Can be accessed with `#get()` and `#set()`.\n */\n\n/**\n * @classdesc\n * Layer that renders a grid for a coordinate system (currently only EPSG:4326 is supported).\n * Note that the view projection must define both extent and worldExtent.\n *\n * @fires import(\"../render/Event.js\").RenderEvent\n * @extends {VectorLayer<import(\"../source/Vector.js\").default>}\n * @api\n */\n\nvar Graticule =\n/** @class */\nfunction (_super) {\n  __extends(Graticule, _super);\n  /**\n   * @param {Options} [opt_options] Options.\n   */\n\n\n  function Graticule(opt_options) {\n    var _this = this;\n\n    var options = opt_options ? opt_options : {};\n    var baseOptions = assign({\n      updateWhileAnimating: true,\n      updateWhileInteracting: true,\n      renderBuffer: 0\n    }, options);\n    delete baseOptions.maxLines;\n    delete baseOptions.strokeStyle;\n    delete baseOptions.targetSize;\n    delete baseOptions.showLabels;\n    delete baseOptions.lonLabelFormatter;\n    delete baseOptions.latLabelFormatter;\n    delete baseOptions.lonLabelPosition;\n    delete baseOptions.latLabelPosition;\n    delete baseOptions.lonLabelStyle;\n    delete baseOptions.latLabelStyle;\n    delete baseOptions.intervals;\n    _this = _super.call(this, baseOptions) || this;\n    /**\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n\n    _this.projection_ = null;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.maxLat_ = Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.maxLon_ = Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.minLat_ = -Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.minLon_ = -Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.maxX_ = Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.maxY_ = Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.minX_ = -Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.minY_ = -Infinity;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.targetSize_ = options.targetSize !== undefined ? options.targetSize : 100;\n    /**\n     * @type {number}\n     * @private\n     */\n\n    _this.maxLines_ = options.maxLines !== undefined ? options.maxLines : 100;\n    /**\n     * @type {Array<LineString>}\n     * @private\n     */\n\n    _this.meridians_ = [];\n    /**\n     * @type {Array<LineString>}\n     * @private\n     */\n\n    _this.parallels_ = [];\n    /**\n     * @type {Stroke}\n     * @private\n     */\n\n    _this.strokeStyle_ = options.strokeStyle !== undefined ? options.strokeStyle : DEFAULT_STROKE_STYLE;\n    /**\n     * @type {import(\"../proj.js\").TransformFunction|undefined}\n     * @private\n     */\n\n    _this.fromLonLatTransform_ = undefined;\n    /**\n     * @type {import(\"../proj.js\").TransformFunction|undefined}\n     * @private\n     */\n\n    _this.toLonLatTransform_ = undefined;\n    /**\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n\n    _this.projectionCenterLonLat_ = null;\n    /**\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n\n    _this.bottomLeft_ = null;\n    /**\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n\n    _this.bottomRight_ = null;\n    /**\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n\n    _this.topLeft_ = null;\n    /**\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n\n    _this.topRight_ = null;\n    /**\n     * @type {Array<GraticuleLabelDataType>}\n     * @private\n     */\n\n    _this.meridiansLabels_ = null;\n    /**\n     * @type {Array<GraticuleLabelDataType>}\n     * @private\n     */\n\n    _this.parallelsLabels_ = null;\n\n    if (options.showLabels) {\n      /**\n       * @type {null|function(number):string}\n       * @private\n       */\n      _this.lonLabelFormatter_ = options.lonLabelFormatter == undefined ? degreesToStringHDMS.bind(_this, 'EW') : options.lonLabelFormatter;\n      /**\n       * @type {function(number):string}\n       * @private\n       */\n\n      _this.latLabelFormatter_ = options.latLabelFormatter == undefined ? degreesToStringHDMS.bind(_this, 'NS') : options.latLabelFormatter;\n      /**\n       * Longitude label position in fractions (0..1) of view extent. 0 means\n       * bottom, 1 means top.\n       * @type {number}\n       * @private\n       */\n\n      _this.lonLabelPosition_ = options.lonLabelPosition == undefined ? 0 : options.lonLabelPosition;\n      /**\n       * Latitude Label position in fractions (0..1) of view extent. 0 means left, 1\n       * means right.\n       * @type {number}\n       * @private\n       */\n\n      _this.latLabelPosition_ = options.latLabelPosition == undefined ? 1 : options.latLabelPosition;\n      /**\n       * @type {Style}\n       * @private\n       */\n\n      _this.lonLabelStyleBase_ = new Style({\n        text: options.lonLabelStyle !== undefined ? options.lonLabelStyle.clone() : new Text({\n          font: '12px Calibri,sans-serif',\n          textBaseline: 'bottom',\n          fill: new Fill({\n            color: 'rgba(0,0,0,1)'\n          }),\n          stroke: new Stroke({\n            color: 'rgba(255,255,255,1)',\n            width: 3\n          })\n        })\n      });\n      /**\n       * @private\n       * @param {import(\"../Feature\").default} feature Feature\n       * @return {Style} style\n       */\n\n      _this.lonLabelStyle_ = function (feature) {\n        var label = feature.get('graticule_label');\n        this.lonLabelStyleBase_.getText().setText(label);\n        return this.lonLabelStyleBase_;\n      }.bind(_this);\n      /**\n       * @type {Style}\n       * @private\n       */\n\n\n      _this.latLabelStyleBase_ = new Style({\n        text: options.latLabelStyle !== undefined ? options.latLabelStyle.clone() : new Text({\n          font: '12px Calibri,sans-serif',\n          textAlign: 'right',\n          fill: new Fill({\n            color: 'rgba(0,0,0,1)'\n          }),\n          stroke: new Stroke({\n            color: 'rgba(255,255,255,1)',\n            width: 3\n          })\n        })\n      });\n      /**\n       * @private\n       * @param {import(\"../Feature\").default} feature Feature\n       * @return {Style} style\n       */\n\n      _this.latLabelStyle_ = function (feature) {\n        var label = feature.get('graticule_label');\n        this.latLabelStyleBase_.getText().setText(label);\n        return this.latLabelStyleBase_;\n      }.bind(_this);\n\n      _this.meridiansLabels_ = [];\n      _this.parallelsLabels_ = [];\n\n      _this.addEventListener(EventType.POSTRENDER, _this.drawLabels_.bind(_this));\n    }\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n\n\n    _this.intervals_ = options.intervals !== undefined ? options.intervals : INTERVALS; // use a source with a custom loader for lines & text\n\n    _this.setSource(new VectorSource({\n      loader: _this.loaderFunction.bind(_this),\n      strategy: _this.strategyFunction.bind(_this),\n      features: new Collection(),\n      overlaps: false,\n      useSpatialIndex: false,\n      wrapX: options.wrapX\n    }));\n    /**\n     * feature pool to use when updating graticule\n     * @type {Array<Feature>}\n     * @private\n     */\n\n\n    _this.featurePool_ = [];\n    /**\n     * @type {Style}\n     * @private\n     */\n\n    _this.lineStyle_ = new Style({\n      stroke: _this.strokeStyle_\n    });\n    /**\n     * @type {?import(\"../extent.js\").Extent}\n     * @private\n     */\n\n    _this.loadedExtent_ = null;\n    /**\n     * @type {?import(\"../extent.js\").Extent}\n     * @private\n     */\n\n    _this.renderedExtent_ = null;\n    /**\n     * @type {?number}\n     * @private\n     */\n\n    _this.renderedResolution_ = null;\n\n    _this.setRenderOrder(null);\n\n    return _this;\n  }\n  /**\n   * Strategy function for loading features based on the view's extent and\n   * resolution.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @return {Array<import(\"../extent.js\").Extent>} Extents.\n   */\n\n\n  Graticule.prototype.strategyFunction = function (extent, resolution) {\n    // extents may be passed in different worlds, to avoid endless loop we use only one\n    var realWorldExtent = extent.slice();\n\n    if (this.projection_ && this.getSource().getWrapX()) {\n      wrapExtentX(realWorldExtent, this.projection_);\n    }\n\n    if (this.loadedExtent_) {\n      if (approximatelyEquals(this.loadedExtent_, realWorldExtent, resolution)) {\n        // make sure result is exactly equal to previous extent\n        realWorldExtent = this.loadedExtent_.slice();\n      } else {\n        // we should not keep track of loaded extents\n        this.getSource().removeLoadedExtent(this.loadedExtent_);\n      }\n    }\n\n    return [realWorldExtent];\n  };\n  /**\n   * Update geometries in the source based on current view\n   * @param {import(\"../extent\").Extent} extent Extent\n   * @param {number} resolution Resolution\n   * @param {import(\"../proj/Projection.js\").default} projection Projection\n   */\n\n\n  Graticule.prototype.loaderFunction = function (extent, resolution, projection) {\n    this.loadedExtent_ = extent;\n    var source = this.getSource(); // only consider the intersection between our own extent & the requested one\n\n    var layerExtent = this.getExtent() || [-Infinity, -Infinity, Infinity, Infinity];\n    var renderExtent = getIntersection(layerExtent, extent);\n\n    if (this.renderedExtent_ && equals(this.renderedExtent_, renderExtent) && this.renderedResolution_ === resolution) {\n      return;\n    }\n\n    this.renderedExtent_ = renderExtent;\n    this.renderedResolution_ = resolution; // bail out if nothing to render\n\n    if (isEmpty(renderExtent)) {\n      return;\n    } // update projection info\n\n\n    var center = getCenter(renderExtent);\n    var squaredTolerance = resolution * resolution / 4;\n    var updateProjectionInfo = !this.projection_ || !equivalentProjection(this.projection_, projection);\n\n    if (updateProjectionInfo) {\n      this.updateProjectionInfo_(projection);\n    }\n\n    this.createGraticule_(renderExtent, center, resolution, squaredTolerance); // first make sure we have enough features in the pool\n\n    var featureCount = this.meridians_.length + this.parallels_.length;\n\n    if (this.meridiansLabels_) {\n      featureCount += this.meridians_.length;\n    }\n\n    if (this.parallelsLabels_) {\n      featureCount += this.parallels_.length;\n    }\n\n    var feature;\n\n    while (featureCount > this.featurePool_.length) {\n      feature = new Feature();\n      this.featurePool_.push(feature);\n    }\n\n    var featuresColl = source.getFeaturesCollection();\n    featuresColl.clear();\n    var poolIndex = 0; // add features for the lines & labels\n\n    var i, l;\n\n    for (i = 0, l = this.meridians_.length; i < l; ++i) {\n      feature = this.featurePool_[poolIndex++];\n      feature.setGeometry(this.meridians_[i]);\n      feature.setStyle(this.lineStyle_);\n      featuresColl.push(feature);\n    }\n\n    for (i = 0, l = this.parallels_.length; i < l; ++i) {\n      feature = this.featurePool_[poolIndex++];\n      feature.setGeometry(this.parallels_[i]);\n      feature.setStyle(this.lineStyle_);\n      featuresColl.push(feature);\n    }\n  };\n  /**\n   * @param {number} lon Longitude.\n   * @param {number} minLat Minimal latitude.\n   * @param {number} maxLat Maximal latitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {number} Index.\n   * @private\n   */\n\n\n  Graticule.prototype.addMeridian_ = function (lon, minLat, maxLat, squaredTolerance, extent, index) {\n    var lineString = this.getMeridian_(lon, minLat, maxLat, squaredTolerance, index);\n\n    if (intersects(lineString.getExtent(), extent)) {\n      if (this.meridiansLabels_) {\n        var text = this.lonLabelFormatter_(lon);\n\n        if (index in this.meridiansLabels_) {\n          this.meridiansLabels_[index].text = text;\n        } else {\n          this.meridiansLabels_[index] = {\n            geom: new Point([]),\n            text: text\n          };\n        }\n      }\n\n      this.meridians_[index++] = lineString;\n    }\n\n    return index;\n  };\n  /**\n   * @param {number} lat Latitude.\n   * @param {number} minLon Minimal longitude.\n   * @param {number} maxLon Maximal longitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {number} Index.\n   * @private\n   */\n\n\n  Graticule.prototype.addParallel_ = function (lat, minLon, maxLon, squaredTolerance, extent, index) {\n    var lineString = this.getParallel_(lat, minLon, maxLon, squaredTolerance, index);\n\n    if (intersects(lineString.getExtent(), extent)) {\n      if (this.parallelsLabels_) {\n        var text = this.latLabelFormatter_(lat);\n\n        if (index in this.parallelsLabels_) {\n          this.parallelsLabels_[index].text = text;\n        } else {\n          this.parallelsLabels_[index] = {\n            geom: new Point([]),\n            text: text\n          };\n        }\n      }\n\n      this.parallels_[index++] = lineString;\n    }\n\n    return index;\n  };\n  /**\n   * @param {import(\"../render/Event.js\").default} event Render event.\n   * @private\n   */\n\n\n  Graticule.prototype.drawLabels_ = function (event) {\n    var rotation = event.frameState.viewState.rotation;\n    var resolution = event.frameState.viewState.resolution;\n    var size = event.frameState.size;\n    var extent = event.frameState.extent;\n    var rotationCenter = getCenter(extent);\n    var rotationExtent = extent;\n\n    if (rotation) {\n      var unrotatedWidth = size[0] * resolution;\n      var unrotatedHeight = size[1] * resolution;\n      rotationExtent = [rotationCenter[0] - unrotatedWidth / 2, rotationCenter[1] - unrotatedHeight / 2, rotationCenter[0] + unrotatedWidth / 2, rotationCenter[1] + unrotatedHeight / 2];\n    }\n\n    var startWorld = 0;\n    var endWorld = 0;\n    var labelsAtStart = this.latLabelPosition_ < 0.5;\n    var projectionExtent = this.projection_.getExtent();\n    var worldWidth = getWidth(projectionExtent);\n\n    if (this.getSource().getWrapX() && this.projection_.canWrapX() && !containsExtent(projectionExtent, extent)) {\n      startWorld = Math.floor((extent[0] - projectionExtent[0]) / worldWidth);\n      endWorld = Math.ceil((extent[2] - projectionExtent[2]) / worldWidth);\n      var inverted = Math.abs(rotation) > Math.PI / 2;\n      labelsAtStart = labelsAtStart !== inverted;\n    }\n\n    var vectorContext = getVectorContext(event);\n\n    for (var world = startWorld; world <= endWorld; ++world) {\n      var poolIndex = this.meridians_.length + this.parallels_.length;\n      var feature = void 0,\n          index = void 0,\n          l = void 0,\n          textPoint = void 0;\n\n      if (this.meridiansLabels_) {\n        for (index = 0, l = this.meridiansLabels_.length; index < l; ++index) {\n          var lineString = this.meridians_[index];\n\n          if (!rotation && world === 0) {\n            textPoint = this.getMeridianPoint_(lineString, extent, index);\n          } else {\n            var clone = lineString.clone();\n            clone.translate(world * worldWidth, 0);\n            clone.rotate(-rotation, rotationCenter);\n            textPoint = this.getMeridianPoint_(clone, rotationExtent, index);\n            textPoint.rotate(rotation, rotationCenter);\n          }\n\n          feature = this.featurePool_[poolIndex++];\n          feature.setGeometry(textPoint);\n          feature.set('graticule_label', this.meridiansLabels_[index].text);\n          vectorContext.drawFeature(feature, this.lonLabelStyle_(feature));\n        }\n      }\n\n      if (this.parallelsLabels_) {\n        if (world === startWorld && labelsAtStart || world === endWorld && !labelsAtStart) {\n          for (index = 0, l = this.parallels_.length; index < l; ++index) {\n            var lineString = this.parallels_[index];\n\n            if (!rotation && world === 0) {\n              textPoint = this.getParallelPoint_(lineString, extent, index);\n            } else {\n              var clone = lineString.clone();\n              clone.translate(world * worldWidth, 0);\n              clone.rotate(-rotation, rotationCenter);\n              textPoint = this.getParallelPoint_(clone, rotationExtent, index);\n              textPoint.rotate(rotation, rotationCenter);\n            }\n\n            feature = this.featurePool_[poolIndex++];\n            feature.setGeometry(textPoint);\n            feature.set('graticule_label', this.parallelsLabels_[index].text);\n            vectorContext.drawFeature(feature, this.latLabelStyle_(feature));\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {import(\"../coordinate.js\").Coordinate} center Center.\n   * @param {number} resolution Resolution.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @private\n   */\n\n\n  Graticule.prototype.createGraticule_ = function (extent, center, resolution, squaredTolerance) {\n    var interval = this.getInterval_(resolution);\n\n    if (interval == -1) {\n      this.meridians_.length = 0;\n      this.parallels_.length = 0;\n\n      if (this.meridiansLabels_) {\n        this.meridiansLabels_.length = 0;\n      }\n\n      if (this.parallelsLabels_) {\n        this.parallelsLabels_.length = 0;\n      }\n\n      return;\n    }\n\n    var wrapX = false;\n    var projectionExtent = this.projection_.getExtent();\n    var worldWidth = getWidth(projectionExtent);\n\n    if (this.getSource().getWrapX() && this.projection_.canWrapX() && !containsExtent(projectionExtent, extent)) {\n      if (getWidth(extent) >= worldWidth) {\n        extent[0] = projectionExtent[0];\n        extent[2] = projectionExtent[2];\n      } else {\n        wrapX = true;\n      }\n    } // Constrain the center to fit into the extent available to the graticule\n\n\n    var validCenterP = [clamp(center[0], this.minX_, this.maxX_), clamp(center[1], this.minY_, this.maxY_)]; // Transform the center to lon lat\n    // Some projections may have a void area at the poles\n    // so replace any NaN latitudes with the min or max value closest to a pole\n\n    var centerLonLat = this.toLonLatTransform_(validCenterP);\n\n    if (isNaN(centerLonLat[1])) {\n      centerLonLat[1] = Math.abs(this.maxLat_) >= Math.abs(this.minLat_) ? this.maxLat_ : this.minLat_;\n    }\n\n    var centerLon = clamp(centerLonLat[0], this.minLon_, this.maxLon_);\n    var centerLat = clamp(centerLonLat[1], this.minLat_, this.maxLat_);\n    var maxLines = this.maxLines_;\n    var cnt, idx, lat, lon; // Limit the extent to fit into the extent available to the graticule\n\n    var validExtentP = extent;\n\n    if (!wrapX) {\n      validExtentP = [clamp(extent[0], this.minX_, this.maxX_), clamp(extent[1], this.minY_, this.maxY_), clamp(extent[2], this.minX_, this.maxX_), clamp(extent[3], this.minY_, this.maxY_)];\n    } // Transform the extent to get the lon lat ranges for the edges of the extent\n\n\n    var validExtent = applyTransform(validExtentP, this.toLonLatTransform_, undefined, 8);\n    var maxLat = validExtent[3];\n    var maxLon = validExtent[2];\n    var minLat = validExtent[1];\n    var minLon = validExtent[0];\n\n    if (!wrapX) {\n      // Check if extremities of the world extent lie inside the extent\n      // (for example the pole in a polar projection)\n      // and extend the extent as appropriate\n      if (containsCoordinate(validExtentP, this.bottomLeft_)) {\n        minLon = this.minLon_;\n        minLat = this.minLat_;\n      }\n\n      if (containsCoordinate(validExtentP, this.bottomRight_)) {\n        maxLon = this.maxLon_;\n        minLat = this.minLat_;\n      }\n\n      if (containsCoordinate(validExtentP, this.topLeft_)) {\n        minLon = this.minLon_;\n        maxLat = this.maxLat_;\n      }\n\n      if (containsCoordinate(validExtentP, this.topRight_)) {\n        maxLon = this.maxLon_;\n        maxLat = this.maxLat_;\n      } // The transformed center may also extend the lon lat ranges used for rendering\n\n\n      maxLat = clamp(maxLat, centerLat, this.maxLat_);\n      maxLon = clamp(maxLon, centerLon, this.maxLon_);\n      minLat = clamp(minLat, this.minLat_, centerLat);\n      minLon = clamp(minLon, this.minLon_, centerLon);\n    } // Create meridians\n\n\n    centerLon = Math.floor(centerLon / interval) * interval;\n    lon = clamp(centerLon, this.minLon_, this.maxLon_);\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, 0);\n    cnt = 0;\n\n    if (wrapX) {\n      while ((lon -= interval) >= minLon && cnt++ < maxLines) {\n        idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n      }\n    } else {\n      while (lon != this.minLon_ && cnt++ < maxLines) {\n        lon = Math.max(lon - interval, this.minLon_);\n        idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n      }\n    }\n\n    lon = clamp(centerLon, this.minLon_, this.maxLon_);\n    cnt = 0;\n\n    if (wrapX) {\n      while ((lon += interval) <= maxLon && cnt++ < maxLines) {\n        idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n      }\n    } else {\n      while (lon != this.maxLon_ && cnt++ < maxLines) {\n        lon = Math.min(lon + interval, this.maxLon_);\n        idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n      }\n    }\n\n    this.meridians_.length = idx;\n\n    if (this.meridiansLabels_) {\n      this.meridiansLabels_.length = idx;\n    } // Create parallels\n\n\n    centerLat = Math.floor(centerLat / interval) * interval;\n    lat = clamp(centerLat, this.minLat_, this.maxLat_);\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, 0);\n    cnt = 0;\n\n    while (lat != this.minLat_ && cnt++ < maxLines) {\n      lat = Math.max(lat - interval, this.minLat_);\n      idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n    }\n\n    lat = clamp(centerLat, this.minLat_, this.maxLat_);\n    cnt = 0;\n\n    while (lat != this.maxLat_ && cnt++ < maxLines) {\n      lat = Math.min(lat + interval, this.maxLat_);\n      idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n    }\n\n    this.parallels_.length = idx;\n\n    if (this.parallelsLabels_) {\n      this.parallelsLabels_.length = idx;\n    }\n  };\n  /**\n   * @param {number} resolution Resolution.\n   * @return {number} The interval in degrees.\n   * @private\n   */\n\n\n  Graticule.prototype.getInterval_ = function (resolution) {\n    var centerLon = this.projectionCenterLonLat_[0];\n    var centerLat = this.projectionCenterLonLat_[1];\n    var interval = -1;\n    var target = Math.pow(this.targetSize_ * resolution, 2);\n    /** @type {Array<number>} **/\n\n    var p1 = [];\n    /** @type {Array<number>} **/\n\n    var p2 = [];\n\n    for (var i = 0, ii = this.intervals_.length; i < ii; ++i) {\n      var delta = clamp(this.intervals_[i] / 2, 0, 90); // Don't attempt to transform latitudes beyond the poles!\n\n      var clampedLat = clamp(centerLat, -90 + delta, 90 - delta);\n      p1[0] = centerLon - delta;\n      p1[1] = clampedLat - delta;\n      p2[0] = centerLon + delta;\n      p2[1] = clampedLat + delta;\n      this.fromLonLatTransform_(p1, p1);\n      this.fromLonLatTransform_(p2, p2);\n      var dist = Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2);\n\n      if (dist <= target) {\n        break;\n      }\n\n      interval = this.intervals_[i];\n    }\n\n    return interval;\n  };\n  /**\n   * @param {number} lon Longitude.\n   * @param {number} minLat Minimal latitude.\n   * @param {number} maxLat Maximal latitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {LineString} The meridian line string.\n   * @param {number} index Index.\n   * @private\n   */\n\n\n  Graticule.prototype.getMeridian_ = function (lon, minLat, maxLat, squaredTolerance, index) {\n    var flatCoordinates = meridian(lon, minLat, maxLat, this.projection_, squaredTolerance);\n    var lineString = this.meridians_[index];\n\n    if (!lineString) {\n      lineString = new LineString(flatCoordinates, GeometryLayout.XY);\n      this.meridians_[index] = lineString;\n    } else {\n      lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n      lineString.changed();\n    }\n\n    return lineString;\n  };\n  /**\n   * @param {LineString} lineString Meridian\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {Point} Meridian point.\n   * @private\n   */\n\n\n  Graticule.prototype.getMeridianPoint_ = function (lineString, extent, index) {\n    var flatCoordinates = lineString.getFlatCoordinates();\n    var bottom = 1;\n    var top = flatCoordinates.length - 1;\n\n    if (flatCoordinates[bottom] > flatCoordinates[top]) {\n      bottom = top;\n      top = 1;\n    }\n\n    var clampedBottom = Math.max(extent[1], flatCoordinates[bottom]);\n    var clampedTop = Math.min(extent[3], flatCoordinates[top]);\n    var lat = clamp(extent[1] + Math.abs(extent[1] - extent[3]) * this.lonLabelPosition_, clampedBottom, clampedTop);\n    var coordinate0 = flatCoordinates[bottom - 1] + (flatCoordinates[top - 1] - flatCoordinates[bottom - 1]) * (lat - flatCoordinates[bottom]) / (flatCoordinates[top] - flatCoordinates[bottom]);\n    var coordinate = [coordinate0, lat];\n    var point = this.meridiansLabels_[index].geom;\n    point.setCoordinates(coordinate);\n    return point;\n  };\n  /**\n   * Get the list of meridians.  Meridians are lines of equal longitude.\n   * @return {Array<LineString>} The meridians.\n   * @api\n   */\n\n\n  Graticule.prototype.getMeridians = function () {\n    return this.meridians_;\n  };\n  /**\n   * @param {number} lat Latitude.\n   * @param {number} minLon Minimal longitude.\n   * @param {number} maxLon Maximal longitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {LineString} The parallel line string.\n   * @param {number} index Index.\n   * @private\n   */\n\n\n  Graticule.prototype.getParallel_ = function (lat, minLon, maxLon, squaredTolerance, index) {\n    var flatCoordinates = parallel(lat, minLon, maxLon, this.projection_, squaredTolerance);\n    var lineString = this.parallels_[index];\n\n    if (!lineString) {\n      lineString = new LineString(flatCoordinates, GeometryLayout.XY);\n    } else {\n      lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n      lineString.changed();\n    }\n\n    return lineString;\n  };\n  /**\n   * @param {LineString} lineString Parallels.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {Point} Parallel point.\n   * @private\n   */\n\n\n  Graticule.prototype.getParallelPoint_ = function (lineString, extent, index) {\n    var flatCoordinates = lineString.getFlatCoordinates();\n    var left = 0;\n    var right = flatCoordinates.length - 2;\n\n    if (flatCoordinates[left] > flatCoordinates[right]) {\n      left = right;\n      right = 0;\n    }\n\n    var clampedLeft = Math.max(extent[0], flatCoordinates[left]);\n    var clampedRight = Math.min(extent[2], flatCoordinates[right]);\n    var lon = clamp(extent[0] + Math.abs(extent[0] - extent[2]) * this.latLabelPosition_, clampedLeft, clampedRight);\n    var coordinate1 = flatCoordinates[left + 1] + (flatCoordinates[right + 1] - flatCoordinates[left + 1]) * (lon - flatCoordinates[left]) / (flatCoordinates[right] - flatCoordinates[left]);\n    var coordinate = [lon, coordinate1];\n    var point = this.parallelsLabels_[index].geom;\n    point.setCoordinates(coordinate);\n    return point;\n  };\n  /**\n   * Get the list of parallels.  Parallels are lines of equal latitude.\n   * @return {Array<LineString>} The parallels.\n   * @api\n   */\n\n\n  Graticule.prototype.getParallels = function () {\n    return this.parallels_;\n  };\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @private\n   */\n\n\n  Graticule.prototype.updateProjectionInfo_ = function (projection) {\n    var epsg4326Projection = getProjection('EPSG:4326');\n    var worldExtent = projection.getWorldExtent();\n    this.maxLat_ = worldExtent[3];\n    this.maxLon_ = worldExtent[2];\n    this.minLat_ = worldExtent[1];\n    this.minLon_ = worldExtent[0]; // If the world extent crosses the dateline define a custom transform to\n    // return longitudes which wrap the dateline\n\n    var toLonLatTransform = getTransform(projection, epsg4326Projection);\n\n    if (this.minLon_ < this.maxLon_) {\n      this.toLonLatTransform_ = toLonLatTransform;\n    } else {\n      var split_1 = this.minLon_ + this.maxLon_ / 2;\n      this.maxLon_ += 360;\n\n      this.toLonLatTransform_ = function (coordinates, opt_output, opt_dimension) {\n        var dimension = opt_dimension || 2;\n        var lonLatCoordinates = toLonLatTransform(coordinates, opt_output, dimension);\n\n        for (var i = 0, l = lonLatCoordinates.length; i < l; i += dimension) {\n          if (lonLatCoordinates[i] < split_1) {\n            lonLatCoordinates[i] += 360;\n          }\n        }\n\n        return lonLatCoordinates;\n      };\n    } // Transform the extent to get the limits of the view projection extent\n    // which should be available to the graticule\n\n\n    this.fromLonLatTransform_ = getTransform(epsg4326Projection, projection);\n    var worldExtentP = applyTransform([this.minLon_, this.minLat_, this.maxLon_, this.maxLat_], this.fromLonLatTransform_, undefined, 8);\n    this.minX_ = worldExtentP[0];\n    this.maxX_ = worldExtentP[2];\n    this.minY_ = worldExtentP[1];\n    this.maxY_ = worldExtentP[3]; // Determine the view projection coordinates of the extremities of the world extent\n    // as these may lie inside a view extent (for example the pole in a polar projection)\n\n    this.bottomLeft_ = this.fromLonLatTransform_([this.minLon_, this.minLat_]);\n    this.bottomRight_ = this.fromLonLatTransform_([this.maxLon_, this.minLat_]);\n    this.topLeft_ = this.fromLonLatTransform_([this.minLon_, this.maxLat_]);\n    this.topRight_ = this.fromLonLatTransform_([this.maxLon_, this.maxLat_]); // Transform the projection center to lon lat\n    // Some projections may have a void area at the poles\n    // so replace any NaN latitudes with the min or max value closest to a pole\n\n    this.projectionCenterLonLat_ = this.toLonLatTransform_(getCenter(projection.getExtent()));\n\n    if (isNaN(this.projectionCenterLonLat_[1])) {\n      this.projectionCenterLonLat_[1] = Math.abs(this.maxLat_) >= Math.abs(this.minLat_) ? this.maxLat_ : this.minLat_;\n    }\n\n    this.projection_ = projection;\n  };\n\n  return Graticule;\n}(VectorLayer);\n\nexport default Graticule;","map":{"version":3,"mappings":"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","names":["Collection","EventType","Feature","Fill","GeometryLayout","LineString","Point","Stroke","Style","Text","VectorLayer","VectorSource","applyTransform","approximatelyEquals","containsCoordinate","containsExtent","equals","getCenter","getIntersection","getWidth","intersects","isEmpty","wrapX","wrapExtentX","assign","clamp","degreesToStringHDMS","equivalent","equivalentProjection","get","getProjection","getTransform","getVectorContext","meridian","parallel","DEFAULT_STROKE_STYLE","color","INTERVALS","__extends","opt_options","options","baseOptions","updateWhileAnimating","updateWhileInteracting","renderBuffer","maxLines","strokeStyle","targetSize","showLabels","lonLabelFormatter","latLabelFormatter","lonLabelPosition","latLabelPosition","lonLabelStyle","latLabelStyle","intervals","_super","_this","projection_","maxLat_","Infinity","maxLon_","minLat_","minLon_","maxX_","maxY_","minX_","minY_","targetSize_","undefined","maxLines_","meridians_","parallels_","strokeStyle_","fromLonLatTransform_","toLonLatTransform_","projectionCenterLonLat_","bottomLeft_","bottomRight_","topLeft_","topRight_","meridiansLabels_","parallelsLabels_","lonLabelFormatter_","bind","latLabelFormatter_","lonLabelPosition_","latLabelPosition_","lonLabelStyleBase_","text","clone","font","textBaseline","fill","stroke","width","lonLabelStyle_","feature","label","getText","setText","latLabelStyleBase_","textAlign","latLabelStyle_","addEventListener","POSTRENDER","drawLabels_","intervals_","setSource","loader","loaderFunction","strategy","strategyFunction","features","overlaps","useSpatialIndex","featurePool_","lineStyle_","loadedExtent_","renderedExtent_","renderedResolution_","setRenderOrder","Graticule","extent","resolution","realWorldExtent","slice","getSource","getWrapX","removeLoadedExtent","projection","source","layerExtent","getExtent","renderExtent","center","squaredTolerance","updateProjectionInfo","updateProjectionInfo_","createGraticule_","featureCount","length","push","featuresColl","getFeaturesCollection","clear","poolIndex","i","l","setGeometry","setStyle","lon","minLat","maxLat","index","lineString","getMeridian_","geom","lat","minLon","maxLon","getParallel_","event","rotation","frameState","viewState","size","rotationCenter","rotationExtent","unrotatedWidth","unrotatedHeight","startWorld","endWorld","labelsAtStart","projectionExtent","worldWidth","canWrapX","Math","floor","ceil","inverted","abs","PI","vectorContext","world","textPoint","getMeridianPoint_","translate","rotate","set","drawFeature","getParallelPoint_","interval","getInterval_","validCenterP","centerLonLat","isNaN","centerLon","centerLat","cnt","idx","validExtentP","validExtent","addMeridian_","max","min","addParallel_","target","pow","p1","p2","ii","delta","clampedLat","dist","flatCoordinates","XY","setFlatCoordinates","changed","getFlatCoordinates","bottom","top","clampedBottom","clampedTop","coordinate0","coordinate","point","setCoordinates","left","right","clampedLeft","clampedRight","coordinate1","epsg4326Projection","worldExtent","getWorldExtent","toLonLatTransform","split_1","coordinates","opt_output","opt_dimension","dimension","lonLatCoordinates","worldExtentP"],"sourceRoot":"","sources":["../src/layer/Graticule.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}