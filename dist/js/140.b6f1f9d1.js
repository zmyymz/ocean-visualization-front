"use strict";(self["webpackChunkocean_vis"]=self["webpackChunkocean_vis"]||[]).push([[140,879],{6:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"maptitle"},[t._v("标题")]),i("div",{attrs:{id:"mapPanel1"}},[i("div",{staticClass:"titlelng",staticStyle:{"text-align":"center","font-size":"12px","font-weight":"bold","writing-mode":"tb",transform:"rotate(180deg)"}},[t._v(" Latitude(°)")]),i("div",{ref:"left",staticClass:"left"}),i("div",{staticClass:"map"}),t._m(0)]),i("div",{staticClass:"top1"}),i("div",{staticClass:"titlelng",staticStyle:{"text-align":"center","font-size":"12px","font-weight":"bold"}},[t._v("Longitude(°)")]),i("div",{attrs:{id:"mapfooter1"}},[i("div",{ref:"scale",staticClass:"scale"}),i("div",{ref:"mapval",staticClass:"mapval"},[t._v("无")]),i("div",{ref:"lnglat1",staticClass:"lnglat",attrs:{id:"lnglat1"}})])])},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"right"},[i("img",{staticClass:"legend1",staticStyle:{height:"100%"},attrs:{src:""}})])}],r=(i(8646),i(4156),{name:"Map",data(){return{map:null}},mounted(){},methods:{initMap:function(){let t=this;this.map.on("moveend",(function(e){let i="Scale 1 : "+document.getElementsByClassName("ol-scale-line1-inner")[0].innerHTML;document.getElementById("mapfooter1").getElementsByClassName("scale")[0].innerHTML=i;let s=t.map.getView().calculateExtent(),n=(s[2]-s[0])/5,r=(s[3]-s[1])/5,o="",a="";for(let t=0;t<5;t++)o+=`<div class="kedu1"><span>${(r*t+s[1]).toFixed(1)}</span></div>`,a+=`<div class="kedu2"><span>${(n*t+s[0]).toFixed(1)}</span></div>`;document.getElementById("mapPanel1").getElementsByClassName("left")[0].innerHTML=o,document.getElementsByClassName("top1")[0].innerHTML=a})),this.map.on("singleclick",(function(t){if(""===addedLayer)return void alert("请先加载影像！");let e=t.coordinate,i=e[0]-2+","+(e[1]-2)+","+(e[0]+2)+","+(e[1]+2);$.get(`/mygeoserver/geoserver/cite/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&FORMAT=image%2Fjpeg\n              &TRANSPARENT=true&QUERY_LAYERS=${addedLayer}&LAYERS=${addedLayer}&exceptions=application%2Fvnd.ogc.se_inimage&INFO_FORMAT=application%2Fjson\n              &FEATURE_COUNT=50&X=50&Y=50&SRS=EPSG%3A404000&STYLES=&WIDTH=101&HEIGHT=101&BBOX=${i}`,(t=>{let e="无";0!==t.features.length&&(e=t.features[0].properties.GRAY_INDEX.toFixed(4)),document.getElementById("mapfooter1").getElementsByClassName("mapval")[0].innerHTML=e}))}))}}}),o=r,a=i(1001),l=(0,a.Z)(o,s,n,!1,null,null,null),c=l.exports},6305:function(t,e,i){i.r(e),i.d(e,{default:function(){return Lt}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%","background-color":"#F3F2F3"}},[i("div",{staticClass:"box"},[i("div",{attrs:{id:"dashboard"}},[i("div",{staticClass:"part",attrs:{id:"data_upload"}},[t._m(0),i("div",{staticClass:"center"},[i("input",{attrs:{type:"button",value:"上传海洋数据",id:"data_btn"},on:{click:t.fileSubmit}})])]),i("div",{staticClass:"part"},[i("div",{staticClass:"title"},[i("h4",[t._v(" 选择日期 ")]),i("div",{staticClass:"container"},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}}),i("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"01:00",end:"23:00"},placeholder:"选择时间"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1)])]),i("el-divider"),i("div",{staticClass:"part",staticStyle:{"margin-bottom":"0%"}},[t._m(1),i("div",{staticStyle:{"margin-left":"5%"}},[i("el-radio-group",{staticClass:"group",attrs:{clearable:"true"},on:{change:t.getRadio},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[i("div",{staticClass:"type"},[i("el-radio",{attrs:{label:"SSH"}},[t._v("有效波高(ssh)")]),i("div",{staticClass:"choose"},[i("table",[i("el-checkbox-group",{model:{value:t.sshList,callback:function(e){t.sshList=e},expression:"sshList"}},[i("tr",[i("td",[i("el-checkbox",{attrs:{label:"v1"}},[t._v("真实值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v2"}},[t._v("预测值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v3"}},[t._v("订正值")])],1)]),i("tr",[i("td",{attrs:{colspan:"2"}},[i("el-checkbox",{attrs:{label:"v4"}},[t._v("订正前")])],1),i("td",{staticStyle:{width:"40%"}},[i("el-checkbox",{attrs:{label:"v5"}},[t._v("订正后")])],1)])])],1)])],1),i("div",{staticClass:"type"},[i("el-radio",{attrs:{label:"temp"}},[t._v("海温(temperature)")]),i("div",{staticClass:"choose"},[i("table",[i("el-checkbox-group",{model:{value:t.tempList,callback:function(e){t.tempList=e},expression:"tempList"}},[i("tr",[i("td",[i("el-checkbox",{attrs:{label:"v1"}},[t._v("真实值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v2"}},[t._v("预测值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v3"}},[t._v("订正值")])],1)]),i("tr",[i("td",{attrs:{colspan:"2"}},[i("el-checkbox",{attrs:{label:"v4"}},[t._v("订正前")])],1),i("td",{staticStyle:{width:"40%"}},[i("el-checkbox",{attrs:{label:"v5"}},[t._v("订正后")])],1)])])],1)])],1),i("div",{staticClass:"type"},[i("el-radio",{attrs:{label:"SWH"}},[t._v("综合水位(swh)")]),i("div",{staticClass:"choose"},[i("table",[i("el-checkbox-group",{model:{value:t.swhList,callback:function(e){t.swhList=e},expression:"swhList"}},[i("tr",[i("td",[i("el-checkbox",{attrs:{label:"v1"}},[t._v("真实值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v2"}},[t._v("预测值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v3"}},[t._v("订正值")])],1)]),i("tr",[i("td",{attrs:{colspan:"2"}},[i("el-checkbox",{attrs:{label:"v4"}},[t._v("订正前")])],1),i("td",{staticStyle:{width:"40%"}},[i("el-checkbox",{attrs:{label:"v5"}},[t._v("订正后")])],1)])])],1)])],1),i("div",{staticClass:"type"},[i("el-radio",{attrs:{label:"wave_direction"}},[t._v("波向(wave_direction)")]),i("div",{staticClass:"choose"},[i("table",[i("el-checkbox-group",{model:{value:t.waveList,callback:function(e){t.waveList=e},expression:"waveList"}},[i("tr",[i("td",[i("el-checkbox",{attrs:{label:"v1"}},[t._v("预报值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v2"}},[t._v("预测值")])],1),i("td",[i("el-checkbox",{attrs:{label:"v3"}},[t._v("再分析数据")])],1)]),i("tr",[i("td",{attrs:{colspan:"2"}},[i("el-checkbox",{attrs:{label:"v4"}},[t._v("再分析数据预报结果")])],1),i("td",{staticStyle:{width:"40%"}},[i("el-checkbox",{attrs:{label:"v5"}},[t._v("再分析数据预测结果")])],1)])])],1)])],1)])],1)]),i("div",[i("div",{staticClass:"center"},[i("input",{attrs:{type:"button",value:"渲染",id:"draw_btn"},on:{click:t.draw}})])])],1),i("div",{staticClass:"vis-content"},[i("div",{staticClass:"vis"},[i("OceanMap",{ref:"map1"})],1),i("div",{staticClass:"vis"},[i("OceanMap",{ref:"map2"})],1),i("div",{staticClass:"vis"},[i("OceanMap",{ref:"map3"})],1),i("div",{staticClass:"vis"},[i("OceanMap",{ref:"map4"})],1),i("div",{staticClass:"vis"},[i("OceanMap",{ref:"map5"})],1)])])])},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"title"},[i("h4",[t._v(" 数据上传 ")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"title"},[i("h4",[t._v(" 选择海洋要素数值 ")])])}],r=i(8307),o=i.n(r),a=i(6),l=(i(8646),i(9141)),c=i(4010),u=i(7654),d=i(4699),p=(i(1703),i(7730)),h=i(5856),f=i(7703),v=i(4156),_=i(876),g=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),m="units",y={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"},E=[1,2,5],b=25.4/.28,S=function(t){function e(e){var i=this,s=e||{},n=void 0!==s.className?s.className:s.bar?"ol-scale-bar":"ol-scale-line";return i=t.call(this,{element:document.createElement("div"),render:s.render,target:s.target})||this,i.on,i.once,i.un,i.innerElement_=document.createElement("div"),i.innerElement_.className=n+"-inner",i.element.className=n+" "+f.XV,i.element.appendChild(i.innerElement_),i.viewState_=null,i.minWidth_=void 0!==s.minWidth?s.minWidth:64,i.renderedVisible_=!1,i.renderedWidth_=void 0,i.renderedHTML_="",i.addChangeListener(m,i.handleUnitsChanged_),i.setUnits(s.units||y.METRIC),i.scaleBar_=s.bar||!1,i.scaleBarSteps_=s.steps||4,i.scaleBarText_=s.text||!1,i.dpi_=s.dpi||void 0,i}return g(e,t),e.prototype.getUnits=function(){return this.get(m)},e.prototype.handleUnitsChanged_=function(){this.updateElement_()},e.prototype.setUnits=function(t){this.set(m,t)},e.prototype.setDpi=function(t){this.dpi_=t},e.prototype.updateElement_=function(){var t=this.viewState_;if(t){var e=t.center,i=t.projection,s=this.getUnits(),n=s==y.DEGREES?h.ZP.DEGREES:h.ZP.METERS,r=(0,v._Q)(i,t.resolution,e,n),o=this.minWidth_*(this.dpi_||b)/b,a=o*r,l="";if(s==y.DEGREES){var c=v.Wm[h.ZP.DEGREES];a*=c,a<c/60?(l="″",r*=3600):a<c?(l="′",r*=60):l="°"}else s==y.IMPERIAL?a<.9144?(l="in",r/=.0254):a<1609.344?(l="ft",r/=.3048):(l="mi",r/=1609.344):s==y.NAUTICAL?(r/=1852,l="nm"):s==y.METRIC?a<.001?(l="μm",r*=1e6):a<1?(l="mm",r*=1e3):a<1e3?l="m":(l="km",r/=1e3):s==y.US?a<.9144?(l="in",r*=39.37):a<1609.344?(l="ft",r/=.30480061):(l="mi",r/=1609.3472):(0,_.h)(!1,33);var u,d,p,f,g=3*Math.floor(Math.log(o*r)/Math.log(10));while(1){p=Math.floor(g/3);var m=Math.pow(10,p);if(u=E[(g%3+3)%3]*m,d=Math.round(u/r),isNaN(d))return this.element.style.display="none",void(this.renderedVisible_=!1);if(d>=o)break;++g}f=this.scaleBar_?this.createScaleBar(d,u,l):u.toFixed(p<0?-p:0)+" "+l,this.renderedHTML_!=f&&(this.innerElement_.innerHTML=f,this.renderedHTML_=f),this.renderedWidth_!=d&&(this.innerElement_.style.width=d+"px",this.renderedWidth_=d),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.createScaleBar=function(t,e,i){for(var s,n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),r=[],o=t/this.scaleBarSteps_,a="#ffffff",l=0;l<this.scaleBarSteps_;l++)0===l&&r.push(this.createMarker("absolute",l)),r.push('<div><div class="ol-scale-singlebar" style="width: '+o+"px;background-color: "+a+';"></div>'+this.createMarker("relative",l)+(l%2===0||2===this.scaleBarSteps_?this.createStepText(l,t,!1,e,i):"")+"</div>"),l===this.scaleBarSteps_-1&&r.push(this.createStepText(l+1,t,!0,e,i)),a="#ffffff"===a?"#000000":"#ffffff";s=this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+n+"</div>":"";var c='<div style="display: flex;">'+s+r.join("")+"</div>";return c},e.prototype.createMarker=function(t,e){var i="absolute"===t?3:-10;return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+i+'px;"></div>'},e.prototype.createStepText=function(t,e,i,s,n){var r=0===t?0:Math.round(s/this.scaleBarSteps_*t*100)/100,o=r+(0===t?"":" "+n),a=0===t?-3:e/this.scaleBarSteps_*-1,l=0===t?0:e/this.scaleBarSteps_*2;return'<div class="ol-scale-step-text" style="margin-left: '+a+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+l+"px;left: "+(i?e+"px":"unset")+';">'+o+"</div>"},e.prototype.getScaleForResolution=function(){var t=(0,v._Q)(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,h.ZP.METERS),e=this.dpi_||b,i=1e3/25.4;return parseFloat(t.toString())*i*e},e.prototype.render=function(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()},e}(p.Z),w=S,T=i(3460),x=i(1262),C=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),L="projection",M="coordinateFormat",R=function(t){function e(e){var i=this,s=e||{},n=document.createElement("div");n.className=void 0!==s.className?s.className:"ol-mouse-position",i=t.call(this,{element:n,render:s.render,target:s.target})||this,i.on,i.once,i.un,i.addChangeListener(L,i.handleProjectionChanged_),s.coordinateFormat&&i.setCoordinateFormat(s.coordinateFormat),s.projection&&i.setProjection(s.projection);var r=!0,o="&#160;";return"undefinedHTML"in s?(void 0!==s.undefinedHTML&&(o=s.undefinedHTML),r=!!o):"placeholder"in s&&(!1===s.placeholder?r=!1:o=String(s.placeholder)),i.placeholder_=o,i.renderOnMouseOut_=r,i.renderedHTML_=n.innerHTML,i.mapProjection_=null,i.transform_=null,i}return C(e,t),e.prototype.handleProjectionChanged_=function(){this.transform_=null},e.prototype.getCoordinateFormat=function(){return this.get(M)},e.prototype.getProjection=function(){return this.get(L)},e.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))},e.prototype.handleMouseOut=function(t){this.updateHTML_(null)},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getViewport();this.listenerKeys.push((0,x.oL)(i,T.Z.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,x.oL)(i,T.Z.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}},e.prototype.setCoordinateFormat=function(t){this.set(M,t)},e.prototype.setProjection=function(t){this.set(L,(0,v.U2)(t))},e.prototype.updateHTML_=function(t){var e=this.placeholder_;if(t&&this.mapProjection_){if(!this.transform_){var i=this.getProjection();this.transform_=i?(0,v.WO)(this.mapProjection_,i):v.gD}var s=this.getMap(),n=s.getCoordinateFromPixelInternal(t);if(n){var r=(0,v.Cs)();r&&(this.transform_=(0,v.WO)(this.mapProjection_,r)),this.transform_(n,n);var o=this.getCoordinateFormat();e=o?o(n):n.toString()}}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=e,this.renderedHTML_=e)},e.prototype.render=function(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null},e}(p.Z),k=R,F=i(186),A=i(7806),O=i(1953),N=i(187),P=i(7037),I=i(5270),B=i(5758),j=i(8735),H=i(7679),V=i(4407),U=i(7861),Z=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),D=function(t){function e(e){var i=this,s=e||{},n=void 0===s.imageSmoothing||s.imageSmoothing;void 0!==s.interpolate&&(n=s.interpolate);var r=s.params||{},o=!("TRANSPARENT"in r)||r["TRANSPARENT"];return i=t.call(this,{attributions:s.attributions,attributionsCollapsible:s.attributionsCollapsible,cacheSize:s.cacheSize,crossOrigin:s.crossOrigin,interpolate:n,opaque:!o,projection:s.projection,reprojectionErrorThreshold:s.reprojectionErrorThreshold,tileClass:s.tileClass,tileGrid:s.tileGrid,tileLoadFunction:s.tileLoadFunction,url:s.url,urls:s.urls,wrapX:void 0===s.wrapX||s.wrapX,transition:s.transition,zDirection:s.zDirection})||this,i.gutter_=void 0!==s.gutter?s.gutter:0,i.params_=r,i.v13_=!0,i.serverType_=s.serverType,i.hidpi_=void 0===s.hidpi||s.hidpi,i.tmpExtent_=(0,I.lJ)(),i.updateV13_(),i.setKey(i.getKeyForParams_()),i}return Z(e,t),e.prototype.getFeatureInfoUrl=function(t,e,i,s){var n=(0,v.U2)(i),r=this.getProjection(),o=this.getTileGrid();o||(o=this.getTileGridForProjection(n));var a=o.getZForResolution(e,this.zDirection),l=o.getTileCoordForCoordAndZ(t,a);if(!(o.getResolutions().length<=l[0])){var c=o.getResolution(l[0]),u=o.getTileCoordExtent(l,this.tmpExtent_),d=(0,B.Pq)(o.getTileSize(l[0]),this.tmpSize),p=this.gutter_;0!==p&&(d=(0,B.f3)(d,p,this.tmpSize),u=(0,I.f3)(u,c*p,u)),r&&r!==n&&(c=(0,j.aA)(r,n,t,c),u=(0,v.$A)(u,n,r),t=(0,v.vs)(t,n,r));var h={SERVICE:"WMS",VERSION:F.E,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_["LAYERS"]};(0,P.f0)(h,this.params_,s);var f=Math.floor((t[0]-u[0])/c),_=Math.floor((u[3]-t[1])/c);return h[this.v13_?"I":"X"]=f,h[this.v13_?"J":"Y"]=_,this.getRequestUrl_(l,d,u,1,r||n,h)}},e.prototype.getLegendUrl=function(t,e){if(void 0!==this.urls[0]){var i={SERVICE:"WMS",VERSION:F.E,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e["LAYER"]){var s=this.params_.LAYERS,n=!Array.isArray(s)||1===s.length;if(!n)return;i["LAYER"]=s}if(void 0!==t){var r=this.getProjection()?this.getProjection().getMetersPerUnit():1,o=28e-5;i["SCALE"]=t*r/o}return(0,P.f0)(i,e),(0,N.B)(this.urls[0],i)}},e.prototype.getGutter=function(){return this.gutter_},e.prototype.getParams=function(){return this.params_},e.prototype.getRequestUrl_=function(t,e,i,s,n,r){var o=this.urls;if(o){if(r["WIDTH"]=e[0],r["HEIGHT"]=e[1],r[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(r["STYLES"]=""),1!=s)switch(this.serverType_){case O.Z.GEOSERVER:var a=90*s+.5|0;"FORMAT_OPTIONS"in r?r["FORMAT_OPTIONS"]+=";dpi:"+a:r["FORMAT_OPTIONS"]="dpi:"+a;break;case O.Z.MAPSERVER:r["MAP_RESOLUTION"]=90*s;break;case O.Z.CARMENTA_SERVER:case O.Z.QGIS:r["DPI"]=90*s;break;default:(0,_.h)(!1,52);break}var l,c=n.getAxisOrientation(),u=i;if(this.v13_&&"ne"==c.substr(0,2)){var d=void 0;d=i[0],u[0]=i[1],u[1]=d,d=i[2],u[2]=i[3],u[3]=d}if(r["BBOX"]=u.join(","),1==o.length)l=o[0];else{var p=(0,V.$W)((0,U.vp)(t),o.length);l=o[p]}return(0,N.B)(l,r)}},e.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},e.prototype.getKeyForParams_=function(){var t=0,e=[];for(var i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},e.prototype.updateParams=function(t){(0,P.f0)(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},e.prototype.updateV13_=function(){var t=this.params_["VERSION"]||F.E;this.v13_=(0,H.n)(t,"1.3")>=0},e.prototype.tileUrlFunction=function(t,e,i){var s=this.getTileGrid();if(s||(s=this.getTileGridForProjection(i)),!(s.getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var n=s.getResolution(t[0]),r=s.getTileCoordExtent(t,this.tmpExtent_),o=(0,B.Pq)(s.getTileSize(t[0]),this.tmpSize),a=this.gutter_;0!==a&&(o=(0,B.f3)(o,a,this.tmpSize),r=(0,I.f3)(r,n*a,r)),1!=e&&(o=(0,B.bA)(o,e,this.tmpSize));var l={SERVICE:"WMS",VERSION:F.E,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return(0,P.f0)(l,this.params_),this.getRequestUrl_(t,o,r,e,i,l)}},e}(A.Z),G=D,W=i(4009),Y=i(3773),$=i(2758),q=i(102),X=i(6781),z=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),Q=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],K={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"},J=function(t){function e(e){var i=this,s=e||{};i=t.call(this,{element:document.createElement("div"),target:s.target})||this,i.on,i.once,i.un,i.cssClassName_=void 0!==s.className?s.className:"ol-full-screen",i.documentListeners_=[],i.activeClassName_=void 0!==s.activeClassName?s.activeClassName.split(" "):[i.cssClassName_+"-true"],i.inactiveClassName_=void 0!==s.inactiveClassName?s.inactiveClassName.split(" "):[i.cssClassName_+"-false"];var n=void 0!==s.label?s.label:"⤢";i.labelNode_="string"===typeof n?document.createTextNode(n):n;var r=void 0!==s.labelActive?s.labelActive:"×";i.labelActiveNode_="string"===typeof r?document.createTextNode(r):r,i.button_=document.createElement("button");var o=s.tipLabel?s.tipLabel:"Toggle full-screen";return i.button_.setAttribute("type","button"),i.button_.title=o,i.button_.appendChild(i.labelNode_),i.button_.addEventListener($.Z.CLICK,i.handleClick_.bind(i),!1),i.element.className="".concat(i.cssClassName_," ").concat(f.XV," ").concat(f.hg),i.element.appendChild(i.button_),i.keys_=void 0!==s.keys&&s.keys,i.source_=s.source,i.isInFullscreen_=!1,i.boundHandleMapTargetChange_=i.handleMapTargetChange_.bind(i),i}return z(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),this.handleFullScreen_()},e.prototype.handleFullScreen_=function(){var t=this.getMap();if(t){var e=t.getOwnerDocument();if(tt(e))if(et(e))nt(e);else{var i=void 0;i=this.source_?"string"===typeof this.source_?e.getElementById(this.source_):this.source_:t.getTargetElement(),this.keys_?st(i):it(i)}}},e.prototype.handleFullScreenChange_=function(){var t=this.getMap();if(t){var e=this.isInFullscreen_;this.isInFullscreen_=et(t.getOwnerDocument()),e!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?((0,X.$H)(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(K.ENTERFULLSCREEN)):((0,X.$H)(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(K.LEAVEFULLSCREEN)),t.updateSize())}},e.prototype.setClassName_=function(t,e){var i,s,n,r=this.activeClassName_,o=this.inactiveClassName_,a=e?r:o;(i=t.classList).remove.apply(i,r),(s=t.classList).remove.apply(s,o),(n=t.classList).add.apply(n,a)},e.prototype.setMap=function(e){var i=this.getMap();i&&i.removeChangeListener(q.Z.TARGET,this.boundHandleMapTargetChange_),t.prototype.setMap.call(this,e),this.handleMapTargetChange_(),e&&e.addChangeListener(q.Z.TARGET,this.boundHandleMapTargetChange_)},e.prototype.handleMapTargetChange_=function(){for(var t=this.documentListeners_,e=0,i=t.length;e<i;++e)(0,x.bN)(t[e]);t.length=0;var s=this.getMap();if(s){var n=s.getOwnerDocument();tt(n)?this.element.classList.remove(f.Qi):this.element.classList.add(f.Qi);for(e=0,i=Q.length;e<i;++e)t.push((0,x.oL)(n,Q[e],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}},e}(p.Z);function tt(t){var e=t.body;return!!(e["webkitRequestFullscreen"]||e["msRequestFullscreen"]&&t["msFullscreenEnabled"]||e.requestFullscreen&&t.fullscreenEnabled)}function et(t){return!!(t["webkitIsFullScreen"]||t["msFullscreenElement"]||t.fullscreenElement)}function it(t){t.requestFullscreen?t.requestFullscreen():t["msRequestFullscreen"]?t["msRequestFullscreen"]():t["webkitRequestFullscreen"]&&t["webkitRequestFullscreen"]()}function st(t){t["webkitRequestFullscreen"]?t["webkitRequestFullscreen"]():it(t)}function nt(t){t.exitFullscreen?t.exitFullscreen():t["msExitFullscreen"]?t["msExitFullscreen"]():t["webkitExitFullscreen"]&&t["webkitExitFullscreen"]()}var rt=J,ot=i(8055),at=i(2031),lt=i(1843),ct=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),ut=function(t){function e(e){var i=this,s=e||{};return i=t.call(this,s)||this,i.condition_=s.condition?s.condition:lt.vY,i.lastAngle_=void 0,i.lastMagnitude_=void 0,i.lastScaleDelta_=0,i.duration_=void 0!==s.duration?s.duration:400,i}return ct(e,t),e.prototype.handleDragEvent=function(t){if((0,lt.QL)(t)){var e=t.map,i=e.getSize(),s=t.pixel,n=s[0]-i[0]/2,r=i[1]/2-s[1],o=Math.atan2(r,n),a=Math.sqrt(n*n+r*r),l=e.getView();if(void 0!==this.lastAngle_){var c=this.lastAngle_-o;l.adjustRotationInternal(c)}this.lastAngle_=o,void 0!==this.lastMagnitude_&&l.adjustResolutionInternal(this.lastMagnitude_/a),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/a),this.lastMagnitude_=a}},e.prototype.handleUpEvent=function(t){if(!(0,lt.QL)(t))return!0;var e=t.map,i=e.getView(),s=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,s),this.lastScaleDelta_=0,!1},e.prototype.handleDownEvent=function(t){return!!(0,lt.QL)(t)&&(!!this.condition_(t)&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))},e}(at.Z),dt=ut,pt=i(5430),ht=i(4142),ft=i(1505),vt=i(8462),_t=i(6739),gt=i(8263),mt=i(6386),yt=i(1021),Et="#333",bt=function(){function t(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=(0,B.Pq)(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new mt.Z({color:Et}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:yt.Z.POINT,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return t.prototype.clone=function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})},t.prototype.getOverflow=function(){return this.overflow_},t.prototype.getFont=function(){return this.font_},t.prototype.getMaxAngle=function(){return this.maxAngle_},t.prototype.getPlacement=function(){return this.placement_},t.prototype.getOffsetX=function(){return this.offsetX_},t.prototype.getOffsetY=function(){return this.offsetY_},t.prototype.getFill=function(){return this.fill_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.getText=function(){return this.text_},t.prototype.getTextAlign=function(){return this.textAlign_},t.prototype.getTextBaseline=function(){return this.textBaseline_},t.prototype.getBackgroundFill=function(){return this.backgroundFill_},t.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},t.prototype.getPadding=function(){return this.padding_},t.prototype.setOverflow=function(t){this.overflow_=t},t.prototype.setFont=function(t){this.font_=t},t.prototype.setMaxAngle=function(t){this.maxAngle_=t},t.prototype.setOffsetX=function(t){this.offsetX_=t},t.prototype.setOffsetY=function(t){this.offsetY_=t},t.prototype.setPlacement=function(t){this.placement_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setFill=function(t){this.fill_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=(0,B.Pq)(void 0!==t?t:1)},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.setText=function(t){this.text_=t},t.prototype.setTextAlign=function(t){this.textAlign_=t},t.prototype.setTextBaseline=function(t){this.textBaseline_=t},t.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},t.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},t.prototype.setPadding=function(t){this.padding_=t},t}(),St=bt,wt={data(){return{value1:"",value2:"",radio:"",sshList:[],tempList:[],swhList:[],waveList:[],mylayer:"",select1:["Real","pred","Corr","Error_Before","Error_After"],select2:["forecast","predict","reanalysis","reanalysis-forecast","reanalysis-predict"],listDic:["v1","v2","v3","v4","v5"],middle_names:[],maps:[],wmsLayers:[],vectorLayers:[],coordinates:[160,6]}},components:{OceanMap:a["default"]},methods:{getLocalTime(t){return new Date(1e3*parseInt(t)).toLocaleString().replace(/:\d{1,2}$/," ")},fileSubmit(){let t=this;this.$MessageBox.alert("请将nc文件放置到/opt/temp/home/ocean/user_ocean_data/, 然后点击确定","提示",{confirmButtonText:"确定",callback:e=>{if("confirm"===e){const e=o().service({fullscreen:!0,lock:!0,text:"正在处理中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$http.get("api/ocean/processOceanData").then((function(i){let s=i.data.success;!0===s?(e.close(),t.$Message("上传成功")):!1===s&&(e.close(),console.log(i),t.$Message("发生异常 "+i.data.message))}))}}})},initMap(t){let e=new u.Z({title:"谷歌矢量地图服务",source:new d.Z({url:"http://ocean-vis-http-server:8081/Ocean/{z}/{x}/{y}.png"})}),i=new l.Z({target:document.getElementsByClassName("map")[t],layers:[e],view:new c.ZP({projection:"EPSG:4326",center:[113,12],zoom:4}),interactions:(0,ot.ce)().extend([new dt]),controls:(0,W.ce)().extend([])});var s="mouse-position",n=new k({coordinateFormat:function(t){return(0,Y.WU)(t,"经度:{x} 纬度:{y}",2)},projection:"EPSG:4326",className:"custom-position",target:document.getElementById(s),undefinedHTML:"&#160;"});i.addControl(n),i.addControl(new rt),i.addControl(new w),this.maps.push(i),this.showInfo(t)},showInfo(t){let e=this;e.maps[t].on("moveend",(function(i){let s=e.maps[t].getView().calculateExtent(),n=(s[2]-s[0])/5,r=(s[3]-s[1])/5,o="",a="";for(let t=0;t<5;t++)o+=`<div class="kedu1"><span>${(r*t+s[1]).toFixed(1)}</span></div>`,a+=`<div class="kedu2"><span>${(n*t+s[0]).toFixed(1)}</span></div>`;document.getElementsByClassName("left")[t].innerHTML=o,document.getElementsByClassName("top1")[t].innerHTML=a})),this.maps[t].on("singleclick",(async i=>{let s=i.coordinate;this.coordinates[0]=i.coordinate[0],this.coordinates[1]=i.coordinate[1];s[0],s[1],s[0],s[1];let n=e.maps[t].getView().getResolution(),r=e.wmsLayers[t].getSource().getFeatureInfoUrl(s,n,"EPSG:4326",{INFO_FORMAT:"application/json",VERSION:"1.1.1",FORMAT:"image/png"});if(r){let e=await fetch(r).then((function(t){return t.text()}));e=JSON.parse(e);let i=e.features[0].properties.GRAY_INDEX.toFixed(4);document.getElementsByClassName("mapval")[t].innerHTML=i}}))},getMiddle(t,e){let i=[!1,!1,!1,!1,!1];for(let s=0;s<t.length;s++){let n=this.listDic.indexOf(t[s]);i[n]=!0,this.middle_names.push(e[n])}for(let s=0;s<i.length;s++)i[s]||this.middle_names.push(e[s])},draw(){if(this.middle_names=[],""!==this.value1&&""!==this.value2)if(""===this.radio)alert("请勾选海洋要素数值！");else{let i=this.radio,s=!1,n=null;if("SSH"===i?0===this.sshList.length?s=!0:(n=this.sshList,this.getMiddle(n,this.select1)):"temp"===i?0===this.tempList.length?s=!0:(n=this.tempList,this.getMiddle(n,this.select1)):"SWH"===i?0===this.swhList.length?s=!0:(n=this.swhList,this.getMiddle(n,this.select1)):"wave_direction"===i&&(0===this.waveList.length?s=!0:(n=this.waveList,this.getMiddle(n,this.select2))),s)return void alert("请勾选有单选框的复选框选项");{let i=this.value1+" "+this.value2,s=new Date(i).getTime();for(let t=0;t<this.wmsLayers.length;t++)this.maps[t]&&this.maps[t].removeLayer(this.wmsLayers[t]);this.wmsLayers=[],this.vectorLayers=[];for(let n=0;n<5;n++){let i=this.maps[n],r=this.middle_names[n],o=this.radio;var t="",e="";"SSH"===o?t="有效波高(ssh)":"temp"===o?t="海温(temperature)":"SWH"===o?t="综合水位(swh)":"wave_direction"===o&&(t="波向(wave_direction)"),"Real"===r?e="真实值":"pred"===r?e="预测值":"Corr"===r?e="订正值":"Error_Before"===r?e="订正前":"Error_After"===r?e="订正后":"forecast"===r?e="预报值":"predict"===r?e="预测值":"reanalysis"===r?e="再分析数据":("reanalysis-forecast"===r||"reanalysis-predict"===r)&&(e="再分析数据预报结果"),document.getElementsByClassName("maptitle")[n].innerHTML=t+"_"+e,"temp"===o&&("pred"===r?r="fore":"Corr"===r?r="corr":"Real"===r&&(r="real"));let a=o+"_"+r+"_"+s;this.mylayer="cite:"+a,this.init(i,n)}}}else alert("请选择日期，时间")},getRadio(){this.sshList=[],this.tempList=[],this.swhList=[],this.waveList=[]},init(t,e){let i=new G({url:"vector/geoserver/cite/wms",params:{LAYERS:this.mylayer,TILED:!0,VERSION:"1.1.1",FORMAT:"image/png"},serverType:"geoserver",transition:0});var s=new u.Z({source:i});this.wmsLayers.push(s),t.addLayer(s);let n=i.getLegendUrl(t.getView().getResolution()),r=document.getElementsByClassName("legend1")[e];console.log(i),r.src=n;var o=new pt.Z({type:"icon",geometry:new ht.Z([this.coordinates[0]+5,this.coordinates[1]])}),a=new ft.Z({source:new vt.Z({features:[o]}),style:new _t.ZP({image:new gt.Z({anchor:[.5,1],src:n}),text:new St({text:"图例",font:"14px font-size",fill:new mt.Z({color:"#000000"}),offsetY:10})})});this.vectorLayers.push(a),t.addLayer(a)}},mounted(){for(let t=0;t<5;t++)this.initMap(t)}},Tt=wt,xt=i(1001),Ct=(0,xt.Z)(Tt,s,n,!1,null,null,null),Lt=Ct.exports}}]);
//# sourceMappingURL=140.b6f1f9d1.js.map