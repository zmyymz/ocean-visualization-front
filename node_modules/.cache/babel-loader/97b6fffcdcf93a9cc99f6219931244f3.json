{"ast":null,"code":"import \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.string.match.js\";\nimport \"core-js/modules/es.array.sort.js\";\n\n/**\n * @module ol/format/IIIFInfo\n */\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport { assert } from '../asserts.js';\nimport { includes } from '../array.js';\n/**\n * @typedef {Object} PreferredOptions\n * @property {string} [format] Preferred image format. Will be used if the image information\n * indicates support for that format.\n * @property {string} [quality] IIIF image qualitiy.  Will be used if the image information\n * indicates support for that quality.\n */\n\n/**\n * @typedef {Object} SupportedFeatures\n * @property {Array<string>} [supports] Supported IIIF image size and region\n * calculation features.\n * @property {Array<string>} [formats] Supported image formats.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n */\n\n/**\n * @typedef {Object} TileInfo\n * @property {Array<number>} scaleFactors Supported resolution scaling factors.\n * @property {number} width Tile width in pixels.\n * @property {number} [height] Tile height in pixels. Same as tile width if height is\n * not given.\n */\n\n/**\n * @typedef {Object} IiifProfile\n * @property {Array<string>} [formats] Supported image formats for the image service.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n * @property {Array<string>} [supports] Supported features.\n * @property {number} [maxArea] Maximum area (pixels) available for this image service.\n * @property {number} [maxHeight] Maximum height.\n * @property {number} [maxWidth] Maximum width.\n */\n\n/**\n * @typedef {Object<string,string|number|Array<number|string|IiifProfile|Object<string, number>|TileInfo>>}\n *    ImageInformationResponse\n */\n\n/**\n * Enum representing the major IIIF Image API versions\n * @enum {string}\n */\n\nexport var Versions = {\n  VERSION1: 'version1',\n  VERSION2: 'version2',\n  VERSION3: 'version3'\n};\n/**\n * Supported image formats, qualities and supported region / size calculation features\n * for different image API versions and compliance levels\n * @const\n * @type {Object<string, Object<string, SupportedFeatures>>}\n */\n\nvar IIIF_PROFILE_VALUES = {};\nIIIF_PROFILE_VALUES[Versions.VERSION1] = {\n  'level0': {\n    supports: [],\n    formats: [],\n    qualities: ['native']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['native']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['native', 'color', 'grey', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION2] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByDistortedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION3] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'regionSquare', 'sizeByW', 'sizeByH', 'sizeByWh'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionSquare', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default']\n  }\n};\nIIIF_PROFILE_VALUES['none'] = {\n  'none': {\n    supports: [],\n    formats: [],\n    qualities: []\n  }\n};\nvar COMPLIANCE_VERSION1 = /^https?:\\/\\/library\\.stanford\\.edu\\/iiif\\/image-api\\/(?:1\\.1\\/)?compliance\\.html#level[0-2]$/;\nvar COMPLIANCE_VERSION2 = /^https?:\\/\\/iiif\\.io\\/api\\/image\\/2\\/level[0-2](?:\\.json)?$/;\nvar COMPLIANCE_VERSION3 = /(^https?:\\/\\/iiif\\.io\\/api\\/image\\/3\\/level[0-2](?:\\.json)?$)|(^level[0-2]$)/;\n\nfunction generateVersion1Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(); // Version 1.0 and 1.1 do not require a profile.\n\n  if (levelProfile === undefined) {\n    levelProfile = IIIF_PROFILE_VALUES[Versions.VERSION1]['level0'];\n  }\n\n  return {\n    url: iiifInfo.imageInfo['@id'] === undefined ? undefined : iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    supports: levelProfile.supports,\n    formats: __spreadArray(__spreadArray([], levelProfile.formats, true), [iiifInfo.imageInfo.formats === undefined ? [] : iiifInfo.imageInfo.formats], false),\n    qualities: __spreadArray(__spreadArray([], levelProfile.qualities, true), [iiifInfo.imageInfo.qualities === undefined ? [] : iiifInfo.imageInfo.qualities], false),\n    resolutions: iiifInfo.imageInfo.scale_factors,\n    tileSize: iiifInfo.imageInfo.tile_width !== undefined ? iiifInfo.imageInfo.tile_height !== undefined ? [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_height] : [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_width] : iiifInfo.imageInfo.tile_height != undefined ? [iiifInfo.imageInfo.tile_height, iiifInfo.imageInfo.tile_height] : undefined\n  };\n}\n\nfunction generateVersion2Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n      additionalProfile = Array.isArray(iiifInfo.imageInfo.profile) && iiifInfo.imageInfo.profile.length > 1,\n      profileSupports = additionalProfile && iiifInfo.imageInfo.profile[1].supports ? iiifInfo.imageInfo.profile[1].supports : [],\n      profileFormats = additionalProfile && iiifInfo.imageInfo.profile[1].formats ? iiifInfo.imageInfo.profile[1].formats : [],\n      profileQualities = additionalProfile && iiifInfo.imageInfo.profile[1].qualities ? iiifInfo.imageInfo.profile[1].qualities : [];\n  return {\n    url: iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height === undefined ? tile.width : tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: __spreadArray(__spreadArray([], levelProfile.supports, true), profileSupports, true),\n    formats: __spreadArray(__spreadArray([], levelProfile.formats, true), profileFormats, true),\n    qualities: __spreadArray(__spreadArray([], levelProfile.qualities, true), profileQualities, true)\n  };\n}\n\nfunction generateVersion3Options(iiifInfo) {\n  var levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n      formats = iiifInfo.imageInfo.extraFormats === undefined ? levelProfile.formats : __spreadArray(__spreadArray([], levelProfile.formats, true), iiifInfo.imageInfo.extraFormats, true),\n      preferredFormat = iiifInfo.imageInfo.preferredFormats !== undefined && Array.isArray(iiifInfo.imageInfo.preferredFormats) && iiifInfo.imageInfo.preferredFormats.length > 0 ? iiifInfo.imageInfo.preferredFormats.filter(function (format) {\n    return includes(['jpg', 'png', 'gif'], format);\n  }).reduce(function (acc, format) {\n    return acc === undefined && includes(formats, format) ? format : acc;\n  }, undefined) : undefined;\n  return {\n    url: iiifInfo.imageInfo['id'],\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: iiifInfo.imageInfo.extraFeatures === undefined ? levelProfile.supports : __spreadArray(__spreadArray([], levelProfile.supports, true), iiifInfo.imageInfo.extraFeatures, true),\n    formats: formats,\n    qualities: iiifInfo.imageInfo.extraQualities === undefined ? levelProfile.qualities : __spreadArray(__spreadArray([], levelProfile.qualities, true), iiifInfo.imageInfo.extraQualities, true),\n    preferredFormat: preferredFormat\n  };\n}\n\nvar versionFunctions = {};\nversionFunctions[Versions.VERSION1] = generateVersion1Options;\nversionFunctions[Versions.VERSION2] = generateVersion2Options;\nversionFunctions[Versions.VERSION3] = generateVersion3Options;\n/**\n * @classdesc\n * Format for transforming IIIF Image API image information responses into\n * IIIF tile source ready options\n *\n * @api\n */\n\nvar IIIFInfo =\n/** @class */\nfunction () {\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   */\n  function IIIFInfo(imageInfo) {\n    this.setImageInfo(imageInfo);\n  }\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   * @api\n   */\n\n\n  IIIFInfo.prototype.setImageInfo = function (imageInfo) {\n    if (typeof imageInfo == 'string') {\n      this.imageInfo = JSON.parse(imageInfo);\n    } else {\n      this.imageInfo = imageInfo;\n    }\n  };\n  /**\n   * @return {Versions} Major IIIF version.\n   * @api\n   */\n\n\n  IIIFInfo.prototype.getImageApiVersion = function () {\n    if (this.imageInfo === undefined) {\n      return;\n    }\n\n    var context = this.imageInfo['@context'] || 'ol-no-context';\n\n    if (typeof context == 'string') {\n      context = [context];\n    }\n\n    for (var i = 0; i < context.length; i++) {\n      switch (context[i]) {\n        case 'http://library.stanford.edu/iiif/image-api/1.1/context.json':\n        case 'http://iiif.io/api/image/1/context.json':\n          return Versions.VERSION1;\n\n        case 'http://iiif.io/api/image/2/context.json':\n          return Versions.VERSION2;\n\n        case 'http://iiif.io/api/image/3/context.json':\n          return Versions.VERSION3;\n\n        case 'ol-no-context':\n          // Image API 1.0 has no '@context'\n          if (this.getComplianceLevelEntryFromProfile(Versions.VERSION1) && this.imageInfo.identifier) {\n            return Versions.VERSION1;\n          }\n\n          break;\n\n        default:\n      }\n    }\n\n    assert(false, 61);\n  };\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level as it appears in the IIIF image information\n   * response.\n   */\n\n\n  IIIFInfo.prototype.getComplianceLevelEntryFromProfile = function (version) {\n    if (this.imageInfo === undefined || this.imageInfo.profile === undefined) {\n      return;\n    }\n\n    if (version === undefined) {\n      version = this.getImageApiVersion();\n    }\n\n    switch (version) {\n      case Versions.VERSION1:\n        if (COMPLIANCE_VERSION1.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n\n        break;\n\n      case Versions.VERSION3:\n        if (COMPLIANCE_VERSION3.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n\n        break;\n\n      case Versions.VERSION2:\n        if (typeof this.imageInfo.profile === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n\n        if (Array.isArray(this.imageInfo.profile) && this.imageInfo.profile.length > 0 && typeof this.imageInfo.profile[0] === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile[0])) {\n          return this.imageInfo.profile[0];\n        }\n\n        break;\n\n      default:\n    }\n  };\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level, on of 'level0', 'level1' or 'level2' or undefined\n   */\n\n\n  IIIFInfo.prototype.getComplianceLevelFromProfile = function (version) {\n    var complianceLevel = this.getComplianceLevelEntryFromProfile(version);\n\n    if (complianceLevel === undefined) {\n      return undefined;\n    }\n\n    var level = complianceLevel.match(/level[0-2](?:\\.json)?$/g);\n    return Array.isArray(level) ? level[0].replace('.json', '') : undefined;\n  };\n  /**\n   * @return {SupportedFeatures} Image formats, qualities and region / size calculation\n   * methods that are supported by the IIIF service.\n   */\n\n\n  IIIFInfo.prototype.getComplianceLevelSupportedFeatures = function () {\n    if (this.imageInfo === undefined) {\n      return;\n    }\n\n    var version = this.getImageApiVersion();\n    var level = this.getComplianceLevelFromProfile(version);\n\n    if (level === undefined) {\n      return IIIF_PROFILE_VALUES['none']['none'];\n    }\n\n    return IIIF_PROFILE_VALUES[version][level];\n  };\n  /**\n   * @param {PreferredOptions} [opt_preferredOptions] Optional options for preferred format and quality.\n   * @return {import(\"../source/IIIF.js\").Options} IIIF tile source ready constructor options.\n   * @api\n   */\n\n\n  IIIFInfo.prototype.getTileSourceOptions = function (opt_preferredOptions) {\n    var options = opt_preferredOptions || {},\n        version = this.getImageApiVersion();\n\n    if (version === undefined) {\n      return;\n    }\n\n    var imageOptions = version === undefined ? undefined : versionFunctions[version](this);\n\n    if (imageOptions === undefined) {\n      return;\n    }\n\n    return {\n      url: imageOptions.url,\n      version: version,\n      size: [this.imageInfo.width, this.imageInfo.height],\n      sizes: imageOptions.sizes,\n      format: options.format !== undefined && includes(imageOptions.formats, options.format) ? options.format : imageOptions.preferredFormat !== undefined ? imageOptions.preferredFormat : 'jpg',\n      supports: imageOptions.supports,\n      quality: options.quality && includes(imageOptions.qualities, options.quality) ? options.quality : includes(imageOptions.qualities, 'native') ? 'native' : 'default',\n      resolutions: Array.isArray(imageOptions.resolutions) ? imageOptions.resolutions.sort(function (a, b) {\n        return b - a;\n      }) : undefined,\n      tileSize: imageOptions.tileSize\n    };\n  };\n\n  return IIIFInfo;\n}();\n\nexport default IIIFInfo;","map":{"version":3,"mappings":"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","names":["assert","includes","Versions","VERSION1","VERSION2","VERSION3","IIIF_PROFILE_VALUES","supports","formats","qualities","COMPLIANCE_VERSION1","COMPLIANCE_VERSION2","COMPLIANCE_VERSION3","generateVersion1Options","iiifInfo","levelProfile","getComplianceLevelSupportedFeatures","undefined","url","imageInfo","replace","resolutions","scale_factors","tileSize","tile_width","tile_height","generateVersion2Options","additionalProfile","Array","isArray","profile","length","profileSupports","profileFormats","profileQualities","sizes","map","size","width","height","tiles","tile","scaleFactors","generateVersion3Options","extraFormats","__spreadArray","preferredFormat","preferredFormats","filter","format","reduce","acc","extraFeatures","extraQualities","versionFunctions","setImageInfo","IIIFInfo","JSON","parse","context","i","getComplianceLevelEntryFromProfile","identifier","version","getImageApiVersion","test","complianceLevel","level","match","getComplianceLevelFromProfile","opt_preferredOptions","options","imageOptions","quality","sort","a","b"],"sourceRoot":"","sources":["../src/format/IIIFInfo.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}