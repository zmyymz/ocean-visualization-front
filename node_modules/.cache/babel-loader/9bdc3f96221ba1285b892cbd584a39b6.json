{"ast":null,"code":"import _typeof from \"D:/Java/JavaEE/IdeaProjects/ocean-vis/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.match.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.string.trim.js\";\n\n/*\nol-mapbox-style - Use Mapbox Style objects with OpenLayers\nCopyright 2016-present ol-mapbox-style contributors\nLicense: https://raw.githubusercontent.com/openlayers/ol-mapbox-style/master/LICENSE\n*/\nimport Circle from 'ol/style/Circle.js';\nimport Fill from 'ol/style/Fill.js';\nimport Icon from 'ol/style/Icon.js';\nimport RenderFeature from 'ol/render/Feature.js';\nimport Stroke from 'ol/style/Stroke.js';\nimport Style from 'ol/style/Style.js';\nimport Text from 'ol/style/Text.js';\nimport mb2css from 'mapbox-to-css-font';\nimport { Color, featureFilter as createFilter, derefLayers, expression, function as fn, latest as spec } from '@mapbox/mapbox-gl-style-spec';\nimport { applyLetterSpacing, createCanvas, defaultResolutions, deg2rad, getZoomForResolution, wrapText } from './util.js';\n/**\n * @typedef {import(\"ol/layer/Vector\").default} VectorLayer\n * @typedef {import(\"ol/layer/VectorTile\").default} VectorTileLayer\n * @typedef {import(\"ol/style/Style\").StyleFunction} StyleFunction\n */\n\nvar isFunction = fn.isFunction;\nvar convertFunction = fn.convertFunction;\nvar isExpression = expression.isExpression;\nvar createPropertyExpression = expression.createPropertyExpression;\nvar types = {\n  'Point': 1,\n  'MultiPoint': 1,\n  'LineString': 2,\n  'MultiLineString': 2,\n  'Polygon': 3,\n  'MultiPolygon': 3\n};\nvar anchor = {\n  'center': [0.5, 0.5],\n  'left': [0, 0.5],\n  'right': [1, 0.5],\n  'top': [0.5, 0],\n  'bottom': [0.5, 1],\n  'top-left': [0, 0],\n  'top-right': [1, 0],\n  'bottom-left': [0, 1],\n  'bottom-right': [1, 1]\n};\n\nvar expressionData = function expressionData(rawExpression, propertySpec) {\n  var compiledExpression = createPropertyExpression(rawExpression, propertySpec);\n\n  if (compiledExpression.result === 'error') {\n    throw new Error(compiledExpression.value.map(function (err) {\n      return \"\".concat(err.key, \": \").concat(err.message);\n    }).join(', '));\n  }\n\n  return compiledExpression.value;\n};\n\nvar emptyObj = {};\nvar zoomObj = {\n  zoom: 0\n};\nvar renderFeatureCoordinates, renderFeature;\n/**\n * @private\n * @param {Object} layer Gl object layer.\n * @param {string} layoutOrPaint 'layout' or 'paint'.\n * @param {string} property Feature property.\n * @param {number} zoom Zoom.\n * @param {Object} feature Gl feature.\n * @param {Object} [functionCache] Function cache.\n * @return {?} Value.\n */\n\nexport function getValue(layer, layoutOrPaint, property, zoom, feature, functionCache) {\n  var layerId = layer.id;\n\n  if (!functionCache) {\n    functionCache = {};\n    console.warn('No functionCache provided to getValue()'); //eslint-disable-line no-console\n  }\n\n  if (!functionCache[layerId]) {\n    functionCache[layerId] = {};\n  }\n\n  var functions = functionCache[layerId];\n\n  if (!functions[property]) {\n    var value_1 = (layer[layoutOrPaint] || emptyObj)[property];\n    var propertySpec = spec[\"\".concat(layoutOrPaint, \"_\").concat(layer.type)][property];\n\n    if (value_1 === undefined) {\n      value_1 = propertySpec.default;\n    }\n\n    var isExpr = isExpression(value_1);\n\n    if (!isExpr && isFunction(value_1)) {\n      value_1 = convertFunction(value_1, propertySpec);\n      isExpr = true;\n    }\n\n    if (isExpr) {\n      var compiledExpression = expressionData(value_1, propertySpec);\n      functions[property] = compiledExpression.evaluate.bind(compiledExpression);\n    } else {\n      if (propertySpec.type == 'color') {\n        value_1 = Color.parse(value_1);\n      }\n\n      functions[property] = function () {\n        return value_1;\n      };\n    }\n  }\n\n  zoomObj.zoom = zoom;\n  return functions[property](zoomObj, feature);\n}\n/**\n * @private\n * @param {string} layerId Layer id.\n * @param {?} filter Filter.\n * @param {Object} feature Feature.\n * @param {number} zoom Zoom.\n * @param {Object} [filterCache] Filter cache.\n * @return {boolean} Filter result.\n */\n\nfunction evaluateFilter(layerId, filter, feature, zoom, filterCache) {\n  if (!filterCache) {\n    console.warn('No filterCache provided to evaluateFilter()'); //eslint-disable-line no-console\n  }\n\n  if (!(layerId in filterCache)) {\n    filterCache[layerId] = createFilter(filter).filter;\n  }\n\n  zoomObj.zoom = zoom;\n  return filterCache[layerId](zoomObj, feature);\n}\n\nvar renderTransparentEnabled = false;\n/**\n * ```js\n * import {renderTransparent} from 'ol-mapbox-style/dist/stylefunction';\n * ```\n * Configure whether features with a transparent style should be rendered. When\n * set to `true`, it will be possible to hit detect content that is not visible,\n * like transparent fills of polygons, using `ol/layer/Layer#getFeatures()` or\n * `ol/Map#getFeaturesAtPixel()`\n * @param {boolean} enabled Rendering of transparent elements is enabled.\n * Default is `false`.\n */\n\nexport function renderTransparent(enabled) {\n  renderTransparentEnabled = enabled;\n}\n/**\n * @private\n * @param {?} color Color.\n * @param {number} opacity Opacity.\n * @return {string} Color.\n */\n\nfunction colorWithOpacity(color, opacity) {\n  if (color) {\n    if (!renderTransparentEnabled && (color.a === 0 || opacity === 0)) {\n      return undefined;\n    }\n\n    var a = color.a;\n    opacity = opacity === undefined ? 1 : opacity;\n    return a === 0 ? 'transparent' : 'rgba(' + Math.round(color.r * 255 / a) + ',' + Math.round(color.g * 255 / a) + ',' + Math.round(color.b * 255 / a) + ',' + a * opacity + ')';\n  }\n\n  return color;\n}\n\nvar templateRegEx = /^([^]*)\\{(.*)\\}([^]*)$/;\n/**\n * @private\n * @param {string} text Text.\n * @param {Object} properties Properties.\n * @return {string} Text.\n */\n\nfunction fromTemplate(text, properties) {\n  var parts;\n\n  do {\n    parts = text.match(templateRegEx);\n\n    if (parts) {\n      var value = properties[parts[2]] || '';\n      text = parts[1] + value + parts[3];\n    }\n  } while (parts);\n\n  return text;\n}\n\nvar recordLayer = false;\n/**\n * ```js\n * import {recordStyleLayer} from 'ol-mapbox-style/dist/stylefunction';\n * ```\n * Turns recording of the Mapbox Style's `layer` on and off. When turned on,\n * the layer that a rendered feature belongs to will be set as the feature's\n * `mapbox-layer` property.\n * @param {boolean} [record=false] Recording of the style layer is on.\n */\n\nexport function recordStyleLayer(record) {\n  recordLayer = record;\n}\n/**\n * ```js\n * import stylefunction from 'ol-mapbox-style/dist/stylefunction';\n * ```\n * Creates a style function from the `glStyle` object for all layers that use\n * the specified `source`, which needs to be a `\"type\": \"vector\"` or\n * `\"type\": \"geojson\"` source and applies it to the specified OpenLayers layer.\n *\n * Two additional properties will be set on the provided layer:\n *\n *  * `mapbox-source`: The `id` of the Mapbox Style document's source that the\n *    OpenLayers layer was created from. Usually `apply()` creates one\n *    OpenLayers layer per Mapbox Style source, unless the layer stack has\n *    layers from different sources in between.\n *  * `mapbox-layers`: The `id`s of the Mapbox Style document's layers that are\n *    included in the OpenLayers layer.\n *\n * This function also works in a web worker. In worker mode, the main thread needs\n * to listen to messages from the worker and respond with another message to make\n * sure that sprite image loading works:\n *\n * ```js\n *  worker.addEventListener('message', event => {\n *   if (event.data.action === 'loadImage') {\n *     const image = new Image();\n *     image.crossOrigin = 'anonymous';\n *     image.addEventListener('load', function() {\n *       createImageBitmap(image, 0, 0, image.width, image.height).then(imageBitmap => {\n *         worker.postMessage({\n *           action: 'imageLoaded',\n *           image: imageBitmap,\n *           src: event.data.src\n *         }, [imageBitmap]);\n *       });\n *     });\n *     image.src = event.data.src;\n *   }\n * });\n * ```\n *\n * @param {VectorLayer|VectorTileLayer} olLayer OpenLayers layer to\n * apply the style to. In addition to the style, the layer will get two\n * properties: `mapbox-source` will be the `id` of the `glStyle`'s source used\n * for the layer, and `mapbox-layers` will be an array of the `id`s of the\n * `glStyle`'s layers.\n * @param {string|Object} glStyle Mapbox Style object.\n * @param {string|Array<string>} source `source` key or an array of layer `id`s\n * from the Mapbox Style object. When a `source` key is provided, all layers for\n * the specified source will be included in the style function. When layer `id`s\n * are provided, they must be from layers that use the same source.\n * @param {Array<number>} [resolutions=[78271.51696402048, 39135.75848201024, 19567.87924100512, 9783.93962050256, 4891.96981025128, 2445.98490512564, 1222.99245256282, 611.49622628141, 305.748113140705, 152.8740565703525, 76.43702828517625, 38.21851414258813, 19.109257071294063, 9.554628535647032, 4.777314267823516, 2.388657133911758, 1.194328566955879, 0.5971642834779395, 0.29858214173896974, 0.14929107086948487, 0.07464553543474244]]\n * Resolutions for mapping resolution to zoom level.\n * @param {Object} [spriteData=undefined] Sprite data from the url specified in\n * the Mapbox Style object's `sprite` property. Only required if a `sprite`\n * property is specified in the Mapbox Style object.\n * @param {string} [spriteImageUrl=undefined] Sprite image url for the sprite\n * specified in the Mapbox Style object's `sprite` property. Only required if a\n * `sprite` property is specified in the Mapbox Style object.\n * @param {function(Array<string>):Array<string>} [getFonts=undefined] Function that\n * receives a font stack as arguments, and returns a (modified) font stack that\n * is available. Font names are the names used in the Mapbox Style object. If\n * not provided, the font stack will be used as-is. This function can also be\n * used for loading web fonts.\n * @return {StyleFunction} Style function for use in\n * `ol.layer.Vector` or `ol.layer.VectorTile`.\n */\n\nexport default function (olLayer, glStyle, source, resolutions, spriteData, spriteImageUrl, getFonts) {\n  if (resolutions === void 0) {\n    resolutions = defaultResolutions;\n  }\n\n  if (typeof glStyle == 'string') {\n    glStyle = JSON.parse(glStyle);\n  }\n\n  if (glStyle.version != 8) {\n    throw new Error('glStyle version 8 required.');\n  }\n\n  var spriteImage, spriteImgSize;\n\n  if (spriteImageUrl) {\n    if (typeof Image !== 'undefined') {\n      var img_1 = new Image();\n      img_1.crossOrigin = 'anonymous';\n\n      img_1.onload = function () {\n        spriteImage = img_1;\n        spriteImgSize = [img_1.width, img_1.height];\n        olLayer.changed();\n        img_1.onload = null;\n      };\n\n      img_1.src = spriteImageUrl;\n    } else if (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope) {\n      //eslint-disable-line\n      var worker =\n      /** @type {*} */\n      self; // Main thread needs to handle 'loadImage' and dispatch 'imageLoaded'\n\n      worker.postMessage({\n        action: 'loadImage',\n        src: spriteImageUrl\n      });\n      worker.addEventListener('message', function handler(event) {\n        if (event.data.action === 'imageLoaded' && event.data.src === spriteImageUrl) {\n          spriteImage = event.data.image;\n          spriteImgSize = [spriteImage.width, spriteImage.height];\n        }\n      });\n    }\n  }\n\n  var allLayers = derefLayers(glStyle.layers);\n  var layersBySourceLayer = {};\n  var mapboxLayers = [];\n  var iconImageCache = {};\n  var patternCache = {};\n  var functionCache = {};\n  var filterCache = {};\n  var mapboxSource;\n\n  for (var i = 0, ii = allLayers.length; i < ii; ++i) {\n    var layer = allLayers[i];\n    var layerId = layer.id;\n\n    if (typeof source == 'string' && layer.source == source || source.indexOf(layerId) !== -1) {\n      var sourceLayer = layer['source-layer'];\n\n      if (!mapboxSource) {\n        mapboxSource = layer.source;\n        var source_1 = glStyle.sources[mapboxSource];\n\n        if (!source_1) {\n          throw new Error(\"Source \\\"\".concat(mapboxSource, \"\\\" is not defined\"));\n        }\n\n        var type = source_1.type;\n\n        if (type !== 'vector' && type !== 'geojson') {\n          throw new Error(\"Source \\\"\".concat(mapboxSource, \"\\\" is not of type \\\"vector\\\" or \\\"geojson\\\", but \\\"\").concat(type, \"\\\"\"));\n        }\n      }\n\n      var layers = layersBySourceLayer[sourceLayer];\n\n      if (!layers) {\n        layers = [];\n        layersBySourceLayer[sourceLayer] = layers;\n      }\n\n      layers.push({\n        layer: layer,\n        index: i\n      });\n      mapboxLayers.push(layerId);\n    }\n  }\n\n  var textHalo = new Stroke();\n  var textColor = new Fill();\n  var styles = [];\n\n  var styleFunction = function styleFunction(feature, resolution) {\n    var properties = feature.getProperties();\n    var layers = layersBySourceLayer[properties.layer];\n\n    if (!layers) {\n      return;\n    }\n\n    var zoom = resolutions.indexOf(resolution);\n\n    if (zoom == -1) {\n      zoom = getZoomForResolution(resolution, resolutions);\n    }\n\n    var type = types[feature.getGeometry().getType()];\n    var f = {\n      properties: properties,\n      type: type\n    };\n    var stylesLength = -1;\n    var featureBelongsToLayer;\n\n    var _loop_1 = function _loop_1(i, ii) {\n      var layerData = layers[i];\n      var layer = layerData.layer;\n      var layerId = layer.id;\n      var layout = layer.layout || emptyObj;\n      var paint = layer.paint || emptyObj;\n\n      if (layout.visibility === 'none' || 'minzoom' in layer && zoom < layer.minzoom || 'maxzoom' in layer && zoom >= layer.maxzoom) {\n        return \"continue\";\n      }\n\n      var filter = layer.filter;\n\n      if (!filter || evaluateFilter(layerId, filter, f, zoom, filterCache)) {\n        featureBelongsToLayer = layer;\n        var color = void 0,\n            opacity = void 0,\n            fill = void 0,\n            stroke = void 0,\n            strokeColor = void 0,\n            style = void 0;\n        var index = layerData.index;\n\n        if (type == 3 && (layer.type == 'fill' || layer.type == 'fill-extrusion')) {\n          opacity = getValue(layer, 'paint', layer.type + '-opacity', zoom, f, functionCache);\n\n          if (layer.type + '-pattern' in paint) {\n            var fillIcon = getValue(layer, 'paint', layer.type + '-pattern', zoom, f, functionCache);\n\n            if (fillIcon) {\n              var icon_1 = typeof fillIcon === 'string' ? fromTemplate(fillIcon, properties) : fillIcon.toString();\n\n              if (spriteImage && spriteData && spriteData[icon_1]) {\n                ++stylesLength;\n                style = styles[stylesLength];\n\n                if (!style || !style.getFill() || style.getStroke() || style.getText()) {\n                  style = new Style({\n                    fill: new Fill()\n                  });\n                  styles[stylesLength] = style;\n                }\n\n                fill = style.getFill();\n                style.setZIndex(index);\n                var icon_cache_key = icon_1 + '.' + opacity;\n                var pattern = patternCache[icon_cache_key];\n\n                if (!pattern) {\n                  var spriteImageData = spriteData[icon_1];\n                  var canvas = createCanvas(spriteImageData.width, spriteImageData.height);\n                  var ctx =\n                  /** @type {CanvasRenderingContext2D} */\n                  canvas.getContext('2d');\n                  ctx.globalAlpha = opacity;\n                  ctx.drawImage(spriteImage, spriteImageData.x, spriteImageData.y, spriteImageData.width, spriteImageData.height, 0, 0, spriteImageData.width, spriteImageData.height);\n                  pattern = ctx.createPattern(canvas, 'repeat');\n                  patternCache[icon_cache_key] = pattern;\n                }\n\n                fill.setColor(pattern);\n              }\n            }\n          } else {\n            color = colorWithOpacity(getValue(layer, 'paint', layer.type + '-color', zoom, f, functionCache), opacity);\n\n            if (layer.type + '-outline-color' in paint) {\n              strokeColor = colorWithOpacity(getValue(layer, 'paint', layer.type + '-outline-color', zoom, f, functionCache), opacity);\n            }\n\n            if (!strokeColor) {\n              strokeColor = color;\n            }\n\n            if (color || strokeColor) {\n              ++stylesLength;\n              style = styles[stylesLength];\n\n              if (!style || color && !style.getFill() || !color && style.getFill() || strokeColor && !style.getStroke() || !strokeColor && style.getStroke() || style.getText()) {\n                style = new Style({\n                  fill: color ? new Fill() : undefined,\n                  stroke: strokeColor ? new Stroke() : undefined\n                });\n                styles[stylesLength] = style;\n              }\n\n              if (color) {\n                fill = style.getFill();\n                fill.setColor(color);\n              }\n\n              if (strokeColor) {\n                stroke = style.getStroke();\n                stroke.setColor(strokeColor);\n                stroke.setWidth(0.5);\n              }\n\n              style.setZIndex(index);\n            }\n          }\n        }\n\n        if (type != 1 && layer.type == 'line') {\n          color = !('line-pattern' in paint) && 'line-color' in paint ? colorWithOpacity(getValue(layer, 'paint', 'line-color', zoom, f, functionCache), getValue(layer, 'paint', 'line-opacity', zoom, f, functionCache)) : undefined;\n          var width_1 = getValue(layer, 'paint', 'line-width', zoom, f, functionCache);\n\n          if (color && width_1 > 0) {\n            ++stylesLength;\n            style = styles[stylesLength];\n\n            if (!style || !style.getStroke() || style.getFill() || style.getText()) {\n              style = new Style({\n                stroke: new Stroke()\n              });\n              styles[stylesLength] = style;\n            }\n\n            stroke = style.getStroke();\n            stroke.setLineCap(getValue(layer, 'layout', 'line-cap', zoom, f, functionCache));\n            stroke.setLineJoin(getValue(layer, 'layout', 'line-join', zoom, f, functionCache));\n            stroke.setMiterLimit(getValue(layer, 'layout', 'line-miter-limit', zoom, f, functionCache));\n            stroke.setColor(color);\n            stroke.setWidth(width_1);\n            stroke.setLineDash(paint['line-dasharray'] ? getValue(layer, 'paint', 'line-dasharray', zoom, f, functionCache).map(function (x) {\n              return x * width_1;\n            }) : null);\n            style.setZIndex(index);\n          }\n        }\n\n        var hasImage = false;\n        var text = null;\n        var placementAngle = 0;\n        var icon = void 0,\n            iconImg = void 0,\n            skipLabel = void 0;\n\n        if ((type == 1 || type == 2) && 'icon-image' in layout) {\n          var iconImage = getValue(layer, 'layout', 'icon-image', zoom, f, functionCache);\n\n          if (iconImage) {\n            icon = typeof iconImage === 'string' ? fromTemplate(iconImage, properties) : iconImage.toString();\n            var styleGeom = undefined;\n\n            if (spriteImage && spriteData && spriteData[icon]) {\n              var iconRotationAlignment = getValue(layer, 'layout', 'icon-rotation-alignment', zoom, f, functionCache);\n\n              if (type == 2) {\n                var geom = feature.getGeometry(); // ol package and ol-debug.js only\n\n                if (geom.getFlatMidpoint || geom.getFlatMidpoints) {\n                  var extent = geom.getExtent();\n                  var size = Math.sqrt(Math.max(Math.pow((extent[2] - extent[0]) / resolution, 2), Math.pow((extent[3] - extent[1]) / resolution, 2)));\n\n                  if (size > 150) {\n                    //FIXME Do not hard-code a size of 150\n                    var midpoint = geom.getType() === 'MultiLineString' ? geom.getFlatMidpoints() : geom.getFlatMidpoint();\n\n                    if (!renderFeature) {\n                      renderFeatureCoordinates = [NaN, NaN];\n                      renderFeature = new RenderFeature('Point', renderFeatureCoordinates, [], {}, null);\n                    }\n\n                    styleGeom = renderFeature;\n                    renderFeatureCoordinates[0] = midpoint[0];\n                    renderFeatureCoordinates[1] = midpoint[1];\n                    var placement = getValue(layer, 'layout', 'symbol-placement', zoom, f, functionCache);\n\n                    if (placement === 'line' && iconRotationAlignment === 'map') {\n                      var stride = geom.getStride();\n                      var coordinates = geom.getFlatCoordinates();\n\n                      for (var i_1 = 0, ii_1 = coordinates.length - stride; i_1 < ii_1; i_1 += stride) {\n                        var x1 = coordinates[i_1];\n                        var y1 = coordinates[i_1 + 1];\n                        var x2 = coordinates[i_1 + stride];\n                        var y2 = coordinates[i_1 + stride + 1];\n                        var minX = Math.min(x1, x2);\n                        var minY = Math.min(y1, y2);\n                        var maxX = Math.max(x1, x2);\n                        var maxY = Math.max(y1, y2);\n\n                        if (midpoint[0] >= minX && midpoint[0] <= maxX && midpoint[1] >= minY && midpoint[1] <= maxY) {\n                          placementAngle = Math.atan2(y1 - y2, x2 - x1);\n                          break;\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n\n              if (type !== 2 || styleGeom) {\n                var iconSize = getValue(layer, 'layout', 'icon-size', zoom, f, functionCache);\n                var iconColor = paint['icon-color'] !== undefined ? getValue(layer, 'paint', 'icon-color', zoom, f, functionCache) : null;\n\n                if (!iconColor || iconColor.a !== 0) {\n                  var icon_cache_key = icon + '.' + iconSize;\n\n                  if (iconColor !== null) {\n                    icon_cache_key += '.' + iconColor;\n                  }\n\n                  iconImg = iconImageCache[icon_cache_key];\n\n                  if (!iconImg) {\n                    var spriteImageData_1 = spriteData[icon];\n                    iconImg = new Icon({\n                      color: iconColor ? [iconColor.r * 255, iconColor.g * 255, iconColor.b * 255, iconColor.a] : undefined,\n                      img: spriteImage,\n                      imgSize: spriteImgSize,\n                      size: [spriteImageData_1.width, spriteImageData_1.height],\n                      offset: [spriteImageData_1.x, spriteImageData_1.y],\n                      rotateWithView: iconRotationAlignment === 'map',\n                      scale: iconSize / spriteImageData_1.pixelRatio,\n                      displacement: 'icon-offset' in layout ? getValue(layer, 'layout', 'icon-offset', zoom, f, functionCache).map(function (v) {\n                        return -v * spriteImageData_1.pixelRatio;\n                      }) : undefined\n                    });\n                    iconImageCache[icon_cache_key] = iconImg;\n                  }\n                }\n\n                if (iconImg) {\n                  ++stylesLength;\n                  style = styles[stylesLength];\n\n                  if (!style || !style.getImage() || style.getFill() || style.getStroke()) {\n                    style = new Style();\n                    styles[stylesLength] = style;\n                  }\n\n                  style.setGeometry(styleGeom);\n                  iconImg.setRotation(placementAngle + deg2rad(getValue(layer, 'layout', 'icon-rotate', zoom, f, functionCache)));\n                  iconImg.setOpacity(getValue(layer, 'paint', 'icon-opacity', zoom, f, functionCache));\n                  iconImg.setAnchor(anchor[getValue(layer, 'layout', 'icon-anchor', zoom, f, functionCache)]);\n                  style.setImage(iconImg);\n                  text = style.getText();\n                  style.setText(undefined);\n                  style.setZIndex(index);\n                  hasImage = true;\n                  skipLabel = false;\n                }\n              } else {\n                skipLabel = true;\n              }\n            }\n          }\n        }\n\n        if (type == 1 && layer.type === 'circle') {\n          ++stylesLength;\n          style = styles[stylesLength];\n\n          if (!style || !style.getImage() || style.getFill() || style.getStroke()) {\n            style = new Style();\n            styles[stylesLength] = style;\n          }\n\n          var circleRadius = 'circle-radius' in paint ? getValue(layer, 'paint', 'circle-radius', zoom, f, functionCache) : 5;\n          var circleStrokeColor = colorWithOpacity(getValue(layer, 'paint', 'circle-stroke-color', zoom, f, functionCache), getValue(layer, 'paint', 'circle-stroke-opacity', zoom, f, functionCache));\n          var circleColor = colorWithOpacity(getValue(layer, 'paint', 'circle-color', zoom, f, functionCache), getValue(layer, 'paint', 'circle-opacity', zoom, f, functionCache));\n          var circleStrokeWidth = getValue(layer, 'paint', 'circle-stroke-width', zoom, f, functionCache);\n          var cache_key = circleRadius + '.' + circleStrokeColor + '.' + circleColor + '.' + circleStrokeWidth;\n          iconImg = iconImageCache[cache_key];\n\n          if (!iconImg) {\n            iconImg = new Circle({\n              radius: circleRadius,\n              stroke: circleStrokeColor && circleStrokeWidth > 0 ? new Stroke({\n                width: circleStrokeWidth,\n                color: circleStrokeColor\n              }) : undefined,\n              fill: circleColor ? new Fill({\n                color: circleColor\n              }) : undefined\n            });\n            iconImageCache[cache_key] = iconImg;\n          }\n\n          style.setImage(iconImg);\n          text = style.getText();\n          style.setText(undefined);\n          style.setGeometry(undefined);\n          style.setZIndex(index);\n          hasImage = true;\n        }\n\n        var label = void 0,\n            font = void 0,\n            textLineHeight_1,\n            textSize_1,\n            letterSpacing_1,\n            maxTextWidth_1;\n\n        if ('text-field' in layout) {\n          textSize_1 = Math.round(getValue(layer, 'layout', 'text-size', zoom, f, functionCache));\n          var fontArray_1 = getValue(layer, 'layout', 'text-font', zoom, f, functionCache);\n          textLineHeight_1 = getValue(layer, 'layout', 'text-line-height', zoom, f, functionCache);\n          font = mb2css(getFonts ? getFonts(fontArray_1) : fontArray_1, textSize_1, textLineHeight_1);\n          letterSpacing_1 = getValue(layer, 'layout', 'text-letter-spacing', zoom, f, functionCache);\n          maxTextWidth_1 = getValue(layer, 'layout', 'text-max-width', zoom, f, functionCache);\n          var textField = getValue(layer, 'layout', 'text-field', zoom, f, functionCache);\n\n          if (_typeof(textField) === 'object' && textField.sections) {\n            if (textField.sections.length === 1) {\n              label = textField.toString();\n            } else {\n              label = textField.sections.reduce(function (acc, chunk, i) {\n                var fonts = chunk.fontStack ? chunk.fontStack.split(',') : fontArray_1;\n                var chunkFont = mb2css(getFonts ? getFonts(fonts) : fonts, textSize_1 * (chunk.scale || 1), textLineHeight_1);\n                var text = chunk.text;\n\n                if (text === '\\n') {\n                  acc.push('\\n', '');\n                  return acc;\n                }\n\n                if (type == 2) {\n                  acc.push(applyLetterSpacing(text, letterSpacing_1), chunkFont);\n                  return;\n                }\n\n                text = wrapText(text, chunkFont, maxTextWidth_1, letterSpacing_1).split('\\n');\n\n                for (var i_2 = 0, ii_2 = text.length; i_2 < ii_2; ++i_2) {\n                  if (i_2 > 0) {\n                    acc.push('\\n', '');\n                  }\n\n                  acc.push(text[i_2], chunkFont);\n                }\n\n                return acc;\n              }, []);\n            }\n          } else {\n            label = fromTemplate(textField, properties).trim();\n          }\n\n          opacity = getValue(layer, 'paint', 'text-opacity', zoom, f, functionCache);\n        }\n\n        if (label && opacity && !skipLabel) {\n          if (!hasImage) {\n            ++stylesLength;\n            style = styles[stylesLength];\n\n            if (!style || !style.getText() || style.getFill() || style.getStroke()) {\n              style = new Style();\n              styles[stylesLength] = style;\n            }\n\n            style.setImage(undefined);\n            style.setGeometry(undefined);\n          }\n\n          if (!style.getText()) {\n            style.setText(text || new Text({\n              padding: [2, 2, 2, 2]\n            }));\n          }\n\n          text = style.getText();\n          var textTransform = layout['text-transform'];\n\n          if (textTransform == 'uppercase') {\n            label = Array.isArray(label) ? label.map(function (t, i) {\n              return i % 2 ? t : t.toUpperCase();\n            }) : label.toUpperCase();\n          } else if (textTransform == 'lowercase') {\n            label = Array.isArray(label) ? label.map(function (t, i) {\n              return i % 2 ? t : t.toLowerCase();\n            }) : label.toLowerCase();\n          }\n\n          var wrappedLabel = Array.isArray(label) ? label : type == 2 ? applyLetterSpacing(label, letterSpacing_1) : wrapText(label, font, maxTextWidth_1, letterSpacing_1);\n          text.setText(wrappedLabel);\n          text.setFont(font);\n          text.setRotation(deg2rad(getValue(layer, 'layout', 'text-rotate', zoom, f, functionCache)));\n          var textAnchor = getValue(layer, 'layout', 'text-anchor', zoom, f, functionCache);\n          var placement = hasImage || type == 1 ? 'point' : getValue(layer, 'layout', 'symbol-placement', zoom, f, functionCache);\n          text.setPlacement(placement);\n          var textHaloWidth = getValue(layer, 'paint', 'text-halo-width', zoom, f, functionCache);\n          var textOffset = getValue(layer, 'layout', 'text-offset', zoom, f, functionCache);\n          var textTranslate = getValue(layer, 'paint', 'text-translate', zoom, f, functionCache); // Text offset has to take halo width and line height into account\n\n          var vOffset = 0;\n          var hOffset = 0;\n\n          if (placement == 'point') {\n            var textAlign = 'center';\n\n            if (textAnchor.indexOf('left') !== -1) {\n              textAlign = 'left';\n              hOffset = textHaloWidth;\n            } else if (textAnchor.indexOf('right') !== -1) {\n              textAlign = 'right';\n              hOffset = -textHaloWidth;\n            }\n\n            text.setTextAlign(textAlign);\n            var textRotationAlignment = getValue(layer, 'layout', 'text-rotation-alignment', zoom, f, functionCache);\n            text.setRotateWithView(textRotationAlignment == 'map');\n          } else {\n            text.setMaxAngle(deg2rad(getValue(layer, 'layout', 'text-max-angle', zoom, f, functionCache)) * label.length / wrappedLabel.length);\n            text.setTextAlign();\n            text.setRotateWithView(false);\n          }\n\n          var textBaseline = 'middle';\n\n          if (textAnchor.indexOf('bottom') == 0) {\n            textBaseline = 'bottom';\n            vOffset = -textHaloWidth - 0.5 * (textLineHeight_1 - 1) * textSize_1;\n          } else if (textAnchor.indexOf('top') == 0) {\n            textBaseline = 'top';\n            vOffset = textHaloWidth + 0.5 * (textLineHeight_1 - 1) * textSize_1;\n          }\n\n          text.setTextBaseline(textBaseline);\n          text.setOffsetX(textOffset[0] * textSize_1 + hOffset + textTranslate[0]);\n          text.setOffsetY(textOffset[1] * textSize_1 + vOffset + textTranslate[1]);\n          textColor.setColor(colorWithOpacity(getValue(layer, 'paint', 'text-color', zoom, f, functionCache), opacity));\n          text.setFill(textColor);\n          var haloColor = colorWithOpacity(getValue(layer, 'paint', 'text-halo-color', zoom, f, functionCache), opacity);\n\n          if (haloColor) {\n            textHalo.setColor(haloColor); // spec here : https://docs.mapbox.com/mapbox-gl-js/style-spec/#paint-symbol-text-halo-width\n            // Halo width must be doubled because it is applied around the center of the text outline\n\n            textHaloWidth *= 2; // 1/4 of text size (spec) x 2\n\n            var halfTextSize = 0.5 * textSize_1;\n            textHalo.setWidth(textHaloWidth <= halfTextSize ? textHaloWidth : halfTextSize);\n            text.setStroke(textHalo);\n          } else {\n            text.setStroke(undefined);\n          }\n\n          var textPadding = getValue(layer, 'layout', 'text-padding', zoom, f, functionCache);\n          var padding = text.getPadding();\n\n          if (textPadding !== padding[0]) {\n            padding[0] = textPadding;\n            padding[1] = textPadding;\n            padding[2] = textPadding;\n            padding[3] = textPadding;\n          }\n\n          style.setZIndex(index);\n        }\n      }\n    };\n\n    for (var i = 0, ii = layers.length; i < ii; ++i) {\n      _loop_1(i, ii);\n    }\n\n    if (stylesLength > -1) {\n      styles.length = stylesLength + 1;\n\n      if (recordLayer) {\n        if (typeof feature.set === 'function') {\n          // ol/Feature\n          feature.set('mapbox-layer', featureBelongsToLayer);\n        } else {\n          // ol/render/Feature\n          feature.getProperties()['mapbox-layer'] = featureBelongsToLayer;\n        }\n      }\n\n      return styles;\n    }\n  };\n\n  olLayer.setStyle(styleFunction);\n  olLayer.set('mapbox-source', mapboxSource);\n  olLayer.set('mapbox-layers', mapboxLayers);\n  return styleFunction;\n}\nexport { colorWithOpacity as _colorWithOpacity, evaluateFilter as _evaluateFilter, fromTemplate as _fromTemplate, getValue as _getValue };","map":{"version":3,"mappings":"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","names":["Circle","Fill","Icon","RenderFeature","Stroke","Style","Text","mb2css","Color","featureFilter","createFilter","derefLayers","expression","function","fn","latest","spec","applyLetterSpacing","createCanvas","defaultResolutions","deg2rad","getZoomForResolution","wrapText","isFunction","convertFunction","isExpression","createPropertyExpression","types","anchor","expressionData","rawExpression","propertySpec","compiledExpression","result","Error","value","map","err","key","concat","message","join","emptyObj","zoomObj","zoom","renderFeatureCoordinates","renderFeature","getValue","layer","layoutOrPaint","property","feature","functionCache","layerId","id","console","warn","functions","value_1","type","undefined","default","isExpr","evaluate","bind","parse","evaluateFilter","filter","filterCache","renderTransparentEnabled","renderTransparent","enabled","colorWithOpacity","color","opacity","a","Math","round","r","g","b","templateRegEx","fromTemplate","text","properties","parts","match","recordLayer","recordStyleLayer","record","olLayer","glStyle","source","resolutions","spriteData","spriteImageUrl","getFonts","JSON","version","spriteImage","spriteImgSize","Image","img_1","crossOrigin","onload","width","height","changed","src","WorkerGlobalScope","self","worker","postMessage","action","addEventListener","handler","event","data","image","allLayers","layers","layersBySourceLayer","mapboxLayers","iconImageCache","patternCache","mapboxSource","i","ii","length","indexOf","sourceLayer","source_1","sources","push","index","textHalo","textColor","styles","styleFunction","resolution","getProperties","getGeometry","getType","f","stylesLength","featureBelongsToLayer","layerData","layout","paint","visibility","minzoom","maxzoom","fill","stroke","strokeColor","style","fillIcon","icon_1","toString","getFill","getStroke","getText","setZIndex","icon_cache_key","pattern","spriteImageData","canvas","ctx","getContext","globalAlpha","drawImage","x","y","createPattern","setColor","setWidth","width_1","setLineCap","setLineJoin","setMiterLimit","setLineDash","hasImage","placementAngle","icon","iconImg","skipLabel","iconImage","styleGeom","iconRotationAlignment","geom","getFlatMidpoint","getFlatMidpoints","extent","getExtent","size","sqrt","max","pow","midpoint","NaN","placement","stride","getStride","coordinates","getFlatCoordinates","i_1","ii_1","x1","y1","x2","y2","minX","min","minY","maxX","maxY","atan2","iconSize","iconColor","spriteImageData_1","img","imgSize","offset","rotateWithView","scale","pixelRatio","displacement","v","getImage","setGeometry","setRotation","setOpacity","setAnchor","setImage","setText","circleRadius","circleStrokeColor","circleColor","circleStrokeWidth","cache_key","radius","label","font","textLineHeight_1","textSize_1","letterSpacing_1","maxTextWidth_1","fontArray_1","textField","sections","reduce","acc","chunk","fonts","fontStack","split","chunkFont","i_2","ii_2","trim","padding","textTransform","Array","isArray","t","toUpperCase","toLowerCase","wrappedLabel","setFont","textAnchor","setPlacement","textHaloWidth","textOffset","textTranslate","vOffset","hOffset","textAlign","setTextAlign","textRotationAlignment","setRotateWithView","setMaxAngle","textBaseline","setTextBaseline","setOffsetX","setOffsetY","setFill","haloColor","halfTextSize","setStroke","textPadding","getPadding","set","setStyle","_colorWithOpacity","_evaluateFilter","_fromTemplate","_getValue"],"sourceRoot":"","sources":["../src/stylefunction.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}