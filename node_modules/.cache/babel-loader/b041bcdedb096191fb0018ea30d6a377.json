{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\n\n/**\n * @module ol/render/canvas/BuilderGroup\n */\nimport Builder from './Builder.js';\nimport ImageBuilder from './ImageBuilder.js';\nimport LineStringBuilder from './LineStringBuilder.js';\nimport PolygonBuilder from './PolygonBuilder.js';\nimport TextBuilder from './TextBuilder.js';\n/**\n * @type {Object<import(\"./BuilderType\").default, typeof Builder>}\n */\n\nvar BATCH_CONSTRUCTORS = {\n  'Circle': PolygonBuilder,\n  'Default': Builder,\n  'Image': ImageBuilder,\n  'LineString': LineStringBuilder,\n  'Polygon': PolygonBuilder,\n  'Text': TextBuilder\n};\n\nvar BuilderGroup =\n/** @class */\nfunction () {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Max extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n  function BuilderGroup(tolerance, maxExtent, resolution, pixelRatio) {\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tolerance_ = tolerance;\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n\n    this.maxExtent_ = maxExtent;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    this.pixelRatio_ = pixelRatio;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    this.resolution_ = resolution;\n    /**\n     * @private\n     * @type {!Object<string, !Object<import(\"./BuilderType\").default, Builder>>}\n     */\n\n    this.buildersByZIndex_ = {};\n  }\n  /**\n   * @return {!Object<string, !Object<import(\"./BuilderType\").default, import(\"./Builder.js\").SerializableInstructions>>} The serializable instructions\n   */\n\n\n  BuilderGroup.prototype.finish = function () {\n    var builderInstructions = {};\n\n    for (var zKey in this.buildersByZIndex_) {\n      builderInstructions[zKey] = builderInstructions[zKey] || {};\n      var builders = this.buildersByZIndex_[zKey];\n\n      for (var builderKey in builders) {\n        var builderInstruction = builders[builderKey].finish();\n        builderInstructions[zKey][builderKey] = builderInstruction;\n      }\n    }\n\n    return builderInstructions;\n  };\n  /**\n   * @param {number|undefined} zIndex Z index.\n   * @param {import(\"./BuilderType.js\").default} builderType Replay type.\n   * @return {import(\"../VectorContext.js\").default} Replay.\n   */\n\n\n  BuilderGroup.prototype.getBuilder = function (zIndex, builderType) {\n    var zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n    var replays = this.buildersByZIndex_[zIndexKey];\n\n    if (replays === undefined) {\n      replays = {};\n      this.buildersByZIndex_[zIndexKey] = replays;\n    }\n\n    var replay = replays[builderType];\n\n    if (replay === undefined) {\n      var Constructor = BATCH_CONSTRUCTORS[builderType];\n      replay = new Constructor(this.tolerance_, this.maxExtent_, this.resolution_, this.pixelRatio_);\n      replays[builderType] = replay;\n    }\n\n    return replay;\n  };\n\n  return BuilderGroup;\n}();\n\nexport default BuilderGroup;","map":{"version":3,"mappings":";;;AAAA;;;AAIA,OAAOA,OAAP,MAAoB,cAApB;AACA,OAAOC,YAAP,MAAyB,mBAAzB;AACA,OAAOC,iBAAP,MAA8B,wBAA9B;AACA,OAAOC,cAAP,MAA2B,qBAA3B;AACA,OAAOC,WAAP,MAAwB,kBAAxB;AAEA;;;;AAGA,IAAMC,kBAAkB,GAAG;AACzB,YAAUF,cADe;AAEzB,aAAWH,OAFc;AAGzB,WAASC,YAHgB;AAIzB,gBAAcC,iBAJW;AAKzB,aAAWC,cALc;AAMzB,UAAQC;AANiB,CAA3B;;AASA;AAAA;AAAA;AACE;;;;;;AAMA,wBAAYE,SAAZ,EAAuBC,SAAvB,EAAkCC,UAAlC,EAA8CC,UAA9C,EAAwD;AACtD;;;;AAIA,SAAKC,UAAL,GAAkBJ,SAAlB;AAEA;;;;;AAIA,SAAKK,UAAL,GAAkBJ,SAAlB;AAEA;;;;;AAIA,SAAKK,WAAL,GAAmBH,UAAnB;AAEA;;;;;AAIA,SAAKI,WAAL,GAAmBL,UAAnB;AAEA;;;;;AAIA,SAAKM,iBAAL,GAAyB,EAAzB;AACD;AAED;;;;;AAGAC;AACE,QAAMC,mBAAmB,GAAG,EAA5B;;AACA,SAAK,IAAMC,IAAX,IAAmB,KAAKH,iBAAxB,EAA2C;AACzCE,yBAAmB,CAACC,IAAD,CAAnB,GAA4BD,mBAAmB,CAACC,IAAD,CAAnB,IAA6B,EAAzD;AACA,UAAMC,QAAQ,GAAG,KAAKJ,iBAAL,CAAuBG,IAAvB,CAAjB;;AACA,WAAK,IAAME,UAAX,IAAyBD,QAAzB,EAAmC;AACjC,YAAME,kBAAkB,GAAGF,QAAQ,CAACC,UAAD,CAAR,CAAqBE,MAArB,EAA3B;AACAL,2BAAmB,CAACC,IAAD,CAAnB,CAA0BE,UAA1B,IAAwCC,kBAAxC;AACD;AACF;;AACD,WAAOJ,mBAAP;AACD,GAXD;AAaA;;;;;;;AAKAD,gDAAWO,MAAX,EAAmBC,WAAnB,EAA8B;AAC5B,QAAMC,SAAS,GAAGF,MAAM,KAAKG,SAAX,GAAuBH,MAAM,CAACI,QAAP,EAAvB,GAA2C,GAA7D;AACA,QAAIC,OAAO,GAAG,KAAKb,iBAAL,CAAuBU,SAAvB,CAAd;;AACA,QAAIG,OAAO,KAAKF,SAAhB,EAA2B;AACzBE,aAAO,GAAG,EAAV;AACA,WAAKb,iBAAL,CAAuBU,SAAvB,IAAoCG,OAApC;AACD;;AACD,QAAIC,MAAM,GAAGD,OAAO,CAACJ,WAAD,CAApB;;AACA,QAAIK,MAAM,KAAKH,SAAf,EAA0B;AACxB,UAAMI,WAAW,GAAGxB,kBAAkB,CAACkB,WAAD,CAAtC;AACAK,YAAM,GAAG,IAAIC,WAAJ,CACP,KAAKnB,UADE,EAEP,KAAKC,UAFE,EAGP,KAAKE,WAHE,EAIP,KAAKD,WAJE,CAAT;AAMAe,aAAO,CAACJ,WAAD,CAAP,GAAuBK,MAAvB;AACD;;AACD,WAAOA,MAAP;AACD,GAnBD;;AAoBF;AAAC,CAhFD;;AAkFA,eAAeb,YAAf","names":["Builder","ImageBuilder","LineStringBuilder","PolygonBuilder","TextBuilder","BATCH_CONSTRUCTORS","tolerance","maxExtent","resolution","pixelRatio","tolerance_","maxExtent_","pixelRatio_","resolution_","buildersByZIndex_","BuilderGroup","builderInstructions","zKey","builders","builderKey","builderInstruction","finish","zIndex","builderType","zIndexKey","undefined","toString","replays","replay","Constructor"],"sourceRoot":"","sources":["../../src/render/canvas/BuilderGroup.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}