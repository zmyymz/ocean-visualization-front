{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/renderer/webgl/TileLayer\n */\n\n\nimport LRUCache from '../../structs/LRUCache.js';\nimport State from '../../source/State.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport TileTexture from '../../webgl/TileTexture.js';\nimport WebGLArrayBuffer from '../../webgl/Buffer.js';\nimport WebGLLayerRenderer from './Layer.js';\nimport { AttributeType } from '../../webgl/Helper.js';\nimport { ELEMENT_ARRAY_BUFFER, STATIC_DRAW } from '../../webgl.js';\nimport { apply as applyTransform, compose as composeTransform, create as createTransform } from '../../transform.js';\nimport { containsCoordinate, getIntersection, isEmpty } from '../../extent.js';\nimport { create as createMat4, fromTransform as mat4FromTransform } from '../../vec/mat4.js';\nimport { createOrUpdate as createTileCoord, getKey as getTileCoordKey } from '../../tilecoord.js';\nimport { fromUserExtent } from '../../proj.js';\nimport { getUid } from '../../util.js';\nimport { numberSafeCompareFunction } from '../../array.js';\nimport { toSize } from '../../size.js';\nexport var Uniforms = {\n  TILE_TEXTURE_ARRAY: 'u_tileTextures',\n  TILE_TRANSFORM: 'u_tileTransform',\n  TRANSITION_ALPHA: 'u_transitionAlpha',\n  DEPTH: 'u_depth',\n  TEXTURE_PIXEL_WIDTH: 'u_texturePixelWidth',\n  TEXTURE_PIXEL_HEIGHT: 'u_texturePixelHeight',\n  TEXTURE_RESOLUTION: 'u_textureResolution',\n  TEXTURE_ORIGIN_X: 'u_textureOriginX',\n  TEXTURE_ORIGIN_Y: 'u_textureOriginY',\n  RENDER_EXTENT: 'u_renderExtent',\n  RESOLUTION: 'u_resolution',\n  ZOOM: 'u_zoom'\n};\nexport var Attributes = {\n  TEXTURE_COORD: 'a_textureCoord'\n};\n/**\n * @type {Array<import('../../webgl/Helper.js').AttributeDescription>}\n */\n\nvar attributeDescriptions = [{\n  name: Attributes.TEXTURE_COORD,\n  size: 2,\n  type: AttributeType.FLOAT\n}];\n/**\n * @type {Object<string, boolean>}\n */\n\nvar empty = {};\n/**\n * Transform a zoom level into a depth value ranging from -1 to 1.\n * @param {number} z A zoom level.\n * @return {number} A depth value.\n */\n\nfunction depthForZ(z) {\n  return 2 * (1 - 1 / (z + 1)) - 1;\n}\n/**\n * Add a tile texture to the lookup.\n * @param {Object<number, Array<import(\"../../webgl/TileTexture.js\").default>>} tileTexturesByZ Lookup of\n * tile textures by zoom level.\n * @param {import(\"../../webgl/TileTexture.js\").default} tileTexture A tile texture.\n * @param {number} z The zoom level.\n */\n\n\nfunction addTileTextureToLookup(tileTexturesByZ, tileTexture, z) {\n  if (!(z in tileTexturesByZ)) {\n    tileTexturesByZ[z] = [];\n  }\n\n  tileTexturesByZ[z].push(tileTexture);\n}\n/**\n * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n * @param {import(\"../../extent.js\").Extent} extent The frame extent.\n * @return {import(\"../../extent.js\").Extent} Frame extent intersected with layer extents.\n */\n\n\nfunction getRenderExtent(frameState, extent) {\n  var layerState = frameState.layerStatesArray[frameState.layerIndex];\n\n  if (layerState.extent) {\n    extent = getIntersection(extent, fromUserExtent(layerState.extent, frameState.viewState.projection));\n  }\n\n  var source =\n  /** @type {import(\"../../source/Tile.js\").default} */\n  layerState.layer.getRenderSource();\n\n  if (!source.getWrapX()) {\n    var gridExtent = source.getTileGridForProjection(frameState.viewState.projection).getExtent();\n\n    if (gridExtent) {\n      extent = getIntersection(extent, gridExtent);\n    }\n  }\n\n  return extent;\n}\n\nfunction getCacheKey(source, tileCoord) {\n  return \"\".concat(source.getKey(), \",\").concat(getTileCoordKey(tileCoord));\n}\n/**\n * @typedef {Object} Options\n * @property {string} vertexShader Vertex shader source.\n * @property {string} fragmentShader Fragment shader source.\n * @property {Object<string, import(\"../../webgl/Helper\").UniformValue>} [uniforms] Additional uniforms\n * made available to shaders.\n * @property {Array<import(\"../../webgl/PaletteTexture.js\").default>} [paletteTextures] Palette textures.\n * @property {number} [cacheSize=512] The texture cache size.\n */\n\n/**\n * @typedef {import(\"../../layer/WebGLTile.js\").default} LayerType\n */\n\n/**\n * @classdesc\n * WebGL renderer for tile layers.\n * @extends {WebGLLayerRenderer<LayerType>}\n * @api\n */\n\n\nvar WebGLTileLayerRenderer =\n/** @class */\nfunction (_super) {\n  __extends(WebGLTileLayerRenderer, _super);\n  /**\n   * @param {LayerType} tileLayer Tile layer.\n   * @param {Options} options Options.\n   */\n\n\n  function WebGLTileLayerRenderer(tileLayer, options) {\n    var _this = _super.call(this, tileLayer, {\n      uniforms: options.uniforms\n    }) || this;\n    /**\n     * The last call to `renderFrame` was completed with all tiles loaded\n     * @type {boolean}\n     */\n\n\n    _this.renderComplete = false;\n    /**\n     * This transform converts texture coordinates to screen coordinates.\n     * @type {import(\"../../transform.js\").Transform}\n     * @private\n     */\n\n    _this.tileTransform_ = createTransform();\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n\n    _this.tempMat4_ = createMat4();\n    /**\n     * @type {import(\"../../TileRange.js\").default}\n     * @private\n     */\n\n    _this.tempTileRange_ = new TileRange(0, 0, 0, 0);\n    /**\n     * @type {import(\"../../tilecoord.js\").TileCoord}\n     * @private\n     */\n\n    _this.tempTileCoord_ = createTileCoord(0, 0, 0);\n    /**\n     * @type {import(\"../../size.js\").Size}\n     * @private\n     */\n\n    _this.tempSize_ = [0, 0];\n    /**\n     * @type {WebGLProgram}\n     * @private\n     */\n\n    _this.program_;\n    /**\n     * @private\n     */\n\n    _this.vertexShader_ = options.vertexShader;\n    /**\n     * @private\n     */\n\n    _this.fragmentShader_ = options.fragmentShader;\n    /**\n     * Tiles are rendered as a quad with the following structure:\n     *\n     *  [P3]---------[P2]\n     *   |`           |\n     *   |  `     B   |\n     *   |    `       |\n     *   |      `     |\n     *   |   A    `   |\n     *   |          ` |\n     *  [P0]---------[P1]\n     *\n     * Triangle A: P0, P1, P3\n     * Triangle B: P1, P2, P3\n     *\n     * @private\n     */\n\n    _this.indices_ = new WebGLArrayBuffer(ELEMENT_ARRAY_BUFFER, STATIC_DRAW);\n\n    _this.indices_.fromArray([0, 1, 3, 1, 2, 3]);\n\n    var cacheSize = options.cacheSize !== undefined ? options.cacheSize : 512;\n    /**\n     * @type {import(\"../../structs/LRUCache.js\").default<import(\"../../webgl/TileTexture.js\").default>}\n     * @private\n     */\n\n    _this.tileTextureCache_ = new LRUCache(cacheSize);\n    /**\n     * @type {Array<import(\"../../webgl/PaletteTexture.js\").default>}\n     * @private\n     */\n\n    _this.paletteTextures_ = options.paletteTextures || [];\n    /**\n     * @private\n     * @type {import(\"../../PluggableMap.js\").FrameState|null}\n     */\n\n    _this.frameState_ = null;\n    return _this;\n  }\n  /**\n   * @param {Options} options Options.\n   */\n\n\n  WebGLTileLayerRenderer.prototype.reset = function (options) {\n    _super.prototype.reset.call(this, {\n      uniforms: options.uniforms\n    });\n\n    this.vertexShader_ = options.vertexShader;\n    this.fragmentShader_ = options.fragmentShader;\n    this.paletteTextures_ = options.paletteTextures || [];\n\n    if (this.helper) {\n      this.program_ = this.helper.getProgram(this.fragmentShader_, this.vertexShader_);\n    }\n  };\n\n  WebGLTileLayerRenderer.prototype.afterHelperCreated = function () {\n    this.program_ = this.helper.getProgram(this.fragmentShader_, this.vertexShader_);\n    this.helper.flushBufferData(this.indices_);\n  };\n  /**\n   * @param {import(\"../../webgl/TileTexture\").TileType} tile Tile.\n   * @return {boolean} Tile is drawable.\n   * @private\n   */\n\n\n  WebGLTileLayerRenderer.prototype.isDrawableTile_ = function (tile) {\n    var tileLayer = this.getLayer();\n    var tileState = tile.getState();\n    var useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    return tileState == TileState.LOADED || tileState == TileState.EMPTY || tileState == TileState.ERROR && !useInterimTilesOnError;\n  };\n  /**\n   * Determine whether renderFrame should be called.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {boolean} Layer is ready to be rendered.\n   */\n\n\n  WebGLTileLayerRenderer.prototype.prepareFrameInternal = function (frameState) {\n    var layer = this.getLayer();\n    var source = layer.getRenderSource();\n\n    if (!source) {\n      return false;\n    }\n\n    if (isEmpty(getRenderExtent(frameState, frameState.extent))) {\n      return false;\n    }\n\n    return source.getState() === State.READY;\n  };\n  /**\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../extent.js\").Extent} extent The extent to be rendered.\n   * @param {number} initialZ The zoom level.\n   * @param {Object<number, Array<TileTexture>>} tileTexturesByZ The zoom level.\n   */\n\n\n  WebGLTileLayerRenderer.prototype.enqueueTiles = function (frameState, extent, initialZ, tileTexturesByZ) {\n    var viewState = frameState.viewState;\n    var tileLayer = this.getLayer();\n    var tileSource = tileLayer.getRenderSource();\n    var tileGrid = tileSource.getTileGridForProjection(viewState.projection);\n    var tilePixelRatio = tileSource.getTilePixelRatio(frameState.pixelRatio);\n    var gutter = tileSource.getGutterForProjection(viewState.projection);\n    var tileSourceKey = getUid(tileSource);\n\n    if (!(tileSourceKey in frameState.wantedTiles)) {\n      frameState.wantedTiles[tileSourceKey] = {};\n    }\n\n    var wantedTiles = frameState.wantedTiles[tileSourceKey];\n    var tileTextureCache = this.tileTextureCache_;\n    var minZ = Math.max(initialZ - tileLayer.getPreload(), tileGrid.getMinZoom(), tileLayer.getMinZoom());\n\n    for (var z = initialZ; z >= minZ; --z) {\n      var tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, this.tempTileRange_);\n      var tileResolution = tileGrid.getResolution(z);\n\n      for (var x = tileRange.minX; x <= tileRange.maxX; ++x) {\n        for (var y = tileRange.minY; y <= tileRange.maxY; ++y) {\n          var tileCoord = createTileCoord(z, x, y, this.tempTileCoord_);\n          var cacheKey = getCacheKey(tileSource, tileCoord);\n          /** @type {TileTexture} */\n\n          var tileTexture = void 0;\n          /** @type {import(\"../../webgl/TileTexture\").TileType} */\n\n          var tile = void 0;\n\n          if (tileTextureCache.containsKey(cacheKey)) {\n            tileTexture = tileTextureCache.get(cacheKey);\n            tile = tileTexture.tile;\n          }\n\n          if (!tileTexture || tileTexture.tile.key !== tileSource.getKey()) {\n            tile = tileSource.getTile(z, x, y, frameState.pixelRatio, viewState.projection);\n\n            if (!tileTexture) {\n              tileTexture = new TileTexture({\n                tile: tile,\n                grid: tileGrid,\n                helper: this.helper,\n                tilePixelRatio: tilePixelRatio,\n                gutter: gutter\n              });\n              tileTextureCache.set(cacheKey, tileTexture);\n            } else {\n              if (this.isDrawableTile_(tile)) {\n                tileTexture.setTile(tile);\n              } else {\n                var interimTile =\n                /** @type {import(\"../../webgl/TileTexture\").TileType} */\n                tile.getInterimTile();\n                tileTexture.setTile(interimTile);\n              }\n            }\n          }\n\n          addTileTextureToLookup(tileTexturesByZ, tileTexture, z);\n          var tileQueueKey = tile.getKey();\n          wantedTiles[tileQueueKey] = true;\n\n          if (tile.getState() === TileState.IDLE) {\n            if (!frameState.tileQueue.isKeyQueued(tileQueueKey)) {\n              frameState.tileQueue.enqueue([tile, tileSourceKey, tileGrid.getTileCoordCenter(tileCoord), tileResolution]);\n            }\n          }\n        }\n      }\n    }\n  };\n  /**\n   * Render the layer.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {HTMLElement} The rendered element.\n   */\n\n\n  WebGLTileLayerRenderer.prototype.renderFrame = function (frameState) {\n    this.frameState_ = frameState;\n    this.renderComplete = true;\n    var gl = this.helper.getGL();\n    this.preRender(gl, frameState);\n    var viewState = frameState.viewState;\n    var tileLayer = this.getLayer();\n    var tileSource = tileLayer.getRenderSource();\n    var tileGrid = tileSource.getTileGridForProjection(viewState.projection);\n    var extent = getRenderExtent(frameState, frameState.extent);\n    var z = tileGrid.getZForResolution(viewState.resolution, tileSource.zDirection);\n    /**\n     * @type {Object<number, Array<import(\"../../webgl/TileTexture.js\").default>>}\n     */\n\n    var tileTexturesByZ = {};\n\n    if (frameState.nextExtent) {\n      var targetZ = tileGrid.getZForResolution(viewState.nextResolution, tileSource.zDirection);\n      var nextExtent = getRenderExtent(frameState, frameState.nextExtent);\n      this.enqueueTiles(frameState, nextExtent, targetZ, tileTexturesByZ);\n    }\n\n    this.enqueueTiles(frameState, extent, z, tileTexturesByZ);\n    /**\n     * A lookup of alpha values for tiles at the target rendering resolution\n     * for tiles that are in transition.  If a tile coord key is absent from\n     * this lookup, the tile should be rendered at alpha 1.\n     * @type {Object<string, number>}\n     */\n\n    var alphaLookup = {};\n    var uid = getUid(this);\n    var time = frameState.time;\n    var blend = false; // look for cached tiles to use if a target tile is not ready\n\n    var tileTextures = tileTexturesByZ[z];\n\n    for (var i = 0, ii = tileTextures.length; i < ii; ++i) {\n      var tileTexture = tileTextures[i];\n      var tile = tileTexture.tile;\n      var tileCoord = tile.tileCoord;\n\n      if (tileTexture.loaded) {\n        var alpha = tile.getAlpha(uid, time);\n\n        if (alpha === 1) {\n          // no need to look for alt tiles\n          tile.endTransition(uid);\n          continue;\n        }\n\n        blend = true;\n        var tileCoordKey = getTileCoordKey(tileCoord);\n        alphaLookup[tileCoordKey] = alpha;\n      }\n\n      this.renderComplete = false; // first look for child tiles (at z + 1)\n\n      var coveredByChildren = this.findAltTiles_(tileGrid, tileCoord, z + 1, tileTexturesByZ);\n\n      if (coveredByChildren) {\n        continue;\n      } // next look for parent tiles\n\n\n      var minZoom = tileGrid.getMinZoom();\n\n      for (var parentZ = z - 1; parentZ >= minZoom; --parentZ) {\n        var coveredByParent = this.findAltTiles_(tileGrid, tileCoord, parentZ, tileTexturesByZ);\n\n        if (coveredByParent) {\n          break;\n        }\n      }\n    }\n\n    this.helper.useProgram(this.program_);\n    this.helper.prepareDraw(frameState, !blend);\n    var zs = Object.keys(tileTexturesByZ).map(Number).sort(numberSafeCompareFunction);\n    var centerX = viewState.center[0];\n    var centerY = viewState.center[1];\n\n    for (var j = 0, jj = zs.length; j < jj; ++j) {\n      var tileZ = zs[j];\n      var tileResolution = tileGrid.getResolution(tileZ);\n      var tileSize = toSize(tileGrid.getTileSize(tileZ), this.tempSize_);\n      var tileOrigin = tileGrid.getOrigin(tileZ);\n      var centerI = (centerX - tileOrigin[0]) / (tileSize[0] * tileResolution);\n      var centerJ = (tileOrigin[1] - centerY) / (tileSize[1] * tileResolution);\n      var tileScale = viewState.resolution / tileResolution;\n      var depth = depthForZ(tileZ);\n      var tileTextures_1 = tileTexturesByZ[tileZ];\n\n      for (var i = 0, ii = tileTextures_1.length; i < ii; ++i) {\n        var tileTexture = tileTextures_1[i];\n\n        if (!tileTexture.loaded) {\n          continue;\n        }\n\n        var tile = tileTexture.tile;\n        var tileCoord = tile.tileCoord;\n        var tileCoordKey = getTileCoordKey(tileCoord);\n        var tileCenterI = tileCoord[1];\n        var tileCenterJ = tileCoord[2];\n        composeTransform(this.tileTransform_, 0, 0, 2 / (frameState.size[0] * tileScale / tileSize[0]), -2 / (frameState.size[1] * tileScale / tileSize[1]), viewState.rotation, -(centerI - tileCenterI), -(centerJ - tileCenterJ));\n        this.helper.setUniformMatrixValue(Uniforms.TILE_TRANSFORM, mat4FromTransform(this.tempMat4_, this.tileTransform_));\n        this.helper.bindBuffer(tileTexture.coords);\n        this.helper.bindBuffer(this.indices_);\n        this.helper.enableAttributes(attributeDescriptions);\n        var textureSlot = 0;\n\n        while (textureSlot < tileTexture.textures.length) {\n          var textureProperty = 'TEXTURE' + textureSlot;\n          var uniformName = \"\".concat(Uniforms.TILE_TEXTURE_ARRAY, \"[\").concat(textureSlot, \"]\");\n          gl.activeTexture(gl[textureProperty]);\n          gl.bindTexture(gl.TEXTURE_2D, tileTexture.textures[textureSlot]);\n          gl.uniform1i(this.helper.getUniformLocation(uniformName), textureSlot);\n          ++textureSlot;\n        }\n\n        for (var paletteIndex = 0; paletteIndex < this.paletteTextures_.length; ++paletteIndex) {\n          var paletteTexture = this.paletteTextures_[paletteIndex];\n          gl.activeTexture(gl['TEXTURE' + textureSlot]);\n          var texture = paletteTexture.getTexture(gl);\n          gl.bindTexture(gl.TEXTURE_2D, texture);\n          gl.uniform1i(this.helper.getUniformLocation(paletteTexture.name), textureSlot);\n          ++textureSlot;\n        }\n\n        var alpha = tileCoordKey in alphaLookup ? alphaLookup[tileCoordKey] : 1;\n\n        if (alpha < 1) {\n          frameState.animate = true;\n        }\n\n        this.helper.setUniformFloatValue(Uniforms.TRANSITION_ALPHA, alpha);\n        this.helper.setUniformFloatValue(Uniforms.DEPTH, depth);\n        this.helper.setUniformFloatValue(Uniforms.TEXTURE_PIXEL_WIDTH, tileSize[0]);\n        this.helper.setUniformFloatValue(Uniforms.TEXTURE_PIXEL_HEIGHT, tileSize[1]);\n        this.helper.setUniformFloatValue(Uniforms.TEXTURE_RESOLUTION, tileResolution);\n        this.helper.setUniformFloatValue(Uniforms.TEXTURE_ORIGIN_X, tileOrigin[0] + tileCenterI * tileSize[0] * tileResolution);\n        this.helper.setUniformFloatValue(Uniforms.TEXTURE_ORIGIN_Y, tileOrigin[1] - tileCenterJ * tileSize[1] * tileResolution);\n        this.helper.setUniformFloatVec4(Uniforms.RENDER_EXTENT, extent);\n        this.helper.setUniformFloatValue(Uniforms.RESOLUTION, viewState.resolution);\n        this.helper.setUniformFloatValue(Uniforms.ZOOM, viewState.zoom);\n        this.helper.drawElements(0, this.indices_.getSize());\n      }\n    }\n\n    this.helper.finalizeDraw(frameState, this.dispatchPreComposeEvent, this.dispatchPostComposeEvent);\n    var canvas = this.helper.getCanvas();\n    var tileTextureCache = this.tileTextureCache_;\n\n    while (tileTextureCache.canExpireCache()) {\n      var tileTexture = tileTextureCache.pop();\n      tileTexture.dispose();\n    } // TODO: let the renderers manage their own cache instead of managing the source cache\n\n    /**\n     * Here we unconditionally expire the source cache since the renderer maintains\n     * its own cache.\n     * @param {import(\"../../PluggableMap.js\").default} map Map.\n     * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n     */\n\n\n    var postRenderFunction = function postRenderFunction(map, frameState) {\n      tileSource.expireCache(frameState.viewState.projection, empty);\n    };\n\n    frameState.postRenderFunctions.push(postRenderFunction);\n    this.postRender(gl, frameState);\n    return canvas;\n  };\n  /**\n   * @param {import(\"../../pixel.js\").Pixel} pixel Pixel.\n   * @return {Uint8ClampedArray|Uint8Array|Float32Array|DataView} Data at the pixel location.\n   */\n\n\n  WebGLTileLayerRenderer.prototype.getData = function (pixel) {\n    var gl = this.helper.getGL();\n\n    if (!gl) {\n      return null;\n    }\n\n    var frameState = this.frameState_;\n\n    if (!frameState) {\n      return null;\n    }\n\n    var layer = this.getLayer();\n    var coordinate = applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n    var viewState = frameState.viewState;\n    var layerExtent = layer.getExtent();\n\n    if (layerExtent) {\n      if (!containsCoordinate(fromUserExtent(layerExtent, viewState.projection), coordinate)) {\n        return null;\n      }\n    }\n\n    var source = layer.getRenderSource();\n    var tileGrid = source.getTileGridForProjection(viewState.projection);\n\n    if (!source.getWrapX()) {\n      var gridExtent = tileGrid.getExtent();\n\n      if (gridExtent) {\n        if (!containsCoordinate(gridExtent, coordinate)) {\n          return null;\n        }\n      }\n    }\n\n    var tileTextureCache = this.tileTextureCache_;\n\n    for (var z = tileGrid.getZForResolution(viewState.resolution); z >= tileGrid.getMinZoom(); --z) {\n      var tileCoord = tileGrid.getTileCoordForCoordAndZ(coordinate, z);\n      var cacheKey = getCacheKey(source, tileCoord);\n\n      if (!tileTextureCache.containsKey(cacheKey)) {\n        continue;\n      }\n\n      var tileTexture = tileTextureCache.get(cacheKey);\n\n      if (!tileTexture.loaded) {\n        continue;\n      }\n\n      var tileOrigin = tileGrid.getOrigin(z);\n      var tileSize = toSize(tileGrid.getTileSize(z));\n      var tileResolution = tileGrid.getResolution(z);\n      var col = (coordinate[0] - tileOrigin[0]) / tileResolution - tileCoord[1] * tileSize[0];\n      var row = (tileOrigin[1] - coordinate[1]) / tileResolution - tileCoord[2] * tileSize[1];\n      return tileTexture.getPixelData(col, row);\n    }\n\n    return null;\n  };\n  /**\n   * Look for tiles covering the provided tile coordinate at an alternate\n   * zoom level.  Loaded tiles will be added to the provided tile texture lookup.\n   * @param {import(\"../../tilegrid/TileGrid.js\").default} tileGrid The tile grid.\n   * @param {import(\"../../tilecoord.js\").TileCoord} tileCoord The target tile coordinate.\n   * @param {number} altZ The alternate zoom level.\n   * @param {Object<number, Array<import(\"../../webgl/TileTexture.js\").default>>} tileTexturesByZ Lookup of\n   * tile textures by zoom level.\n   * @return {boolean} The tile coordinate is covered by loaded tiles at the alternate zoom level.\n   * @private\n   */\n\n\n  WebGLTileLayerRenderer.prototype.findAltTiles_ = function (tileGrid, tileCoord, altZ, tileTexturesByZ) {\n    var tileRange = tileGrid.getTileRangeForTileCoordAndZ(tileCoord, altZ, this.tempTileRange_);\n\n    if (!tileRange) {\n      return false;\n    }\n\n    var covered = true;\n    var tileTextureCache = this.tileTextureCache_;\n    var source = this.getLayer().getRenderSource();\n\n    for (var x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (var y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        var cacheKey = getCacheKey(source, [altZ, x, y]);\n        var loaded = false;\n\n        if (tileTextureCache.containsKey(cacheKey)) {\n          var tileTexture = tileTextureCache.get(cacheKey);\n\n          if (tileTexture.loaded) {\n            addTileTextureToLookup(tileTexturesByZ, tileTexture, altZ);\n            loaded = true;\n          }\n        }\n\n        if (!loaded) {\n          covered = false;\n        }\n      }\n    }\n\n    return covered;\n  };\n\n  WebGLTileLayerRenderer.prototype.removeHelper = function () {\n    if (this.helper) {\n      var tileTextureCache = this.tileTextureCache_;\n      tileTextureCache.forEach(function (tileTexture) {\n        return tileTexture.dispose();\n      });\n      tileTextureCache.clear();\n    }\n\n    _super.prototype.removeHelper.call(this);\n  };\n  /**\n   * Clean up.\n   */\n\n\n  WebGLTileLayerRenderer.prototype.disposeInternal = function () {\n    var helper = this.helper;\n\n    if (helper) {\n      var gl = helper.getGL();\n      gl.deleteProgram(this.program_);\n      delete this.program_;\n      helper.deleteBuffer(this.indices_);\n    }\n\n    _super.prototype.disposeInternal.call(this);\n\n    delete this.indices_;\n    delete this.tileTextureCache_;\n    delete this.frameState_;\n  };\n\n  return WebGLTileLayerRenderer;\n}(WebGLLayerRenderer);\n\nexport default WebGLTileLayerRenderer;","map":{"version":3,"mappings":"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","names":["LRUCache","State","TileRange","TileState","TileTexture","WebGLArrayBuffer","WebGLLayerRenderer","AttributeType","ELEMENT_ARRAY_BUFFER","STATIC_DRAW","apply","applyTransform","compose","composeTransform","create","createTransform","containsCoordinate","getIntersection","isEmpty","createMat4","fromTransform","mat4FromTransform","createOrUpdate","createTileCoord","getKey","getTileCoordKey","fromUserExtent","getUid","numberSafeCompareFunction","toSize","Uniforms","TILE_TEXTURE_ARRAY","TILE_TRANSFORM","TRANSITION_ALPHA","DEPTH","TEXTURE_PIXEL_WIDTH","TEXTURE_PIXEL_HEIGHT","TEXTURE_RESOLUTION","TEXTURE_ORIGIN_X","TEXTURE_ORIGIN_Y","RENDER_EXTENT","RESOLUTION","ZOOM","Attributes","TEXTURE_COORD","attributeDescriptions","name","size","type","FLOAT","empty","depthForZ","z","addTileTextureToLookup","tileTexturesByZ","tileTexture","push","getRenderExtent","frameState","extent","layerState","layerStatesArray","layerIndex","viewState","projection","source","layer","getRenderSource","getWrapX","gridExtent","getTileGridForProjection","getExtent","getCacheKey","tileCoord","concat","__extends","tileLayer","options","_super","uniforms","_this","renderComplete","tileTransform_","tempMat4_","tempTileRange_","tempTileCoord_","tempSize_","program_","vertexShader_","vertexShader","fragmentShader_","fragmentShader","indices_","fromArray","cacheSize","undefined","tileTextureCache_","paletteTextures_","paletteTextures","frameState_","WebGLTileLayerRenderer","reset","call","helper","getProgram","flushBufferData","tile","getLayer","tileState","getState","useInterimTilesOnError","getUseInterimTilesOnError","LOADED","EMPTY","ERROR","READY","initialZ","tileSource","tileGrid","tilePixelRatio","getTilePixelRatio","pixelRatio","gutter","getGutterForProjection","tileSourceKey","wantedTiles","tileTextureCache","minZ","Math","max","getPreload","getMinZoom","tileRange","getTileRangeForExtentAndZ","tileResolution","getResolution","x","minX","maxX","y","minY","maxY","cacheKey","containsKey","get","key","getTile","grid","set","isDrawableTile_","setTile","interimTile","getInterimTile","tileQueueKey","IDLE","tileQueue","isKeyQueued","enqueue","getTileCoordCenter","gl","getGL","preRender","getZForResolution","resolution","zDirection","nextExtent","targetZ","nextResolution","enqueueTiles","alphaLookup","uid","time","blend","tileTextures","i","ii","length","loaded","alpha","getAlpha","endTransition","tileCoordKey","coveredByChildren","findAltTiles_","minZoom","parentZ","coveredByParent","useProgram","prepareDraw","zs","Object","keys","map","Number","sort","centerX","center","centerY","j","jj","tileZ","tileSize","getTileSize","tileOrigin","getOrigin","centerI","centerJ","tileScale","depth","tileTextures_1","tileCenterI","tileCenterJ","rotation","setUniformMatrixValue","bindBuffer","coords","enableAttributes","textureSlot","textures","textureProperty","uniformName","activeTexture","bindTexture","TEXTURE_2D","uniform1i","getUniformLocation","paletteIndex","paletteTexture","texture","getTexture","animate","setUniformFloatValue","setUniformFloatVec4","zoom","drawElements","getSize","finalizeDraw","dispatchPreComposeEvent","dispatchPostComposeEvent","canvas","getCanvas","canExpireCache","pop","dispose","postRenderFunction","expireCache","postRenderFunctions","postRender","pixel","coordinate","pixelToCoordinateTransform","slice","layerExtent","getTileCoordForCoordAndZ","col","row","getPixelData","altZ","getTileRangeForTileCoordAndZ","covered","forEach","clear","removeHelper","deleteProgram","deleteBuffer","disposeInternal"],"sourceRoot":"","sources":["../../src/renderer/webgl/TileLayer.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}