{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { defineComponent, getCurrentInstance, inject, watch, onUnmounted, onUpdated, h } from 'vue';\nimport { isClient } from '@vueuse/core';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport useLayoutObserver from '../layout-observer.mjs';\nimport { removePopper } from '../util.mjs';\nimport { TABLE_INJECTION_KEY } from '../tokens.mjs';\nimport useRender from './render-helper.mjs';\nimport defaultProps from './defaults.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { removeClass, addClass } from '../../../../utils/dom/style.mjs';\nvar TableBody = defineComponent({\n  name: \"ElTableBody\",\n  props: defaultProps,\n  setup: function setup(props) {\n    var instance = getCurrentInstance();\n    var parent = inject(TABLE_INJECTION_KEY);\n    var ns = useNamespace(\"table\");\n\n    var _useRender = useRender(props),\n        wrappedRowRender = _useRender.wrappedRowRender,\n        tooltipContent = _useRender.tooltipContent,\n        tooltipTrigger = _useRender.tooltipTrigger;\n\n    var _useLayoutObserver = useLayoutObserver(parent),\n        onColumnsChange = _useLayoutObserver.onColumnsChange,\n        onScrollableChange = _useLayoutObserver.onScrollableChange;\n\n    watch(props.store.states.hoverRow, function (newVal, oldVal) {\n      if (!props.store.states.isComplex.value || !isClient) return;\n      var raf = window.requestAnimationFrame;\n\n      if (!raf) {\n        raf = function raf(fn) {\n          return window.setTimeout(fn, 16);\n        };\n      }\n\n      raf(function () {\n        var _a;\n\n        var rows = (_a = instance == null ? void 0 : instance.vnode.el) == null ? void 0 : _a.querySelectorAll(\".\".concat(ns.e(\"row\")));\n        var oldRow = rows[oldVal];\n        var newRow = rows[newVal];\n\n        if (oldRow) {\n          removeClass(oldRow, \"hover-row\");\n        }\n\n        if (newRow) {\n          addClass(newRow, \"hover-row\");\n        }\n      });\n    });\n    onUnmounted(function () {\n      var _a;\n\n      (_a = removePopper) == null ? void 0 : _a();\n    });\n    onUpdated(function () {\n      var _a;\n\n      (_a = removePopper) == null ? void 0 : _a();\n    });\n    return {\n      ns: ns,\n      onColumnsChange: onColumnsChange,\n      onScrollableChange: onScrollableChange,\n      wrappedRowRender: wrappedRowRender,\n      tooltipContent: tooltipContent,\n      tooltipTrigger: tooltipTrigger\n    };\n  },\n  render: function render() {\n    var wrappedRowRender = this.wrappedRowRender,\n        store = this.store;\n    var data = store.states.data.value || [];\n    return h(\"tbody\", {}, [data.reduce(function (acc, row) {\n      return acc.concat(wrappedRowRender(row, acc.length));\n    }, [])]);\n  }\n});\nexport { TableBody as default };","map":{"version":3,"mappings":"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","names":["defineComponent","name","props","defaultProps","setup","instance","getCurrentInstance","parent","inject","TABLE_INJECTION_KEY","ns","useNamespace","useRender","wrappedRowRender","tooltipContent","tooltipTrigger","useLayoutObserver","onColumnsChange","onScrollableChange","watch","store","states","hoverRow","newVal","oldVal","isComplex","value","isClient","raf","window","requestAnimationFrame","fn","setTimeout","_a","rows","vnode","el","querySelectorAll","e","oldRow","newRow","removeClass","addClass","onUnmounted","removePopper","onUpdated","render","data","h","reduce","acc","row","concat","length"],"sources":["../../../../../../../packages/components/table/src/table-body/index.ts"],"sourcesContent":["import {\n  defineComponent,\n  getCurrentInstance,\n  h,\n  watch,\n  onUnmounted,\n  onUpdated,\n  inject,\n} from 'vue'\nimport { isClient } from '@vueuse/core'\nimport { addClass, removeClass } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport useLayoutObserver from '../layout-observer'\nimport { removePopper } from '../util'\nimport { TABLE_INJECTION_KEY } from '../tokens'\nimport useRender from './render-helper'\nimport defaultProps from './defaults'\n\nimport type { VNode } from 'vue'\n\nexport default defineComponent({\n  name: 'ElTableBody',\n  props: defaultProps,\n  setup(props) {\n    const instance = getCurrentInstance()\n    const parent = inject(TABLE_INJECTION_KEY)\n    const ns = useNamespace('table')\n    const { wrappedRowRender, tooltipContent, tooltipTrigger } =\n      useRender(props)\n    const { onColumnsChange, onScrollableChange } = useLayoutObserver(parent!)\n\n    watch(props.store.states.hoverRow, (newVal: any, oldVal: any) => {\n      if (!props.store.states.isComplex.value || !isClient) return\n      let raf = window.requestAnimationFrame\n      if (!raf) {\n        raf = (fn) => window.setTimeout(fn, 16)\n      }\n      raf(() => {\n        const rows = instance?.vnode.el?.querySelectorAll(`.${ns.e('row')}`)\n        const oldRow = rows[oldVal]\n        const newRow = rows[newVal]\n        if (oldRow) {\n          removeClass(oldRow, 'hover-row')\n        }\n        if (newRow) {\n          addClass(newRow, 'hover-row')\n        }\n      })\n    })\n\n    onUnmounted(() => {\n      removePopper?.()\n    })\n    onUpdated(() => {\n      removePopper?.()\n    })\n\n    return {\n      ns,\n      onColumnsChange,\n      onScrollableChange,\n      wrappedRowRender,\n      tooltipContent,\n      tooltipTrigger,\n    }\n  },\n  render() {\n    const { wrappedRowRender, store } = this\n    const data = store.states.data.value || []\n    return h('tbody', {}, [\n      data.reduce((acc: VNode[], row) => {\n        return acc.concat(wrappedRowRender(row, acc.length))\n      }, []),\n    ])\n  },\n})\n"]},"metadata":{},"sourceType":"module"}