{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.string.link.js\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/format/GPX\n */\n\n\nimport Feature from '../Feature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport Point from '../geom/Point.js';\nimport XMLFeature from './XMLFeature.js';\nimport { OBJECT_PROPERTY_NODE_FACTORY, XML_SCHEMA_INSTANCE_URI, createElementNS, makeArrayPusher, makeArraySerializer, makeChildAppender, makeObjectPropertySetter, makeSequence, makeSimpleNodeFactory, makeStructureNS, parseNode, pushParseAndPop, pushSerializeAndPop } from '../xml.js';\nimport { get as getProjection } from '../proj.js';\nimport { includes } from '../array.js';\nimport { readDateTime, readDecimal, readPositiveInteger, readString, writeDateTimeTextNode, writeDecimalTextNode, writeNonNegativeIntegerTextNode, writeStringTextNode } from './xsd.js';\nimport { transformGeometryWithOptions } from './Feature.js';\n/**\n * @const\n * @type {Array<null|string>}\n */\n\nvar NAMESPACE_URIS = [null, 'http://www.topografix.com/GPX/1/0', 'http://www.topografix.com/GPX/1/1'];\n/**\n * @const\n * @type {string}\n */\n\nvar SCHEMA_LOCATION = 'http://www.topografix.com/GPX/1/1 ' + 'http://www.topografix.com/GPX/1/1/gpx.xsd';\n/**\n * @const\n * @type {Object<string, function(Node, Array<*>): (Feature|undefined)>}\n */\n\nvar FEATURE_READER = {\n  'rte': readRte,\n  'trk': readTrk,\n  'wpt': readWpt\n};\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar GPX_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'rte': makeArrayPusher(readRte),\n  'trk': makeArrayPusher(readTrk),\n  'wpt': makeArrayPusher(readWpt)\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar LINK_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'text': makeObjectPropertySetter(readString, 'linkText'),\n  'type': makeObjectPropertySetter(readString, 'linkType')\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\n\nvar GPX_SERIALIZERS = makeStructureNS(NAMESPACE_URIS, {\n  'rte': makeChildAppender(writeRte),\n  'trk': makeChildAppender(writeTrk),\n  'wpt': makeChildAppender(writeWpt)\n});\n/**\n * @typedef {Object} Options\n * @property {function(Feature, Node):void} [readExtensions] Callback function\n * to process `extensions` nodes. To prevent memory leaks, this callback function must\n * not store any references to the node. Note that the `extensions`\n * node is not allowed in GPX 1.0. Moreover, only `extensions`\n * nodes from `wpt`, `rte` and `trk` can be processed, as those are\n * directly mapped to a feature.\n */\n\n/**\n * @typedef {Object} LayoutOptions\n * @property {boolean} [hasZ] HasZ.\n * @property {boolean} [hasM] HasM.\n */\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GPX format.\n *\n * Note that {@link module:ol/format/GPX~GPX#readFeature} only reads the first\n * feature of the source.\n *\n * When reading, routes (`<rte>`) are converted into LineString geometries, and\n * tracks (`<trk>`) into MultiLineString. Any properties on route and track\n * waypoints are ignored.\n *\n * When writing, LineString geometries are output as routes (`<rte>`), and\n * MultiLineString as tracks (`<trk>`).\n *\n * @api\n */\n\nvar GPX =\n/** @class */\nfunction (_super) {\n  __extends(GPX, _super);\n  /**\n   * @param {Options} [opt_options] Options.\n   */\n\n\n  function GPX(opt_options) {\n    var _this = _super.call(this) || this;\n\n    var options = opt_options ? opt_options : {};\n    /**\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n\n    _this.dataProjection = getProjection('EPSG:4326');\n    /**\n     * @type {function(Feature, Node): void|undefined}\n     * @private\n     */\n\n    _this.readExtensions_ = options.readExtensions;\n    return _this;\n  }\n  /**\n   * @param {Array<Feature>} features List of features.\n   * @private\n   */\n\n\n  GPX.prototype.handleReadExtensions_ = function (features) {\n    if (!features) {\n      features = [];\n    }\n\n    for (var i = 0, ii = features.length; i < ii; ++i) {\n      var feature = features[i];\n\n      if (this.readExtensions_) {\n        var extensionsNode = feature.get('extensionsNode_') || null;\n        this.readExtensions_(feature, extensionsNode);\n      }\n\n      feature.set('extensionsNode_', undefined);\n    }\n  };\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"./Feature.js\").ReadOptions} [opt_options] Options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n\n\n  GPX.prototype.readFeatureFromNode = function (node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return null;\n    }\n\n    var featureReader = FEATURE_READER[node.localName];\n\n    if (!featureReader) {\n      return null;\n    }\n\n    var feature = featureReader(node, [this.getReadOptions(node, opt_options)]);\n\n    if (!feature) {\n      return null;\n    }\n\n    this.handleReadExtensions_([feature]);\n    return feature;\n  };\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"./Feature.js\").ReadOptions} [opt_options] Options.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n\n\n  GPX.prototype.readFeaturesFromNode = function (node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return [];\n    }\n\n    if (node.localName == 'gpx') {\n      /** @type {Array<Feature>} */\n      var features = pushParseAndPop([], GPX_PARSERS, node, [this.getReadOptions(node, opt_options)]);\n\n      if (features) {\n        this.handleReadExtensions_(features);\n        return features;\n      } else {\n        return [];\n      }\n    }\n\n    return [];\n  };\n  /**\n   * Encode an array of features in the GPX format as an XML node.\n   * LineString geometries are output as routes (`<rte>`), and MultiLineString\n   * as tracks (`<trk>`).\n   *\n   * @param {Array<Feature>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions} [opt_options] Options.\n   * @return {Node} Node.\n   * @api\n   */\n\n\n  GPX.prototype.writeFeaturesNode = function (features, opt_options) {\n    opt_options = this.adaptOptions(opt_options); //FIXME Serialize metadata\n\n    var gpx = createElementNS('http://www.topografix.com/GPX/1/1', 'gpx');\n    var xmlnsUri = 'http://www.w3.org/2000/xmlns/';\n    gpx.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\n    gpx.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\n    gpx.setAttribute('version', '1.1');\n    gpx.setAttribute('creator', 'OpenLayers');\n    pushSerializeAndPop(\n    /** @type {import(\"../xml.js\").NodeStackItem} */\n    {\n      node: gpx\n    }, GPX_SERIALIZERS, GPX_NODE_FACTORY, features, [opt_options]);\n    return gpx;\n  };\n\n  return GPX;\n}(XMLFeature);\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\n\nvar RTE_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'name': makeObjectPropertySetter(readString),\n  'cmt': makeObjectPropertySetter(readString),\n  'desc': makeObjectPropertySetter(readString),\n  'src': makeObjectPropertySetter(readString),\n  'link': parseLink,\n  'number': makeObjectPropertySetter(readPositiveInteger),\n  'extensions': parseExtensions,\n  'type': makeObjectPropertySetter(readString),\n  'rtept': parseRtePt\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar RTEPT_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'ele': makeObjectPropertySetter(readDecimal),\n  'time': makeObjectPropertySetter(readDateTime)\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar TRK_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'name': makeObjectPropertySetter(readString),\n  'cmt': makeObjectPropertySetter(readString),\n  'desc': makeObjectPropertySetter(readString),\n  'src': makeObjectPropertySetter(readString),\n  'link': parseLink,\n  'number': makeObjectPropertySetter(readPositiveInteger),\n  'type': makeObjectPropertySetter(readString),\n  'extensions': parseExtensions,\n  'trkseg': parseTrkSeg\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar TRKSEG_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'trkpt': parseTrkPt\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar TRKPT_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'ele': makeObjectPropertySetter(readDecimal),\n  'time': makeObjectPropertySetter(readDateTime)\n});\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\n\nvar WPT_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'ele': makeObjectPropertySetter(readDecimal),\n  'time': makeObjectPropertySetter(readDateTime),\n  'magvar': makeObjectPropertySetter(readDecimal),\n  'geoidheight': makeObjectPropertySetter(readDecimal),\n  'name': makeObjectPropertySetter(readString),\n  'cmt': makeObjectPropertySetter(readString),\n  'desc': makeObjectPropertySetter(readString),\n  'src': makeObjectPropertySetter(readString),\n  'link': parseLink,\n  'sym': makeObjectPropertySetter(readString),\n  'type': makeObjectPropertySetter(readString),\n  'fix': makeObjectPropertySetter(readString),\n  'sat': makeObjectPropertySetter(readPositiveInteger),\n  'hdop': makeObjectPropertySetter(readDecimal),\n  'vdop': makeObjectPropertySetter(readDecimal),\n  'pdop': makeObjectPropertySetter(readDecimal),\n  'ageofdgpsdata': makeObjectPropertySetter(readDecimal),\n  'dgpsid': makeObjectPropertySetter(readPositiveInteger),\n  'extensions': parseExtensions\n});\n/**\n * @const\n * @type {Array<string>}\n */\n\nvar LINK_SEQUENCE = ['text', 'type'];\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\n\nvar LINK_SERIALIZERS = makeStructureNS(NAMESPACE_URIS, {\n  'text': makeChildAppender(writeStringTextNode),\n  'type': makeChildAppender(writeStringTextNode)\n});\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\n\nvar RTE_SEQUENCE = makeStructureNS(NAMESPACE_URIS, ['name', 'cmt', 'desc', 'src', 'link', 'number', 'type', 'rtept']);\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\n\nvar RTE_SERIALIZERS = makeStructureNS(NAMESPACE_URIS, {\n  'name': makeChildAppender(writeStringTextNode),\n  'cmt': makeChildAppender(writeStringTextNode),\n  'desc': makeChildAppender(writeStringTextNode),\n  'src': makeChildAppender(writeStringTextNode),\n  'link': makeChildAppender(writeLink),\n  'number': makeChildAppender(writeNonNegativeIntegerTextNode),\n  'type': makeChildAppender(writeStringTextNode),\n  'rtept': makeArraySerializer(makeChildAppender(writeWptType))\n});\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\n\nvar RTEPT_TYPE_SEQUENCE = makeStructureNS(NAMESPACE_URIS, ['ele', 'time']);\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\n\nvar TRK_SEQUENCE = makeStructureNS(NAMESPACE_URIS, ['name', 'cmt', 'desc', 'src', 'link', 'number', 'type', 'trkseg']);\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\n\nvar TRK_SERIALIZERS = makeStructureNS(NAMESPACE_URIS, {\n  'name': makeChildAppender(writeStringTextNode),\n  'cmt': makeChildAppender(writeStringTextNode),\n  'desc': makeChildAppender(writeStringTextNode),\n  'src': makeChildAppender(writeStringTextNode),\n  'link': makeChildAppender(writeLink),\n  'number': makeChildAppender(writeNonNegativeIntegerTextNode),\n  'type': makeChildAppender(writeStringTextNode),\n  'trkseg': makeArraySerializer(makeChildAppender(writeTrkSeg))\n});\n/**\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\n\nvar TRKSEG_NODE_FACTORY = makeSimpleNodeFactory('trkpt');\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\n\nvar TRKSEG_SERIALIZERS = makeStructureNS(NAMESPACE_URIS, {\n  'trkpt': makeChildAppender(writeWptType)\n});\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\n\nvar WPT_TYPE_SEQUENCE = makeStructureNS(NAMESPACE_URIS, ['ele', 'time', 'magvar', 'geoidheight', 'name', 'cmt', 'desc', 'src', 'link', 'sym', 'type', 'fix', 'sat', 'hdop', 'vdop', 'pdop', 'ageofdgpsdata', 'dgpsid']);\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\n\nvar WPT_TYPE_SERIALIZERS = makeStructureNS(NAMESPACE_URIS, {\n  'ele': makeChildAppender(writeDecimalTextNode),\n  'time': makeChildAppender(writeDateTimeTextNode),\n  'magvar': makeChildAppender(writeDecimalTextNode),\n  'geoidheight': makeChildAppender(writeDecimalTextNode),\n  'name': makeChildAppender(writeStringTextNode),\n  'cmt': makeChildAppender(writeStringTextNode),\n  'desc': makeChildAppender(writeStringTextNode),\n  'src': makeChildAppender(writeStringTextNode),\n  'link': makeChildAppender(writeLink),\n  'sym': makeChildAppender(writeStringTextNode),\n  'type': makeChildAppender(writeStringTextNode),\n  'fix': makeChildAppender(writeStringTextNode),\n  'sat': makeChildAppender(writeNonNegativeIntegerTextNode),\n  'hdop': makeChildAppender(writeDecimalTextNode),\n  'vdop': makeChildAppender(writeDecimalTextNode),\n  'pdop': makeChildAppender(writeDecimalTextNode),\n  'ageofdgpsdata': makeChildAppender(writeDecimalTextNode),\n  'dgpsid': makeChildAppender(writeNonNegativeIntegerTextNode)\n});\n/**\n * @const\n * @type {Object<string, string>}\n */\n\nvar GEOMETRY_TYPE_TO_NODENAME = {\n  'Point': 'wpt',\n  'LineString': 'rte',\n  'MultiLineString': 'trk'\n};\n/**\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string} [opt_nodeName] Node name.\n * @return {Node|undefined} Node.\n */\n\nfunction GPX_NODE_FACTORY(value, objectStack, opt_nodeName) {\n  var geometry =\n  /** @type {Feature} */\n  value.getGeometry();\n\n  if (geometry) {\n    var nodeName = GEOMETRY_TYPE_TO_NODENAME[geometry.getType()];\n\n    if (nodeName) {\n      var parentNode = objectStack[objectStack.length - 1].node;\n      return createElementNS(parentNode.namespaceURI, nodeName);\n    }\n  }\n}\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {LayoutOptions} layoutOptions Layout options.\n * @param {Element} node Node.\n * @param {!Object} values Values.\n * @return {Array<number>} Flat coordinates.\n */\n\n\nfunction appendCoordinate(flatCoordinates, layoutOptions, node, values) {\n  flatCoordinates.push(parseFloat(node.getAttribute('lon')), parseFloat(node.getAttribute('lat')));\n\n  if ('ele' in values) {\n    flatCoordinates.push(\n    /** @type {number} */\n    values['ele']);\n    delete values['ele'];\n    layoutOptions.hasZ = true;\n  } else {\n    flatCoordinates.push(0);\n  }\n\n  if ('time' in values) {\n    flatCoordinates.push(\n    /** @type {number} */\n    values['time']);\n    delete values['time'];\n    layoutOptions.hasM = true;\n  } else {\n    flatCoordinates.push(0);\n  }\n\n  return flatCoordinates;\n}\n/**\n * Choose GeometryLayout based on flags in layoutOptions and adjust flatCoordinates\n * and ends arrays by shrinking them accordingly (removing unused zero entries).\n *\n * @param {LayoutOptions} layoutOptions Layout options.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {Array<number>} [ends] Ends.\n * @return {import(\"../geom/GeometryLayout.js\").default} Layout.\n */\n\n\nfunction applyLayoutOptions(layoutOptions, flatCoordinates, ends) {\n  var layout = GeometryLayout.XY;\n  var stride = 2;\n\n  if (layoutOptions.hasZ && layoutOptions.hasM) {\n    layout = GeometryLayout.XYZM;\n    stride = 4;\n  } else if (layoutOptions.hasZ) {\n    layout = GeometryLayout.XYZ;\n    stride = 3;\n  } else if (layoutOptions.hasM) {\n    layout = GeometryLayout.XYM;\n    stride = 3;\n  }\n\n  if (stride !== 4) {\n    for (var i = 0, ii = flatCoordinates.length / 4; i < ii; i++) {\n      flatCoordinates[i * stride] = flatCoordinates[i * 4];\n      flatCoordinates[i * stride + 1] = flatCoordinates[i * 4 + 1];\n\n      if (layoutOptions.hasZ) {\n        flatCoordinates[i * stride + 2] = flatCoordinates[i * 4 + 2];\n      }\n\n      if (layoutOptions.hasM) {\n        flatCoordinates[i * stride + 2] = flatCoordinates[i * 4 + 3];\n      }\n    }\n\n    flatCoordinates.length = flatCoordinates.length / 4 * stride;\n\n    if (ends) {\n      for (var i = 0, ii = ends.length; i < ii; i++) {\n        ends[i] = ends[i] / 4 * stride;\n      }\n    }\n  }\n\n  return layout;\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction parseLink(node, objectStack) {\n  var values =\n  /** @type {Object} */\n  objectStack[objectStack.length - 1];\n  var href = node.getAttribute('href');\n\n  if (href !== null) {\n    values['link'] = href;\n  }\n\n  parseNode(LINK_PARSERS, node, objectStack);\n}\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction parseExtensions(node, objectStack) {\n  var values =\n  /** @type {Object} */\n  objectStack[objectStack.length - 1];\n  values['extensionsNode_'] = node;\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction parseRtePt(node, objectStack) {\n  var values = pushParseAndPop({}, RTEPT_PARSERS, node, objectStack);\n\n  if (values) {\n    var rteValues =\n    /** @type {!Object} */\n    objectStack[objectStack.length - 1];\n    var flatCoordinates =\n    /** @type {Array<number>} */\n    rteValues['flatCoordinates'];\n    var layoutOptions =\n    /** @type {LayoutOptions} */\n    rteValues['layoutOptions'];\n    appendCoordinate(flatCoordinates, layoutOptions, node, values);\n  }\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction parseTrkPt(node, objectStack) {\n  var values = pushParseAndPop({}, TRKPT_PARSERS, node, objectStack);\n\n  if (values) {\n    var trkValues =\n    /** @type {!Object} */\n    objectStack[objectStack.length - 1];\n    var flatCoordinates =\n    /** @type {Array<number>} */\n    trkValues['flatCoordinates'];\n    var layoutOptions =\n    /** @type {LayoutOptions} */\n    trkValues['layoutOptions'];\n    appendCoordinate(flatCoordinates, layoutOptions, node, values);\n  }\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction parseTrkSeg(node, objectStack) {\n  var values =\n  /** @type {Object} */\n  objectStack[objectStack.length - 1];\n  parseNode(TRKSEG_PARSERS, node, objectStack);\n  var flatCoordinates =\n  /** @type {Array<number>} */\n  values['flatCoordinates'];\n  var ends =\n  /** @type {Array<number>} */\n  values['ends'];\n  ends.push(flatCoordinates.length);\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Feature|undefined} Track.\n */\n\n\nfunction readRte(node, objectStack) {\n  var options =\n  /** @type {import(\"./Feature.js\").ReadOptions} */\n  objectStack[0];\n  var values = pushParseAndPop({\n    'flatCoordinates': [],\n    'layoutOptions': {}\n  }, RTE_PARSERS, node, objectStack);\n\n  if (!values) {\n    return undefined;\n  }\n\n  var flatCoordinates =\n  /** @type {Array<number>} */\n  values['flatCoordinates'];\n  delete values['flatCoordinates'];\n  var layoutOptions =\n  /** @type {LayoutOptions} */\n  values['layoutOptions'];\n  delete values['layoutOptions'];\n  var layout = applyLayoutOptions(layoutOptions, flatCoordinates);\n  var geometry = new LineString(flatCoordinates, layout);\n  transformGeometryWithOptions(geometry, false, options);\n  var feature = new Feature(geometry);\n  feature.setProperties(values, true);\n  return feature;\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Feature|undefined} Track.\n */\n\n\nfunction readTrk(node, objectStack) {\n  var options =\n  /** @type {import(\"./Feature.js\").ReadOptions} */\n  objectStack[0];\n  var values = pushParseAndPop({\n    'flatCoordinates': [],\n    'ends': [],\n    'layoutOptions': {}\n  }, TRK_PARSERS, node, objectStack);\n\n  if (!values) {\n    return undefined;\n  }\n\n  var flatCoordinates =\n  /** @type {Array<number>} */\n  values['flatCoordinates'];\n  delete values['flatCoordinates'];\n  var ends =\n  /** @type {Array<number>} */\n  values['ends'];\n  delete values['ends'];\n  var layoutOptions =\n  /** @type {LayoutOptions} */\n  values['layoutOptions'];\n  delete values['layoutOptions'];\n  var layout = applyLayoutOptions(layoutOptions, flatCoordinates, ends);\n  var geometry = new MultiLineString(flatCoordinates, layout, ends);\n  transformGeometryWithOptions(geometry, false, options);\n  var feature = new Feature(geometry);\n  feature.setProperties(values, true);\n  return feature;\n}\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Feature|undefined} Waypoint.\n */\n\n\nfunction readWpt(node, objectStack) {\n  var options =\n  /** @type {import(\"./Feature.js\").ReadOptions} */\n  objectStack[0];\n  var values = pushParseAndPop({}, WPT_PARSERS, node, objectStack);\n\n  if (!values) {\n    return undefined;\n  }\n\n  var layoutOptions =\n  /** @type {LayoutOptions} */\n  {};\n  var coordinates = appendCoordinate([], layoutOptions, node, values);\n  var layout = applyLayoutOptions(layoutOptions, coordinates);\n  var geometry = new Point(coordinates, layout);\n  transformGeometryWithOptions(geometry, false, options);\n  var feature = new Feature(geometry);\n  feature.setProperties(values, true);\n  return feature;\n}\n/**\n * @param {Element} node Node.\n * @param {string} value Value for the link's `href` attribute.\n * @param {Array<*>} objectStack Node stack.\n */\n\n\nfunction writeLink(node, value, objectStack) {\n  node.setAttribute('href', value);\n  var context = objectStack[objectStack.length - 1];\n  var properties = context['properties'];\n  var link = [properties['linkText'], properties['linkType']];\n  pushSerializeAndPop(\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  {\n    node: node\n  }, LINK_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY, link, objectStack, LINK_SEQUENCE);\n}\n/**\n * @param {Element} node Node.\n * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction writeWptType(node, coordinate, objectStack) {\n  var context = objectStack[objectStack.length - 1];\n  var parentNode = context.node;\n  var namespaceURI = parentNode.namespaceURI;\n  var properties = context['properties']; //FIXME Projection handling\n\n  node.setAttributeNS(null, 'lat', String(coordinate[1]));\n  node.setAttributeNS(null, 'lon', String(coordinate[0]));\n  var geometryLayout = context['geometryLayout'];\n\n  switch (geometryLayout) {\n    case GeometryLayout.XYZM:\n      if (coordinate[3] !== 0) {\n        properties['time'] = coordinate[3];\n      }\n\n    // fall through\n\n    case GeometryLayout.XYZ:\n      if (coordinate[2] !== 0) {\n        properties['ele'] = coordinate[2];\n      }\n\n      break;\n\n    case GeometryLayout.XYM:\n      if (coordinate[2] !== 0) {\n        properties['time'] = coordinate[2];\n      }\n\n      break;\n\n    default: // pass\n\n  }\n\n  var orderedKeys = node.nodeName == 'rtept' ? RTEPT_TYPE_SEQUENCE[namespaceURI] : WPT_TYPE_SEQUENCE[namespaceURI];\n  var values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  {\n    node: node,\n    'properties': properties\n  }, WPT_TYPE_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n/**\n * @param {Node} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction writeRte(node, feature, objectStack) {\n  var options =\n  /** @type {import(\"./Feature.js\").WriteOptions} */\n  objectStack[0];\n  var properties = feature.getProperties();\n  var context = {\n    node: node\n  };\n  context['properties'] = properties;\n  var geometry = feature.getGeometry();\n\n  if (geometry.getType() == GeometryType.LINE_STRING) {\n    var lineString =\n    /** @type {LineString} */\n    transformGeometryWithOptions(geometry, true, options);\n    context['geometryLayout'] = lineString.getLayout();\n    properties['rtept'] = lineString.getCoordinates();\n  }\n\n  var parentNode = objectStack[objectStack.length - 1].node;\n  var orderedKeys = RTE_SEQUENCE[parentNode.namespaceURI];\n  var values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, RTE_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n/**\n * @param {Element} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction writeTrk(node, feature, objectStack) {\n  var options =\n  /** @type {import(\"./Feature.js\").WriteOptions} */\n  objectStack[0];\n  var properties = feature.getProperties();\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n\n  var context = {\n    node: node\n  };\n  context['properties'] = properties;\n  var geometry = feature.getGeometry();\n\n  if (geometry.getType() == GeometryType.MULTI_LINE_STRING) {\n    var multiLineString =\n    /** @type {MultiLineString} */\n    transformGeometryWithOptions(geometry, true, options);\n    properties['trkseg'] = multiLineString.getLineStrings();\n  }\n\n  var parentNode = objectStack[objectStack.length - 1].node;\n  var orderedKeys = TRK_SEQUENCE[parentNode.namespaceURI];\n  var values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, TRK_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n/**\n * @param {Element} node Node.\n * @param {LineString} lineString LineString.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction writeTrkSeg(node, lineString, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  var context = {\n    node: node\n  };\n  context['geometryLayout'] = lineString.getLayout();\n  context['properties'] = {};\n  pushSerializeAndPop(context, TRKSEG_SERIALIZERS, TRKSEG_NODE_FACTORY, lineString.getCoordinates(), objectStack);\n}\n/**\n * @param {Element} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n */\n\n\nfunction writeWpt(node, feature, objectStack) {\n  var options =\n  /** @type {import(\"./Feature.js\").WriteOptions} */\n  objectStack[0];\n  var context = objectStack[objectStack.length - 1];\n  context['properties'] = feature.getProperties();\n  var geometry = feature.getGeometry();\n\n  if (geometry.getType() == GeometryType.POINT) {\n    var point =\n    /** @type {Point} */\n    transformGeometryWithOptions(geometry, true, options);\n    context['geometryLayout'] = point.getLayout();\n    writeWptType(node, point.getCoordinates(), objectStack);\n  }\n}\n\nexport default GPX;","map":{"version":3,"mappings":"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","names":["Feature","GeometryLayout","GeometryType","LineString","MultiLineString","Point","XMLFeature","OBJECT_PROPERTY_NODE_FACTORY","XML_SCHEMA_INSTANCE_URI","createElementNS","makeArrayPusher","makeArraySerializer","makeChildAppender","makeObjectPropertySetter","makeSequence","makeSimpleNodeFactory","makeStructureNS","parseNode","pushParseAndPop","pushSerializeAndPop","get","getProjection","includes","readDateTime","readDecimal","readPositiveInteger","readString","writeDateTimeTextNode","writeDecimalTextNode","writeNonNegativeIntegerTextNode","writeStringTextNode","transformGeometryWithOptions","NAMESPACE_URIS","SCHEMA_LOCATION","FEATURE_READER","readRte","readTrk","readWpt","GPX_PARSERS","LINK_PARSERS","GPX_SERIALIZERS","writeRte","writeTrk","writeWpt","__extends","opt_options","_super","options","_this","dataProjection","readExtensions_","readExtensions","GPX","features","i","ii","length","feature","extensionsNode","set","undefined","node","namespaceURI","featureReader","localName","getReadOptions","handleReadExtensions_","adaptOptions","gpx","xmlnsUri","setAttributeNS","setAttribute","GPX_NODE_FACTORY","RTE_PARSERS","parseLink","parseExtensions","parseRtePt","RTEPT_PARSERS","TRK_PARSERS","parseTrkSeg","TRKSEG_PARSERS","parseTrkPt","TRKPT_PARSERS","WPT_PARSERS","LINK_SEQUENCE","LINK_SERIALIZERS","RTE_SEQUENCE","RTE_SERIALIZERS","writeLink","writeWptType","RTEPT_TYPE_SEQUENCE","TRK_SEQUENCE","TRK_SERIALIZERS","writeTrkSeg","TRKSEG_NODE_FACTORY","TRKSEG_SERIALIZERS","WPT_TYPE_SEQUENCE","WPT_TYPE_SERIALIZERS","GEOMETRY_TYPE_TO_NODENAME","value","objectStack","opt_nodeName","geometry","getGeometry","nodeName","getType","parentNode","appendCoordinate","flatCoordinates","layoutOptions","values","push","parseFloat","getAttribute","hasZ","hasM","applyLayoutOptions","ends","layout","XY","stride","XYZM","XYZ","XYM","href","rteValues","trkValues","setProperties","coordinates","context","properties","link","coordinate","String","geometryLayout","orderedKeys","getProperties","LINE_STRING","lineString","getLayout","getCoordinates","MULTI_LINE_STRING","multiLineString","getLineStrings","POINT","point"],"sourceRoot":"","sources":["../src/format/GPX.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}